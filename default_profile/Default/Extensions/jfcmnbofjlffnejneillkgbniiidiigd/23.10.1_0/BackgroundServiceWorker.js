/*!
 * Copyright UiPath 2022
 * This file contains code from WebPack - https://github.com/webpack/webpack - MIT license
 */
(()=>{"use strict";var __webpack_modules__=([,,((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.OriginalChromeApi=void 0;const BrowserTools_1=__webpack_require__(3);let globalScope=BrowserTools_1.BrowserTools.GetGlobalThis();globalScope["chrome"]=globalScope["chrome"]||globalScope["browser"];class OriginalChromeApi{static GetTabsSendMessage(){return this.chromeTabSendMessage}static GetTabsQuery(){return this.chromeTabsQuery}}exports.OriginalChromeApi=OriginalChromeApi;OriginalChromeApi.chromeApi=chrome;OriginalChromeApi.chromeTabSendMessage=chrome.tabs.sendMessage;OriginalChromeApi.chromeTabsQuery=chrome.tabs.query}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.BrowserTools=void 0;const Logger_1=__webpack_require__(4);const StringTools_1=__webpack_require__(7);const Tools_1=__webpack_require__(8);var BrowserTools;(function(BrowserTools){function GetTabWindowInfo_Async(tabs){let finalResults=[];let mapWindowIdToRequestInfos={};let windowIdsToCheck={};for(let tab of tabs){let info={tab:tab,window:null};finalResults.push(info);let requestedInfos=mapWindowIdToRequestInfos[tab.windowId];if(!requestedInfos){requestedInfos=[];mapWindowIdToRequestInfos[tab.windowId]=requestedInfos;windowIdsToCheck[tab.windowId]=true}requestedInfos.push(info)}return Tools_1.Tools.ToPromise(resolvePromiseCb=>{chrome.windows.getAll(allWindows=>{for(let window of allWindows){if(Tools_1.Tools.isNil(window.id)||!windowIdsToCheck[window.id]){continue}let requestedInfos=mapWindowIdToRequestInfos[window.id];for(let requestInfo of requestedInfos){requestInfo.window=window}}resolvePromiseCb(finalResults)})})}BrowserTools.GetTabWindowInfo_Async=GetTabWindowInfo_Async;function ForAllParallel(values,processValueCb,onCompletedAllCb){var OnAllCompleted=()=>{if(onCompletedAllCb){onCompletedAllCb()}};var valuesCount=values?values.length:0;if(valuesCount==0){OnAllCompleted();return}let remainingValues=values.length;let OnValueProcessed=()=>{--remainingValues;if(remainingValues<=0){OnAllCompleted()}};for(let value of values){try{processValueCb(value,()=>{OnValueProcessed()})}catch(ex){Logger_1.Logger.Error(String(ex));OnValueProcessed()}}}BrowserTools.ForAllParallel=ForAllParallel;function ForAllSequential(values,processValueCb,onCompletedAllCb){let valueIndex=0;const doNextAction=function(){if(valueIndex>=values.length){if(onCompletedAllCb){onCompletedAllCb()}return}processValueCb(values[valueIndex++],function(){doNextAction()})};doNextAction()}BrowserTools.ForAllSequential=ForAllSequential;function IsBrowserSettingsUrl(url){if(url&&((url.indexOf("chrome://")===0)||(url.indexOf("chrome-extension://")===0)||(url.indexOf("edge://")===0)||(url.indexOf("about:")===0))){return true}return false}BrowserTools.IsBrowserSettingsUrl=IsBrowserSettingsUrl;function GetTabsWithUrl(tabs,targetUrl){let matchedTabs=[];for(let tab of tabs){if(TabHasUrl(tab,targetUrl)){matchedTabs.push(tab)}}return matchedTabs}BrowserTools.GetTabsWithUrl=GetTabsWithUrl;function ExcludeTabsWithUrl(tabs,targetUrl){let matchedTabs=[];for(let tab of tabs){if(!TabHasUrl(tab,targetUrl)){matchedTabs.push(tab)}}return matchedTabs}BrowserTools.ExcludeTabsWithUrl=ExcludeTabsWithUrl;function TabHasUrl(tab,targetUrl){var _a;let tabUrl=(_a=tab.url)!==null&&_a!==void 0?_a:"";return StringTools_1.StringTools.AreEqual(targetUrl,tabUrl,true)}BrowserTools.TabHasUrl=TabHasUrl;function IsAccessibleTab(tabId,onResultCb){chrome.tabs.get(tabId,tab=>{let canAccessUrl=tab&&!Tools_1.Tools.isNil(tab.url)&&!BrowserTools.IsBrowserSettingsUrl(tab.url);onResultCb(canAccessUrl,tab)})}BrowserTools.IsAccessibleTab=IsAccessibleTab;function IsFirefoxBrowser(){let globalThis=BrowserTools.GetGlobalThis();var isFirefox=(globalThis["mozInnerScreenX"]!==undefined);return isFirefox}BrowserTools.IsFirefoxBrowser=IsFirefoxBrowser;function IsChromeBrowser(){var isChromeBrowser=true;if(IsFirefoxBrowser()){isChromeBrowser=false}return isChromeBrowser}BrowserTools.IsChromeBrowser=IsChromeBrowser;function GetGlobalThis(){if(typeof window!="undefined"){return window}return globalThis}BrowserTools.GetGlobalThis=GetGlobalThis;function GetDefaultTab(){return{index:-1,title:"",url:"",pinned:false,highlighted:false,windowId:-1,active:false,id:-1,incognito:false,selected:false,discarded:false,autoDiscardable:false,groupId:-1}}BrowserTools.GetDefaultTab=GetDefaultTab;function GetBrowserWindowData(wnd){var _a,_b,_c,_d,_e,_f;let windowData={windowId:(_a=wnd.id)!==null&&_a!==void 0?_a:0,windowX:(_b=wnd.left)!==null&&_b!==void 0?_b:0,windowY:(_c=wnd.top)!==null&&_c!==void 0?_c:0,windowWidth:(_d=wnd.width)!==null&&_d!==void 0?_d:0,windowHeight:(_e=wnd.height)!==null&&_e!==void 0?_e:0,windowState:(_f=wnd.state)!==null&&_f!==void 0?_f:""};return windowData}BrowserTools.GetBrowserWindowData=GetBrowserWindowData;function WrapWithChromeLastError(lastErrorMsg,actionCb){if(chrome.runtime.lastError){delete chrome.runtime.lastError}chrome.runtime.lastError={message:lastErrorMsg};try{actionCb()}finally{delete chrome.runtime.lastError}}BrowserTools.WrapWithChromeLastError=WrapWithChromeLastError;function _ValidatePermissions(){if(chrome.cookies&&chrome.cookies.getAllCookieStores){chrome.cookies.getAllCookieStores(function(cookieStores){if(!cookieStores){return}for(var i=0;i<cookieStores.length;++i){Logger_1.Logger.Log("Cookie Store Id: "+cookieStores[i].id)}})}if(chrome.webNavigation&&chrome.webNavigation.getAllFrames){chrome.tabs.query({active:true},function(tabs){var _a;if(!tabs||tabs.length===0){return}var activeTab=tabs[0];chrome.webNavigation.getAllFrames({tabId:(_a=activeTab===null||activeTab===void 0?void 0:activeTab.id)!==null&&_a!==void 0?_a:0},function(detailsArray){if(!detailsArray||detailsArray.length===0){return}var activeFrameDetails=detailsArray[0];Logger_1.Logger.Log("Active Tab Frame URL: "+activeFrameDetails.url)})})}if(chrome.debugger&&chrome.debugger.getTargets){chrome.debugger.getTargets(function(targets){if(!targets){return}for(var i=0;i<targets.length;++i){Logger_1.Logger.Log("Debug Target Id: "+targets[i].id)}})}}BrowserTools._ValidatePermissions=_ValidatePermissions})(BrowserTools=exports.BrowserTools||(exports.BrowserTools={}))}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.TimedMethodLogger=exports.MethodLogger=exports.ClassLogger=exports.Logger=void 0;const tslib_1=__webpack_require__(5);const Timer_1=__webpack_require__(6);class Logger{static Log(...data){try{console.log(...data)}catch(e){}}static Warn(...data){try{console.warn(...data)}catch(e){}}static Error(...data){try{console.error(...data)}catch(e){}}}exports.Logger=Logger;class ClassLogger{constructor(classFunc,...prefixArgs){this.className=classFunc.name;this.prefixArgs=prefixArgs}Log(method,...data){Logger.Log(this.GetMessagePrefix(method),...this.prefixArgs,...data)}Warn(method,...data){Logger.Warn(this.GetMessagePrefix(method),...this.prefixArgs,...data)}Error(method,...data){Logger.Error(this.GetMessagePrefix(method),...this.prefixArgs,...data)}GetMessagePrefix(method){return`[${this.className}.${method.name}]`}}exports.ClassLogger=ClassLogger;class MethodLogger{constructor(classLogger,method){this.classLogger=classLogger;this.method=method}Log(...args){this.classLogger.Log(this.method,...args)}Error(...args){this.classLogger.Error(this.method,"durationMs:",...args)}Warn(...args){this.classLogger.Warn(this.method,"durationMs:",...args)}DoTimed_Async(action){return tslib_1.__awaiter(this,void 0,void 0,function*(){let timedLogger=new TimedMethodLogger(this);try{let result=yield action();return result}finally{timedLogger.LogFinish()}})}DoTimed(action){let timedLogger=new TimedMethodLogger(this);try{return action()}finally{timedLogger.LogFinish()}}}exports.MethodLogger=MethodLogger;class TimedMethodLogger{constructor(methodLogger,...initialArgs){this.methodLogger=methodLogger;this.methodLogger.Log("Started...",...initialArgs);this.timer=new Timer_1.Timer}LogFinish(...args){this.methodLogger.Log(...args,"Finished!","durationMs:",this.timer.ElapsedTimeMs())}Log(...args){this.methodLogger.Log(...args,"durationMs:",this.timer.ElapsedTimeMs())}ErrorFinish(...args){this.methodLogger.Error(...args,"Finished!","durationMs:",this.timer.ElapsedTimeMs())}Error(...args){this.methodLogger.Error(...args,"durationMs:",this.timer.ElapsedTimeMs())}WarnFinish(...args){this.methodLogger.Warn(...args,"Finished!","durationMs:",this.timer.ElapsedTimeMs())}Warn(...args){this.methodLogger.Warn(...args,"durationMs:",this.timer.ElapsedTimeMs())}}exports.TimedMethodLogger=TimedMethodLogger}),((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{__assign:()=>(__assign),__asyncDelegator:()=>(__asyncDelegator),__asyncGenerator:()=>(__asyncGenerator),__asyncValues:()=>(__asyncValues),__await:()=>(__await),__awaiter:()=>(__awaiter),__classPrivateFieldGet:()=>(__classPrivateFieldGet),__classPrivateFieldSet:()=>(__classPrivateFieldSet),__createBinding:()=>(__createBinding),__decorate:()=>(__decorate),__exportStar:()=>(__exportStar),__extends:()=>(__extends),__generator:()=>(__generator),__importDefault:()=>(__importDefault),__importStar:()=>(__importStar),__makeTemplateObject:()=>(__makeTemplateObject),__metadata:()=>(__metadata),__param:()=>(__param),__read:()=>(__read),__rest:()=>(__rest),__spread:()=>(__spread),__spreadArray:()=>(__spreadArray),__spreadArrays:()=>(__spreadArrays),__values:()=>(__values)});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};function __extends(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++){if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t[p[i]]=s[p[i]]}return t}function __decorate(decorators,target,key,desc){var c=arguments.length,r=c<3?target:desc===null?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)if(d=decorators[i])r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r;return c>3&&r&&Object.defineProperty(target,key,r),r}function __param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function __metadata(metadataKey,metadataValue){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(metadataKey,metadataValue)}function __awaiter(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}function __generator(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),"throw":verb(1),"return":verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||(op[1]>t[0]&&op[1]<t[3]))){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}}var __createBinding=Object.create?(function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}})}):(function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});function __exportStar(m,o){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(o,p))__createBinding(o,m,p)}function __values(o){var s=typeof Symbol==="function"&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&typeof o.length==="number")return{next:function(){if(o&&i>=o.length)o=void 0;return{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.");}function __read(o,n){var m=typeof Symbol==="function"&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),r,ar=[],e;try{while((n===void 0||n-->0)&&!(r=i.next()).done)ar.push(r.value)}catch(error){e={error:error}}finally{try{if(r&&!r.done&&(m=i["return"]))m.call(i)}finally{if(e)throw e.error;}}return ar}function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar}function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}function __spreadArray(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))}function __await(v){return this instanceof __await?(this.v=v,this):new __await(v)}function __asyncGenerator(thisArg,_arguments,generator){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=generator.apply(thisArg,_arguments||[]),i,q=[];return i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i;function verb(n){if(g[n])i[n]=function(v){return new Promise(function(a,b){q.push([n,v,a,b])>1||resume(n,v)})}}function resume(n,v){try{step(g[n](v))}catch(e){settle(q[0][3],e)}}function step(r){r.value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}function fulfill(value){resume("next",value)}function reject(value){resume("throw",value)}function settle(f,v){if(f(v),q.shift(),q.length)resume(q[0][0],q[0][1])}}function __asyncDelegator(o){var i,p;return i={},verb("next"),verb("throw",function(e){throw e;}),verb("return"),i[Symbol.iterator]=function(){return this},i;function verb(n,f){i[n]=o[n]?function(v){return(p=!p)?{value:__await(o[n](v)),done:n==="return"}:f?f(v):v}:f}}function __asyncValues(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=o[Symbol.asyncIterator],i;return m?m.call(o):(o=typeof __values==="function"?__values(o):o[Symbol.iterator](),i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i);function verb(n){i[n]=o[n]&&function(v){return new Promise(function(resolve,reject){v=o[n](v),settle(resolve,reject,v.done,v.value)})}}function settle(resolve,reject,d,v){Promise.resolve(v).then(function(v){resolve({value:v,done:d})},reject)}}function __makeTemplateObject(cooked,raw){if(Object.defineProperty){Object.defineProperty(cooked,"raw",{value:raw})}else{cooked.raw=raw}return cooked};var __setModuleDefault=Object.create?(function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}):function(o,v){o["default"]=v};function __importStar(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result}function __importDefault(mod){return(mod&&mod.__esModule)?mod:{default:mod}}function __classPrivateFieldGet(receiver,state,kind,f){if(kind==="a"&&!f)throw new TypeError("Private accessor was defined without a getter");if(typeof state==="function"?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot read private member from an object whose class did not declare it");return kind==="m"?f:kind==="a"?f.call(receiver):f?f.value:state.get(receiver)}function __classPrivateFieldSet(receiver,state,value,kind,f){if(kind==="m")throw new TypeError("Private method is not writable");if(kind==="a"&&!f)throw new TypeError("Private accessor was defined without a setter");if(typeof state==="function"?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot write private member to an object whose class did not declare it");return(kind==="a"?f.call(receiver,value):f?f.value=value:state.set(receiver,value)),value}}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.Timer=void 0;class Timer{constructor(){this.startTimeMs=window.performance.now()}ElapsedTimeMs(){return Math.ceil(window.performance.now()-this.startTimeMs)}}exports.Timer=Timer}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.StringTools=void 0;var StringTools;(function(StringTools){function AreEqual(valueA,valueB,ignoreCase){if(valueA===valueB){return true}else if(!valueA||!valueB){return false}if(ignoreCase){valueA=valueA.toLowerCase();valueB=valueB.toLowerCase()}return(valueA===valueB)}StringTools.AreEqual=AreEqual;function AreEqualAsCode(valueA,valueB,ignoreCase){valueA=valueA.replace(/\/\*[\s\S]*?\*\/|\/\/.*/g,'');valueB=valueB.replace(/\/\*[\s\S]*?\*\/|\/\/.*/g,'');valueA=valueA.replace(/[^a-zA-Z0-9]+/g,'');valueB=valueB.replace(/[^a-zA-Z0-9]+/g,'');return AreEqual(valueA,valueB,ignoreCase)}StringTools.AreEqualAsCode=AreEqualAsCode;function SafeReplaceString(str,valueToReplace,replacement){let startIndex=str.indexOf(valueToReplace);let beginStr=str.slice(0,startIndex);let endStr=str.slice(startIndex+valueToReplace.length);let result=beginStr;result+=replacement;result+=endStr;return result}StringTools.SafeReplaceString=SafeReplaceString;function Contains(str,subStringToCheck){return str.indexOf(subStringToCheck)>=0}StringTools.Contains=Contains;function GetFunctionBody(func){const functionCode=func.toString();const openBracketIndex=functionCode.indexOf("{");const closeBracketIndex=functionCode.lastIndexOf("}");const functionBody=functionCode.substring(openBracketIndex+1,closeBracketIndex);return functionBody}StringTools.GetFunctionBody=GetFunctionBody})(StringTools=exports.StringTools||(exports.StringTools={}))}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.Tools=void 0;var Tools;(function(Tools){function IsFunction(value){return(typeof(value)==="function")}Tools.IsFunction=IsFunction;function isNil(value){return value===null||value===undefined}Tools.isNil=isNil;function IsDefined(value){return!isNil(value)}Tools.IsDefined=IsDefined;function IsUndefined(type){return type==="undefined"}Tools.IsUndefined=IsUndefined;function UnsafeCast(value){return value}Tools.UnsafeCast=UnsafeCast;function ToPromise(actionWithCallback){let promise=new Promise(resolvePromiseCb=>{actionWithCallback(resolvePromiseCb)});return promise}Tools.ToPromise=ToPromise;function ToTimedPromise(actionWithCallback,timeoutMs){return Promise.race([ToPromise(actionWithCallback),new Promise((_resolvePromiseCb,rejectPromiseCb)=>{setTimeout(()=>{rejectPromiseCb("Action timeout out!")},timeoutMs)})])}Tools.ToTimedPromise=ToTimedPromise;function SafeIncrementWithWrapAround(value){if(value>=Number.MAX_SAFE_INTEGER){value=0}return(value+1)}Tools.SafeIncrementWithWrapAround=SafeIncrementWithWrapAround;let LoopAction;(function(LoopAction){LoopAction[LoopAction["Stop"]=0]="Stop";LoopAction[LoopAction["Continue"]=1]="Continue"})(LoopAction=Tools.LoopAction||(Tools.LoopAction={}));function RetryWithTimeout(actionCb,timeoutMs){let wrapperFunc=()=>{let loopAction=actionCb();if(loopAction===LoopAction.Continue){setTimeout(wrapperFunc,timeoutMs)}};wrapperFunc()}Tools.RetryWithTimeout=RetryWithTimeout;function RetryWithTimeoutAsync(actionCb,timeoutMs){let wrapperFunc=()=>{actionCb().then(loopAction=>{if(loopAction===LoopAction.Continue){setTimeout(wrapperFunc,timeoutMs)}})};wrapperFunc()}Tools.RetryWithTimeoutAsync=RetryWithTimeoutAsync})(Tools=exports.Tools||(exports.Tools={}))}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.BackgroundPageService=void 0;const tslib_1=__webpack_require__(5);const BrowserTools_1=__webpack_require__(3);const Tools_1=__webpack_require__(8);const Logger_1=__webpack_require__(4);class BackgroundPageService{constructor(originalTabsQuery){this.classLogger=new Logger_1.ClassLogger(BackgroundPageService);this.originalTabsQuery=originalTabsQuery}OpenExtensionWindowAndWaitUntilInitialized_Async(timeoutMs){return tslib_1.__awaiter(this,void 0,void 0,function*(){let logger=new Logger_1.MethodLogger(this.classLogger,this.OpenExtensionWindowAndWaitUntilInitialized_Async);let success=yield this.OpenExtensionWindow_Async();logger.Log("success:",success);if(!success){return false}return Tools_1.Tools.ToPromise(resolvePromiseCb=>{let remainingTimeMs=timeoutMs;const sleepTimeMs=100;let checkIfExtensionWindowHasOpened=()=>{this.GetExtensionWindowId_Async().then(extensionWindowId=>{logger.Log("extensionWindowId:",extensionWindowId);if(extensionWindowId==null){if(remainingTimeMs>0){remainingTimeMs-=sleepTimeMs;return setTimeout(checkIfExtensionWindowHasOpened,sleepTimeMs)}else{logger.Error("Timed-out while waiting for extension window to initialize");return resolvePromiseCb(false)}}else{return resolvePromiseCb(true)}})};checkIfExtensionWindowHasOpened()})})}OpenExtensionWindow_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let logger=new Logger_1.MethodLogger(this.classLogger,this.OpenExtensionWindow_Async);let isOpen=yield this.IsExtensionWindowOpen_Async();if(isOpen){logger.Log("Extension window is already open");return isOpen}logger.Log("Started");let wndData={state:"minimized",type:"popup",url:BackgroundPageService.s_extensionUrl};return Tools_1.Tools.ToPromise(resolvePromiseCb=>{chrome.windows.create(wndData,function(wnd){var _a;if(chrome.runtime.lastError){logger.Error("Failed to create window; lastError:",chrome.runtime.lastError.message);resolvePromiseCb(false);return}logger.Log("Created wnd.id:",wnd===null||wnd===void 0?void 0:wnd.id);chrome.windows.update((_a=wnd===null||wnd===void 0?void 0:wnd.id)!==null&&_a!==void 0?_a:0,{focused:false},()=>{resolvePromiseCb(true)})})})})}InitAsExtensionWindow_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let extensionTabs=yield this.GetAllExtensionTabs_Async();this.classLogger.Log(this.InitAsExtensionWindow_Async,"extensionTabs.length:",extensionTabs.length);let tabsToClose=yield this.GetExtensionTabsToClose_Async(extensionTabs);return Tools_1.Tools.ToPromise(resolvePromiseCb=>{BrowserTools_1.BrowserTools.ForAllParallel(tabsToClose,(tab,onActionCompleted)=>{if(Tools_1.Tools.isNil(tab===null||tab===void 0?void 0:tab.id)){onActionCompleted();return}this.classLogger.Log(this.InitAsExtensionWindow_Async,"closing tab.id:",tab.id,", tab.windowId:",tab.windowId);chrome.tabs.remove(tab.id,onActionCompleted)},()=>{this.GetExtensionWindowId_Async().then(windowId=>{resolvePromiseCb(windowId!==null&&windowId!==void 0?windowId:0)})})})})}GetExtensionWindowId_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let tab=yield this.GetExtensionTab_Async();let windowId=tab===null||tab===void 0?void 0:tab.windowId;if(Tools_1.Tools.isNil(windowId)){return null}return windowId})}static GetExtensionPageUrl(){return BackgroundPageService.s_extensionUrl}GetExtensionTab_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let extensionTabs=yield this.GetAllExtensionTabs_Async();let extensionTab=(extensionTabs.length!=0)?extensionTabs[0]:null;return extensionTab})}GetAllExtensionTabs_Async(){return Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.originalTabsQuery({},foundTabs=>{if(Tools_1.Tools.isNil(foundTabs)){foundTabs=[]}let extensionTabs=BrowserTools_1.BrowserTools.GetTabsWithUrl(foundTabs,BackgroundPageService.s_extensionUrl);resolvePromiseCb(extensionTabs)})})}IsExtensionWindowOpen_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let extensionTab=yield this.GetExtensionTab_Async();let isOpen=(extensionTab!=null);return isOpen})}GetExtensionTabsToClose_Async(extensionTabs){var _a;return tslib_1.__awaiter(this,void 0,void 0,function*(){if(extensionTabs.length<=1){return[]}let tabWindowInfos=yield BrowserTools_1.BrowserTools.GetTabWindowInfo_Async(extensionTabs);let tabToKeep=null;let tabsToClose=[];for(let tabWindowInfo of tabWindowInfos){if(tabToKeep){tabsToClose.push(tabWindowInfo.tab)}else if(((_a=tabWindowInfo.window)===null||_a===void 0?void 0:_a.type)==="popup"){tabToKeep=tabWindowInfo.tab}else{tabsToClose.push(tabWindowInfo.tab)}}return tabsToClose})}}exports.BackgroundPageService=BackgroundPageService;BackgroundPageService.s_extensionUrl=chrome.runtime.getURL("BackgroundPage.html")}),,,((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ExtensionConfigService=void 0;const Tools_1=__webpack_require__(8);const EXTENSION_CONFIG_STUDIO_DESKTOP="WebStore_StudioDesktop";const EXTENSION_CONFIG_STUDIO_WEB="WebStore_StudioWeb";const EXTENSION_CONFIG_SELF_HOSTED="SelfHosted_StudioDesktop";class ExtensionConfigService{static GetConfig(){const extensionConfigName=this.GetConfigName();if(extensionConfigName===EXTENSION_CONFIG_STUDIO_DESKTOP){return this.studioDesktopConfig}else if(extensionConfigName===EXTENSION_CONFIG_STUDIO_WEB){return this.studioWebConfig}else if(extensionConfigName===EXTENSION_CONFIG_SELF_HOSTED){return this.selfHostedConfig}else{let unhandledType=extensionConfigName;return this.studioDesktopConfig}}static GetConfigName(){if(Tools_1.Tools.IsUndefined(typeof "WebStore_StudioDesktop")){return EXTENSION_CONFIG_STUDIO_DESKTOP}return "WebStore_StudioDesktop"}}exports.ExtensionConfigService=ExtensionConfigService;ExtensionConfigService.selfHostedConfig={AllowInteropWithStudioWeb:false,AllowExtensionAutoUpdate:true,AllowInteropWithNativeHostsOnWindows:true,RegisterContentEventListeners:false};ExtensionConfigService.studioDesktopConfig={AllowInteropWithStudioWeb:false,AllowExtensionAutoUpdate:false,AllowInteropWithNativeHostsOnWindows:true,RegisterContentEventListeners:false};ExtensionConfigService.studioWebConfig={AllowInteropWithStudioWeb:true,AllowExtensionAutoUpdate:false,AllowInteropWithNativeHostsOnWindows:false,RegisterContentEventListeners:true}})]);var __webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==undefined){return cachedModule.exports}var module=__webpack_module_cache__[moduleId]={exports:{}};__webpack_modules__[moduleId](module,module.exports,__webpack_require__);return module.exports}(()=>{__webpack_require__.d=(exports,definition)=>{for(var key in definition){if(__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)){Object.defineProperty(exports,key,{enumerable:true,get:definition[key]})}}}})();(()=>{__webpack_require__.o=(obj,prop)=>(Object.prototype.hasOwnProperty.call(obj,prop))})();(()=>{__webpack_require__.r=exports=>{if(typeof Symbol!=='undefined'&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:'Module'})}Object.defineProperty(exports,'__esModule',{value:true})}})();var __webpack_exports__={};(()=>{var exports=__webpack_exports__;Object.defineProperty(exports,"__esModule",({value:true}));const tslib_1=__webpack_require__(5);const BrowserExtensionConfig_1=__webpack_require__(12);const BrowserTools_1=__webpack_require__(3);const Logger_1=__webpack_require__(4);const Tools_1=__webpack_require__(8);const OriginalChromeApi_1=__webpack_require__(2);const BackgroundPageService_1=__webpack_require__(9);Logger_1.Logger.Log("[BackgroundServiceWorker]");let g_isOpeningExtensionWindow=false;let g_backgroundPageService=new BackgroundPageService_1.BackgroundPageService(OriginalChromeApi_1.OriginalChromeApi.GetTabsQuery());let OpenExtensionWindowIfNeeded_Async=()=>tslib_1.__awaiter(void 0,void 0,void 0,function*(){if(g_isOpeningExtensionWindow){Logger_1.Logger.Log("[BackgroundServiceWorker.OpenExtensionWindowIfNeeded] Extension window is opening...");return}let extensionWindowId=yield g_backgroundPageService.GetExtensionWindowId_Async();if(extensionWindowId!=null){return}g_isOpeningExtensionWindow=true;Logger_1.Logger.Log("[BackgroundServiceWorker.OpenExtensionWindowIfNeeded] Opening the extension window now");let timeoutMs=60*1000;let success=yield g_backgroundPageService.OpenExtensionWindowAndWaitUntilInitialized_Async(timeoutMs);Logger_1.Logger.Log("[BackgroundServiceWorker.OpenExtensionWindowIfNeeded] success:",success);g_isOpeningExtensionWindow=false});chrome.tabs.onCreated.addListener(tab=>{Logger_1.Logger.Log("[BackgroundServiceWorker] tabs.onCreated tab.id:",tab.id,"tab.windowId:",tab.windowId)});chrome.windows.onCreated.addListener(_window=>{OpenExtensionWindowIfNeeded_Async()});chrome.windows.onRemoved.addListener(()=>{chrome.windows.getAll(openWindows=>tslib_1.__awaiter(void 0,void 0,void 0,function*(){Logger_1.Logger.Log("[BackgroundServiceWorker::OnWindowRemoved] openWindows.length: "+openWindows.length);if(openWindows.length==1){let openWindowId=openWindows[0].id;let extensionWindowId=yield g_backgroundPageService.GetExtensionWindowId_Async();if(extensionWindowId===openWindowId){Logger_1.Logger.Log("[BackgroundServiceWorker::OnWindowRemoved] The extension window is last open window, closing it now.");chrome.windows.remove(openWindowId)}}}))});if(chrome&&chrome.management&&chrome.management.get&&chrome.management.setEnabled){try{var oldExtensionId="dpncpimghfponcpjkgihfikppbbhchil";chrome.management.get(oldExtensionId,function(result){if(chrome.runtime.lastError){}else if(result&&result.enabled){Logger_1.Logger.Log("[BackgroundServiceWorker] Found deprecated and enabled UiPath extension");chrome.management.setEnabled(oldExtensionId,false,function(){if(chrome.runtime.lastError){Logger_1.Logger.Error("[BackgroundServiceWorker] Disable deprecated UiPath extension failed, msg: "+chrome.runtime.lastError.message)}else{Logger_1.Logger.Log("[BackgroundServiceWorker] Disabled deprecated UiPath extension")}})}})}catch(e){Logger_1.Logger.Error("[BackgroundServiceWorker] UiPath Exception: "+e)}}chrome.runtime.onInstalled.addListener(function(details){try{Logger_1.Logger.Log("[BackgroundServiceWorker::OnInstalled] details.reason: "+details.reason);if(details.reason=="install"){Logger_1.Logger.Log("UiPath extension first installed")}else if(details.reason=="update"){let thisVersion=chrome.runtime.getManifest().version;Logger_1.Logger.Log("[BackgroundServiceWorker::OnInstalled] UiPath extension updated from "+details.previousVersion+" to "+thisVersion+"!")}chrome.tabs.query({},function(tabsList){for(let tab of tabsList){if(Tools_1.Tools.isNil(tab.url)||Tools_1.Tools.isNil(tab.id)){continue}if(!BrowserTools_1.BrowserTools.IsBrowserSettingsUrl(tab.url)){chrome.tabs.reload(tab.id,{})}}})}catch(e){Logger_1.Logger.Error("[BackgroundServiceWorker::OnInstalled] UiPath Exception: "+e)}});const allowExtensionAutoUpdate=BrowserExtensionConfig_1.ExtensionConfigService.GetConfig().AllowExtensionAutoUpdate;Logger_1.Logger.Log("[BackgroundServiceWorker] allowExtensionAutoUpdate:",allowExtensionAutoUpdate);chrome.runtime.onUpdateAvailable.addListener(function(_details){if(allowExtensionAutoUpdate){Logger_1.Logger.Log("[BackgroundServiceWorker.onUpdateAvailable] Calling chrome.runtime.reload");chrome.runtime.reload()}});OpenExtensionWindowIfNeeded_Async()})()})();