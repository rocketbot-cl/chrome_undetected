/*!
 * Copyright UiPath 2022
 * This file contains code from WebPack - https://github.com/webpack/webpack - MIT license
 */
(()=>{"use strict";var __webpack_modules__=([,((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.BackgroundGlobals=void 0;var BackgroundGlobals;(function(BackgroundGlobals){function RegisterConnectionProxyMatcher(globalScope,proxy){GetGlobalVariables(globalScope).connectionProxyMatcher=proxy}BackgroundGlobals.RegisterConnectionProxyMatcher=RegisterConnectionProxyMatcher;function GetConnectionProxyMatcher(globalScope){return GetGlobalVariables(globalScope).connectionProxyMatcher}BackgroundGlobals.GetConnectionProxyMatcher=GetConnectionProxyMatcher;function RegisterLoaderWin32(globalScope,loader){GetGlobalVariables(globalScope).loaderWin32=loader}BackgroundGlobals.RegisterLoaderWin32=RegisterLoaderWin32;function GetLoaderWin32(globalScope){return GetGlobalVariables(globalScope).loaderWin32}BackgroundGlobals.GetLoaderWin32=GetLoaderWin32;function RegisterLoaderStudioWeb(globalScope,loader){GetGlobalVariables(globalScope).loaderStudioWeb=loader}BackgroundGlobals.RegisterLoaderStudioWeb=RegisterLoaderStudioWeb;function GetLoaderStudioWeb(globalScope){return GetGlobalVariables(globalScope).loaderStudioWeb}BackgroundGlobals.GetLoaderStudioWeb=GetLoaderStudioWeb;function RegisterLoaderPortable(globalScope,loader){GetGlobalVariables(globalScope).loaderPortable=loader}BackgroundGlobals.RegisterLoaderPortable=RegisterLoaderPortable;function GetLoaderPortable(globalScope){return GetGlobalVariables(globalScope).loaderPortable}BackgroundGlobals.GetLoaderPortable=GetLoaderPortable;function RegisterTabsService(globalScope,tabsService){GetGlobalVariables(globalScope).tabsService=tabsService}BackgroundGlobals.RegisterTabsService=RegisterTabsService;function GetTabsService(globalScope){return GetGlobalVariables(globalScope).tabsService}BackgroundGlobals.GetTabsService=GetTabsService;function RegisterExtensionErrorService(globalScope,service){GetGlobalVariables(globalScope).extensionErrorService=service}BackgroundGlobals.RegisterExtensionErrorService=RegisterExtensionErrorService;function GetExtensionErrorService(globalScope){return GetGlobalVariables(globalScope).extensionErrorService}BackgroundGlobals.GetExtensionErrorService=GetExtensionErrorService;function RegisterDebuggerEvalService(globalScope,debuggerEvalService){GetGlobalVariables(globalScope).debuggerEvalService=debuggerEvalService}BackgroundGlobals.RegisterDebuggerEvalService=RegisterDebuggerEvalService;function GetDebuggerEvalService(globalScope){return GetGlobalVariables(globalScope).debuggerEvalService}BackgroundGlobals.GetDebuggerEvalService=GetDebuggerEvalService;function RegisterDriverEvalService(globalScope,driverEvalService){GetGlobalVariables(globalScope).driverEvalService=driverEvalService}BackgroundGlobals.RegisterDriverEvalService=RegisterDriverEvalService;function GetDriverEvalService(globalScope){return GetGlobalVariables(globalScope).driverEvalService}BackgroundGlobals.GetDriverEvalService=GetDriverEvalService;function RegisterDriverPackageManager(globalScope,service){GetGlobalVariables(globalScope).driverPackageManager=service}BackgroundGlobals.RegisterDriverPackageManager=RegisterDriverPackageManager;function GetDriverPackageManager(globalScope){return GetGlobalVariables(globalScope).driverPackageManager}BackgroundGlobals.GetDriverPackageManager=GetDriverPackageManager;function RegisterExecuteScriptAdapterToMV3(globalScope,service){GetGlobalVariables(globalScope).executeScriptAdapterToMV3=service}BackgroundGlobals.RegisterExecuteScriptAdapterToMV3=RegisterExecuteScriptAdapterToMV3;function GetExecuteScriptAdapterToMV3(globalScope){return GetGlobalVariables(globalScope).executeScriptAdapterToMV3}BackgroundGlobals.GetExecuteScriptAdapterToMV3=GetExecuteScriptAdapterToMV3;function RegisterOriginalChromeApi(globalScope,service){GetGlobalVariables(globalScope).originalChromeApi=service}BackgroundGlobals.RegisterOriginalChromeApi=RegisterOriginalChromeApi;function GetOriginalChromeApi(globalScope){return GetGlobalVariables(globalScope).originalChromeApi}BackgroundGlobals.GetOriginalChromeApi=GetOriginalChromeApi;function RegisterBackgroundPageService(globalScope,service){GetGlobalVariables(globalScope).backgroundPageService=service}BackgroundGlobals.RegisterBackgroundPageService=RegisterBackgroundPageService;function GetBackgroundPageService(globalScope){return GetGlobalVariables(globalScope).backgroundPageService}BackgroundGlobals.GetBackgroundPageService=GetBackgroundPageService;function RegisterEmbeddedDriversMap(globalScope,embeddedDrivers){GetGlobalVariables(globalScope).embeddedDrivers=embeddedDrivers}BackgroundGlobals.RegisterEmbeddedDriversMap=RegisterEmbeddedDriversMap;function GetEmbeddedDriversMap(globalScope){return GetGlobalVariables(globalScope).embeddedDrivers}BackgroundGlobals.GetEmbeddedDriversMap=GetEmbeddedDriversMap;function GetGlobalVariables(globalScope){const globalsKey="g_uiPath_GlobalVariables";let globals=globalScope[globalsKey];if(!globals){globals={loaderWin32:null,loaderPortable:null,loaderStudioWeb:null,tabsService:null,extensionErrorService:null,debuggerEvalService:null,driverEvalService:null,driverPackageManager:null,connectionProxyMatcher:null,executeScriptAdapterToMV3:null,originalChromeApi:null,backgroundPageService:null,embeddedDrivers:new Map};globalScope[globalsKey]=globals}return globals}})(BackgroundGlobals=exports.BackgroundGlobals||(exports.BackgroundGlobals={}))}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.OriginalChromeApi=void 0;const BrowserTools_1=__webpack_require__(3);let globalScope=BrowserTools_1.BrowserTools.GetGlobalThis();globalScope["chrome"]=globalScope["chrome"]||globalScope["browser"];class OriginalChromeApi{static GetTabsSendMessage(){return this.chromeTabSendMessage}static GetTabsQuery(){return this.chromeTabsQuery}}exports.OriginalChromeApi=OriginalChromeApi;OriginalChromeApi.chromeApi=chrome;OriginalChromeApi.chromeTabSendMessage=chrome.tabs.sendMessage;OriginalChromeApi.chromeTabsQuery=chrome.tabs.query}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.BrowserTools=void 0;const Logger_1=__webpack_require__(4);const StringTools_1=__webpack_require__(7);const Tools_1=__webpack_require__(8);var BrowserTools;(function(BrowserTools){function GetTabWindowInfo_Async(tabs){let finalResults=[];let mapWindowIdToRequestInfos={};let windowIdsToCheck={};for(let tab of tabs){let info={tab:tab,window:null};finalResults.push(info);let requestedInfos=mapWindowIdToRequestInfos[tab.windowId];if(!requestedInfos){requestedInfos=[];mapWindowIdToRequestInfos[tab.windowId]=requestedInfos;windowIdsToCheck[tab.windowId]=true}requestedInfos.push(info)}return Tools_1.Tools.ToPromise(resolvePromiseCb=>{chrome.windows.getAll(allWindows=>{for(let window of allWindows){if(Tools_1.Tools.isNil(window.id)||!windowIdsToCheck[window.id]){continue}let requestedInfos=mapWindowIdToRequestInfos[window.id];for(let requestInfo of requestedInfos){requestInfo.window=window}}resolvePromiseCb(finalResults)})})}BrowserTools.GetTabWindowInfo_Async=GetTabWindowInfo_Async;function ForAllParallel(values,processValueCb,onCompletedAllCb){var OnAllCompleted=()=>{if(onCompletedAllCb){onCompletedAllCb()}};var valuesCount=values?values.length:0;if(valuesCount==0){OnAllCompleted();return}let remainingValues=values.length;let OnValueProcessed=()=>{--remainingValues;if(remainingValues<=0){OnAllCompleted()}};for(let value of values){try{processValueCb(value,()=>{OnValueProcessed()})}catch(ex){Logger_1.Logger.Error(String(ex));OnValueProcessed()}}}BrowserTools.ForAllParallel=ForAllParallel;function ForAllSequential(values,processValueCb,onCompletedAllCb){let valueIndex=0;const doNextAction=function(){if(valueIndex>=values.length){if(onCompletedAllCb){onCompletedAllCb()}return}processValueCb(values[valueIndex++],function(){doNextAction()})};doNextAction()}BrowserTools.ForAllSequential=ForAllSequential;function IsBrowserSettingsUrl(url){if(url&&((url.indexOf("chrome://")===0)||(url.indexOf("chrome-extension://")===0)||(url.indexOf("edge://")===0)||(url.indexOf("about:")===0))){return true}return false}BrowserTools.IsBrowserSettingsUrl=IsBrowserSettingsUrl;function GetTabsWithUrl(tabs,targetUrl){let matchedTabs=[];for(let tab of tabs){if(TabHasUrl(tab,targetUrl)){matchedTabs.push(tab)}}return matchedTabs}BrowserTools.GetTabsWithUrl=GetTabsWithUrl;function ExcludeTabsWithUrl(tabs,targetUrl){let matchedTabs=[];for(let tab of tabs){if(!TabHasUrl(tab,targetUrl)){matchedTabs.push(tab)}}return matchedTabs}BrowserTools.ExcludeTabsWithUrl=ExcludeTabsWithUrl;function TabHasUrl(tab,targetUrl){var _a;let tabUrl=(_a=tab.url)!==null&&_a!==void 0?_a:"";return StringTools_1.StringTools.AreEqual(targetUrl,tabUrl,true)}BrowserTools.TabHasUrl=TabHasUrl;function IsAccessibleTab(tabId,onResultCb){chrome.tabs.get(tabId,tab=>{let canAccessUrl=tab&&!Tools_1.Tools.isNil(tab.url)&&!BrowserTools.IsBrowserSettingsUrl(tab.url);onResultCb(canAccessUrl,tab)})}BrowserTools.IsAccessibleTab=IsAccessibleTab;function IsFirefoxBrowser(){let globalThis=BrowserTools.GetGlobalThis();var isFirefox=(globalThis["mozInnerScreenX"]!==undefined);return isFirefox}BrowserTools.IsFirefoxBrowser=IsFirefoxBrowser;function IsChromeBrowser(){var isChromeBrowser=true;if(IsFirefoxBrowser()){isChromeBrowser=false}return isChromeBrowser}BrowserTools.IsChromeBrowser=IsChromeBrowser;function GetGlobalThis(){if(typeof window!="undefined"){return window}return globalThis}BrowserTools.GetGlobalThis=GetGlobalThis;function GetDefaultTab(){return{index:-1,title:"",url:"",pinned:false,highlighted:false,windowId:-1,active:false,id:-1,incognito:false,selected:false,discarded:false,autoDiscardable:false,groupId:-1}}BrowserTools.GetDefaultTab=GetDefaultTab;function GetBrowserWindowData(wnd){var _a,_b,_c,_d,_e,_f;let windowData={windowId:(_a=wnd.id)!==null&&_a!==void 0?_a:0,windowX:(_b=wnd.left)!==null&&_b!==void 0?_b:0,windowY:(_c=wnd.top)!==null&&_c!==void 0?_c:0,windowWidth:(_d=wnd.width)!==null&&_d!==void 0?_d:0,windowHeight:(_e=wnd.height)!==null&&_e!==void 0?_e:0,windowState:(_f=wnd.state)!==null&&_f!==void 0?_f:""};return windowData}BrowserTools.GetBrowserWindowData=GetBrowserWindowData;function WrapWithChromeLastError(lastErrorMsg,actionCb){if(chrome.runtime.lastError){delete chrome.runtime.lastError}chrome.runtime.lastError={message:lastErrorMsg};try{actionCb()}finally{delete chrome.runtime.lastError}}BrowserTools.WrapWithChromeLastError=WrapWithChromeLastError;function _ValidatePermissions(){if(chrome.cookies&&chrome.cookies.getAllCookieStores){chrome.cookies.getAllCookieStores(function(cookieStores){if(!cookieStores){return}for(var i=0;i<cookieStores.length;++i){Logger_1.Logger.Log("Cookie Store Id: "+cookieStores[i].id)}})}if(chrome.webNavigation&&chrome.webNavigation.getAllFrames){chrome.tabs.query({active:true},function(tabs){var _a;if(!tabs||tabs.length===0){return}var activeTab=tabs[0];chrome.webNavigation.getAllFrames({tabId:(_a=activeTab===null||activeTab===void 0?void 0:activeTab.id)!==null&&_a!==void 0?_a:0},function(detailsArray){if(!detailsArray||detailsArray.length===0){return}var activeFrameDetails=detailsArray[0];Logger_1.Logger.Log("Active Tab Frame URL: "+activeFrameDetails.url)})})}if(chrome.debugger&&chrome.debugger.getTargets){chrome.debugger.getTargets(function(targets){if(!targets){return}for(var i=0;i<targets.length;++i){Logger_1.Logger.Log("Debug Target Id: "+targets[i].id)}})}}BrowserTools._ValidatePermissions=_ValidatePermissions})(BrowserTools=exports.BrowserTools||(exports.BrowserTools={}))}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.TimedMethodLogger=exports.MethodLogger=exports.ClassLogger=exports.Logger=void 0;const tslib_1=__webpack_require__(5);const Timer_1=__webpack_require__(6);class Logger{static Log(...data){try{console.log(...data)}catch(e){}}static Warn(...data){try{console.warn(...data)}catch(e){}}static Error(...data){try{console.error(...data)}catch(e){}}}exports.Logger=Logger;class ClassLogger{constructor(classFunc,...prefixArgs){this.className=classFunc.name;this.prefixArgs=prefixArgs}Log(method,...data){Logger.Log(this.GetMessagePrefix(method),...this.prefixArgs,...data)}Warn(method,...data){Logger.Warn(this.GetMessagePrefix(method),...this.prefixArgs,...data)}Error(method,...data){Logger.Error(this.GetMessagePrefix(method),...this.prefixArgs,...data)}GetMessagePrefix(method){return`[${this.className}.${method.name}]`}}exports.ClassLogger=ClassLogger;class MethodLogger{constructor(classLogger,method){this.classLogger=classLogger;this.method=method}Log(...args){this.classLogger.Log(this.method,...args)}Error(...args){this.classLogger.Error(this.method,"durationMs:",...args)}Warn(...args){this.classLogger.Warn(this.method,"durationMs:",...args)}DoTimed_Async(action){return tslib_1.__awaiter(this,void 0,void 0,function*(){let timedLogger=new TimedMethodLogger(this);try{let result=yield action();return result}finally{timedLogger.LogFinish()}})}DoTimed(action){let timedLogger=new TimedMethodLogger(this);try{return action()}finally{timedLogger.LogFinish()}}}exports.MethodLogger=MethodLogger;class TimedMethodLogger{constructor(methodLogger,...initialArgs){this.methodLogger=methodLogger;this.methodLogger.Log("Started...",...initialArgs);this.timer=new Timer_1.Timer}LogFinish(...args){this.methodLogger.Log(...args,"Finished!","durationMs:",this.timer.ElapsedTimeMs())}Log(...args){this.methodLogger.Log(...args,"durationMs:",this.timer.ElapsedTimeMs())}ErrorFinish(...args){this.methodLogger.Error(...args,"Finished!","durationMs:",this.timer.ElapsedTimeMs())}Error(...args){this.methodLogger.Error(...args,"durationMs:",this.timer.ElapsedTimeMs())}WarnFinish(...args){this.methodLogger.Warn(...args,"Finished!","durationMs:",this.timer.ElapsedTimeMs())}Warn(...args){this.methodLogger.Warn(...args,"durationMs:",this.timer.ElapsedTimeMs())}}exports.TimedMethodLogger=TimedMethodLogger}),((__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__);__webpack_require__.d(__webpack_exports__,{__assign:()=>(__assign),__asyncDelegator:()=>(__asyncDelegator),__asyncGenerator:()=>(__asyncGenerator),__asyncValues:()=>(__asyncValues),__await:()=>(__await),__awaiter:()=>(__awaiter),__classPrivateFieldGet:()=>(__classPrivateFieldGet),__classPrivateFieldSet:()=>(__classPrivateFieldSet),__createBinding:()=>(__createBinding),__decorate:()=>(__decorate),__exportStar:()=>(__exportStar),__extends:()=>(__extends),__generator:()=>(__generator),__importDefault:()=>(__importDefault),__importStar:()=>(__importStar),__makeTemplateObject:()=>(__makeTemplateObject),__metadata:()=>(__metadata),__param:()=>(__param),__read:()=>(__read),__rest:()=>(__rest),__spread:()=>(__spread),__spreadArray:()=>(__spreadArray),__spreadArrays:()=>(__spreadArrays),__values:()=>(__values)});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};function __extends(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++){if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t[p[i]]=s[p[i]]}return t}function __decorate(decorators,target,key,desc){var c=arguments.length,r=c<3?target:desc===null?desc=Object.getOwnPropertyDescriptor(target,key):desc,d;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)if(d=decorators[i])r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r;return c>3&&r&&Object.defineProperty(target,key,r),r}function __param(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}}function __metadata(metadataKey,metadataValue){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(metadataKey,metadataValue)}function __awaiter(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})}function __generator(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),"throw":verb(1),"return":verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||(op[1]>t[0]&&op[1]<t[3]))){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}}var __createBinding=Object.create?(function(o,m,k,k2){if(k2===undefined)k2=k;Object.defineProperty(o,k2,{enumerable:true,get:function(){return m[k]}})}):(function(o,m,k,k2){if(k2===undefined)k2=k;o[k2]=m[k]});function __exportStar(m,o){for(var p in m)if(p!=="default"&&!Object.prototype.hasOwnProperty.call(o,p))__createBinding(o,m,p)}function __values(o){var s=typeof Symbol==="function"&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&typeof o.length==="number")return{next:function(){if(o&&i>=o.length)o=void 0;return{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.");}function __read(o,n){var m=typeof Symbol==="function"&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),r,ar=[],e;try{while((n===void 0||n-->0)&&!(r=i.next()).done)ar.push(r.value)}catch(error){e={error:error}}finally{try{if(r&&!r.done&&(m=i["return"]))m.call(i)}finally{if(e)throw e.error;}}return ar}function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar}function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}function __spreadArray(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))}function __await(v){return this instanceof __await?(this.v=v,this):new __await(v)}function __asyncGenerator(thisArg,_arguments,generator){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var g=generator.apply(thisArg,_arguments||[]),i,q=[];return i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i;function verb(n){if(g[n])i[n]=function(v){return new Promise(function(a,b){q.push([n,v,a,b])>1||resume(n,v)})}}function resume(n,v){try{step(g[n](v))}catch(e){settle(q[0][3],e)}}function step(r){r.value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}function fulfill(value){resume("next",value)}function reject(value){resume("throw",value)}function settle(f,v){if(f(v),q.shift(),q.length)resume(q[0][0],q[0][1])}}function __asyncDelegator(o){var i,p;return i={},verb("next"),verb("throw",function(e){throw e;}),verb("return"),i[Symbol.iterator]=function(){return this},i;function verb(n,f){i[n]=o[n]?function(v){return(p=!p)?{value:__await(o[n](v)),done:n==="return"}:f?f(v):v}:f}}function __asyncValues(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=o[Symbol.asyncIterator],i;return m?m.call(o):(o=typeof __values==="function"?__values(o):o[Symbol.iterator](),i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i);function verb(n){i[n]=o[n]&&function(v){return new Promise(function(resolve,reject){v=o[n](v),settle(resolve,reject,v.done,v.value)})}}function settle(resolve,reject,d,v){Promise.resolve(v).then(function(v){resolve({value:v,done:d})},reject)}}function __makeTemplateObject(cooked,raw){if(Object.defineProperty){Object.defineProperty(cooked,"raw",{value:raw})}else{cooked.raw=raw}return cooked};var __setModuleDefault=Object.create?(function(o,v){Object.defineProperty(o,"default",{enumerable:true,value:v})}):function(o,v){o["default"]=v};function __importStar(mod){if(mod&&mod.__esModule)return mod;var result={};if(mod!=null)for(var k in mod)if(k!=="default"&&Object.prototype.hasOwnProperty.call(mod,k))__createBinding(result,mod,k);__setModuleDefault(result,mod);return result}function __importDefault(mod){return(mod&&mod.__esModule)?mod:{default:mod}}function __classPrivateFieldGet(receiver,state,kind,f){if(kind==="a"&&!f)throw new TypeError("Private accessor was defined without a getter");if(typeof state==="function"?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot read private member from an object whose class did not declare it");return kind==="m"?f:kind==="a"?f.call(receiver):f?f.value:state.get(receiver)}function __classPrivateFieldSet(receiver,state,value,kind,f){if(kind==="m")throw new TypeError("Private method is not writable");if(kind==="a"&&!f)throw new TypeError("Private accessor was defined without a setter");if(typeof state==="function"?receiver!==state||!f:!state.has(receiver))throw new TypeError("Cannot write private member to an object whose class did not declare it");return(kind==="a"?f.call(receiver,value):f?f.value=value:state.set(receiver,value)),value}}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.Timer=void 0;class Timer{constructor(){this.startTimeMs=window.performance.now()}ElapsedTimeMs(){return Math.ceil(window.performance.now()-this.startTimeMs)}}exports.Timer=Timer}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.StringTools=void 0;var StringTools;(function(StringTools){function AreEqual(valueA,valueB,ignoreCase){if(valueA===valueB){return true}else if(!valueA||!valueB){return false}if(ignoreCase){valueA=valueA.toLowerCase();valueB=valueB.toLowerCase()}return(valueA===valueB)}StringTools.AreEqual=AreEqual;function AreEqualAsCode(valueA,valueB,ignoreCase){valueA=valueA.replace(/\/\*[\s\S]*?\*\/|\/\/.*/g,'');valueB=valueB.replace(/\/\*[\s\S]*?\*\/|\/\/.*/g,'');valueA=valueA.replace(/[^a-zA-Z0-9]+/g,'');valueB=valueB.replace(/[^a-zA-Z0-9]+/g,'');return AreEqual(valueA,valueB,ignoreCase)}StringTools.AreEqualAsCode=AreEqualAsCode;function SafeReplaceString(str,valueToReplace,replacement){let startIndex=str.indexOf(valueToReplace);let beginStr=str.slice(0,startIndex);let endStr=str.slice(startIndex+valueToReplace.length);let result=beginStr;result+=replacement;result+=endStr;return result}StringTools.SafeReplaceString=SafeReplaceString;function Contains(str,subStringToCheck){return str.indexOf(subStringToCheck)>=0}StringTools.Contains=Contains;function GetFunctionBody(func){const functionCode=func.toString();const openBracketIndex=functionCode.indexOf("{");const closeBracketIndex=functionCode.lastIndexOf("}");const functionBody=functionCode.substring(openBracketIndex+1,closeBracketIndex);return functionBody}StringTools.GetFunctionBody=GetFunctionBody})(StringTools=exports.StringTools||(exports.StringTools={}))}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.Tools=void 0;var Tools;(function(Tools){function IsFunction(value){return(typeof(value)==="function")}Tools.IsFunction=IsFunction;function isNil(value){return value===null||value===undefined}Tools.isNil=isNil;function IsDefined(value){return!isNil(value)}Tools.IsDefined=IsDefined;function IsUndefined(type){return type==="undefined"}Tools.IsUndefined=IsUndefined;function UnsafeCast(value){return value}Tools.UnsafeCast=UnsafeCast;function ToPromise(actionWithCallback){let promise=new Promise(resolvePromiseCb=>{actionWithCallback(resolvePromiseCb)});return promise}Tools.ToPromise=ToPromise;function ToTimedPromise(actionWithCallback,timeoutMs){return Promise.race([ToPromise(actionWithCallback),new Promise((_resolvePromiseCb,rejectPromiseCb)=>{setTimeout(()=>{rejectPromiseCb("Action timeout out!")},timeoutMs)})])}Tools.ToTimedPromise=ToTimedPromise;function SafeIncrementWithWrapAround(value){if(value>=Number.MAX_SAFE_INTEGER){value=0}return(value+1)}Tools.SafeIncrementWithWrapAround=SafeIncrementWithWrapAround;let LoopAction;(function(LoopAction){LoopAction[LoopAction["Stop"]=0]="Stop";LoopAction[LoopAction["Continue"]=1]="Continue"})(LoopAction=Tools.LoopAction||(Tools.LoopAction={}));function RetryWithTimeout(actionCb,timeoutMs){let wrapperFunc=()=>{let loopAction=actionCb();if(loopAction===LoopAction.Continue){setTimeout(wrapperFunc,timeoutMs)}};wrapperFunc()}Tools.RetryWithTimeout=RetryWithTimeout;function RetryWithTimeoutAsync(actionCb,timeoutMs){let wrapperFunc=()=>{actionCb().then(loopAction=>{if(loopAction===LoopAction.Continue){setTimeout(wrapperFunc,timeoutMs)}})};wrapperFunc()}Tools.RetryWithTimeoutAsync=RetryWithTimeoutAsync})(Tools=exports.Tools||(exports.Tools={}))}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.BackgroundPageService=void 0;const tslib_1=__webpack_require__(5);const BrowserTools_1=__webpack_require__(3);const Tools_1=__webpack_require__(8);const Logger_1=__webpack_require__(4);class BackgroundPageService{constructor(originalTabsQuery){this.classLogger=new Logger_1.ClassLogger(BackgroundPageService);this.originalTabsQuery=originalTabsQuery}OpenExtensionWindowAndWaitUntilInitialized_Async(timeoutMs){return tslib_1.__awaiter(this,void 0,void 0,function*(){let logger=new Logger_1.MethodLogger(this.classLogger,this.OpenExtensionWindowAndWaitUntilInitialized_Async);let success=yield this.OpenExtensionWindow_Async();logger.Log("success:",success);if(!success){return false}return Tools_1.Tools.ToPromise(resolvePromiseCb=>{let remainingTimeMs=timeoutMs;const sleepTimeMs=100;let checkIfExtensionWindowHasOpened=()=>{this.GetExtensionWindowId_Async().then(extensionWindowId=>{logger.Log("extensionWindowId:",extensionWindowId);if(extensionWindowId==null){if(remainingTimeMs>0){remainingTimeMs-=sleepTimeMs;return setTimeout(checkIfExtensionWindowHasOpened,sleepTimeMs)}else{logger.Error("Timed-out while waiting for extension window to initialize");return resolvePromiseCb(false)}}else{return resolvePromiseCb(true)}})};checkIfExtensionWindowHasOpened()})})}OpenExtensionWindow_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let logger=new Logger_1.MethodLogger(this.classLogger,this.OpenExtensionWindow_Async);let isOpen=yield this.IsExtensionWindowOpen_Async();if(isOpen){logger.Log("Extension window is already open");return isOpen}logger.Log("Started");let wndData={state:"minimized",type:"popup",url:BackgroundPageService.s_extensionUrl};return Tools_1.Tools.ToPromise(resolvePromiseCb=>{chrome.windows.create(wndData,function(wnd){var _a;if(chrome.runtime.lastError){logger.Error("Failed to create window; lastError:",chrome.runtime.lastError.message);resolvePromiseCb(false);return}logger.Log("Created wnd.id:",wnd===null||wnd===void 0?void 0:wnd.id);chrome.windows.update((_a=wnd===null||wnd===void 0?void 0:wnd.id)!==null&&_a!==void 0?_a:0,{focused:false},()=>{resolvePromiseCb(true)})})})})}InitAsExtensionWindow_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let extensionTabs=yield this.GetAllExtensionTabs_Async();this.classLogger.Log(this.InitAsExtensionWindow_Async,"extensionTabs.length:",extensionTabs.length);let tabsToClose=yield this.GetExtensionTabsToClose_Async(extensionTabs);return Tools_1.Tools.ToPromise(resolvePromiseCb=>{BrowserTools_1.BrowserTools.ForAllParallel(tabsToClose,(tab,onActionCompleted)=>{if(Tools_1.Tools.isNil(tab===null||tab===void 0?void 0:tab.id)){onActionCompleted();return}this.classLogger.Log(this.InitAsExtensionWindow_Async,"closing tab.id:",tab.id,", tab.windowId:",tab.windowId);chrome.tabs.remove(tab.id,onActionCompleted)},()=>{this.GetExtensionWindowId_Async().then(windowId=>{resolvePromiseCb(windowId!==null&&windowId!==void 0?windowId:0)})})})})}GetExtensionWindowId_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let tab=yield this.GetExtensionTab_Async();let windowId=tab===null||tab===void 0?void 0:tab.windowId;if(Tools_1.Tools.isNil(windowId)){return null}return windowId})}static GetExtensionPageUrl(){return BackgroundPageService.s_extensionUrl}GetExtensionTab_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let extensionTabs=yield this.GetAllExtensionTabs_Async();let extensionTab=(extensionTabs.length!=0)?extensionTabs[0]:null;return extensionTab})}GetAllExtensionTabs_Async(){return Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.originalTabsQuery({},foundTabs=>{if(Tools_1.Tools.isNil(foundTabs)){foundTabs=[]}let extensionTabs=BrowserTools_1.BrowserTools.GetTabsWithUrl(foundTabs,BackgroundPageService.s_extensionUrl);resolvePromiseCb(extensionTabs)})})}IsExtensionWindowOpen_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let extensionTab=yield this.GetExtensionTab_Async();let isOpen=(extensionTab!=null);return isOpen})}GetExtensionTabsToClose_Async(extensionTabs){var _a;return tslib_1.__awaiter(this,void 0,void 0,function*(){if(extensionTabs.length<=1){return[]}let tabWindowInfos=yield BrowserTools_1.BrowserTools.GetTabWindowInfo_Async(extensionTabs);let tabToKeep=null;let tabsToClose=[];for(let tabWindowInfo of tabWindowInfos){if(tabToKeep){tabsToClose.push(tabWindowInfo.tab)}else if(((_a=tabWindowInfo.window)===null||_a===void 0?void 0:_a.type)==="popup"){tabToKeep=tabWindowInfo.tab}else{tabsToClose.push(tabWindowInfo.tab)}}return tabsToClose})}}exports.BackgroundPageService=BackgroundPageService;BackgroundPageService.s_extensionUrl=chrome.runtime.getURL("BackgroundPage.html")}),,,((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ExtensionConfigService=void 0;const Tools_1=__webpack_require__(8);const EXTENSION_CONFIG_STUDIO_DESKTOP="WebStore_StudioDesktop";const EXTENSION_CONFIG_STUDIO_WEB="WebStore_StudioWeb";const EXTENSION_CONFIG_SELF_HOSTED="SelfHosted_StudioDesktop";class ExtensionConfigService{static GetConfig(){const extensionConfigName=this.GetConfigName();if(extensionConfigName===EXTENSION_CONFIG_STUDIO_DESKTOP){return this.studioDesktopConfig}else if(extensionConfigName===EXTENSION_CONFIG_STUDIO_WEB){return this.studioWebConfig}else if(extensionConfigName===EXTENSION_CONFIG_SELF_HOSTED){return this.selfHostedConfig}else{let unhandledType=extensionConfigName;return this.studioDesktopConfig}}static GetConfigName(){if(Tools_1.Tools.IsUndefined(typeof "WebStore_StudioDesktop")){return EXTENSION_CONFIG_STUDIO_DESKTOP}return "WebStore_StudioDesktop"}}exports.ExtensionConfigService=ExtensionConfigService;ExtensionConfigService.selfHostedConfig={AllowInteropWithStudioWeb:false,AllowExtensionAutoUpdate:true,AllowInteropWithNativeHostsOnWindows:true,RegisterContentEventListeners:false};ExtensionConfigService.studioDesktopConfig={AllowInteropWithStudioWeb:false,AllowExtensionAutoUpdate:false,AllowInteropWithNativeHostsOnWindows:true,RegisterContentEventListeners:false};ExtensionConfigService.studioWebConfig={AllowInteropWithStudioWeb:true,AllowExtensionAutoUpdate:false,AllowInteropWithNativeHostsOnWindows:false,RegisterContentEventListeners:true}}),,,((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ContentTarget=void 0;class ContentTarget{constructor(tabId,frameId){this.TabId=tabId;this.FrameId=frameId}toString(){return`{ TabId: ${this.TabId}, FrameId: ${this.FrameId}}`}Equals(other){return(this.TabId==other.TabId)&&(this.FrameId==other.FrameId)}}exports.ContentTarget=ContentTarget}),,((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.Get_InjectJs_EvalWrapper=exports.InjectAndRunJS_AdapterToMV3=void 0;const ContentDriverContracts_1=__webpack_require__(18);const StringTools_1=__webpack_require__(7);function InjectAndRunJS_AdapterToMV3(injectJsRequests,gcontext,message){var _a;const N_FALSE=0;const N_TRUE=1;let getRetValueForScriptException=hasThrown=>{let hasExceptionRetCode=N_TRUE;let hasNoExceptionRetCode=N_FALSE;if(!message.hasFixForIsScriptErr){hasExceptionRetCode=N_FALSE;hasNoExceptionRetCode=N_TRUE}return hasThrown?hasExceptionRetCode:hasNoExceptionRetCode};let makeResponse_Success=result=>{return{result:result,retCode:N_TRUE,isScriptErr:getRetValueForScriptException(false)}};let makeResponse_ScriptSyntaxError=errMsg=>{return{result:errMsg,retCode:N_TRUE,isScriptErr:N_TRUE}};let makeResponse_ScriptHasThrown=errMsg=>{return{result:errMsg,retCode:N_TRUE,isScriptErr:getRetValueForScriptException(true)}};let makeResponse_RequestError=()=>{return{result:"",retCode:N_FALSE,isScriptErr:N_FALSE}};if(message.evalInjectJsErrorMsg){return makeResponse_ScriptSyntaxError(message.evalInjectJsErrorMsg)}try{let targetElement=null;if(message.customId.length!==0){targetElement=(_a=gcontext.GetElementFromCustomId(message.customId))!==null&&_a!==void 0?_a:null;if(!targetElement){gcontext.TraceMessage("[InjectAndRunJS_AdapterToMV3] customId="+message.customId+" not found in the cache");return makeResponse_RequestError()}}let injectJsFunc=GetInjectJsScriptFromId(injectJsRequests,message.requestId);if(!injectJsFunc){gcontext.TraceError("[InjectAndRunJS_AdapterToMV3] No script available for request id: "+message.requestId);return makeResponse_RequestError()}try{gcontext.TraceMessage("[InjectAndRunJS_AdapterToMV3] Calling WrapperFunction");let result=injectJsFunc(targetElement,message.inputData,message.tabId);let out_value=(result==null)?result:String(result);return makeResponse_Success(out_value)}catch(ex){let errAsString=String(ex);gcontext.TraceError("[InjectAndRunJS_AdapterToMV3] WrapperFunc exception: "+errAsString);return makeResponse_ScriptHasThrown(errAsString)}}catch(e){gcontext.TraceError("[InjectAndRunJS_AdapterToMV3] exception: "+e);return makeResponse_RequestError()}}exports.InjectAndRunJS_AdapterToMV3=InjectAndRunJS_AdapterToMV3;function GetInjectJsScriptFromId(injectJsRequests,requestId){let func;switch(requestId){case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.Invalid:func=undefined;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.SetHighlight:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.SetHighlight;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.SetHighlightModern:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.SetHighlightModern;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.SetHighlightModernV2:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.SetHighlightModernV2;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.RemoveHighlight:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.RemoveHighlight;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.RemoveHighlightModern:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.RemoveHighlightModern;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.IsTableHeader:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.IsTableHeader;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.IsVisibleFromStyle:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.IsVisibleFromStyle;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.IsVisibleFromStyleModern:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.IsVisibleFromStyleModern;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.ScrollNative:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.ScrollNative;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.MatchCssSelector:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.MatchCssSelector;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.ExtractMetadata:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.ExtractMetadata;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.ExtractData:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.ExtractData;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.ExtractDataCleanup:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.ExtractDataCleanup;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.IsVisible:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.IsVisible;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.SelectMultiple:func=injectJsRequests===null||injectJsRequests===void 0?void 0:injectJsRequests.SelectMultiple;break;case ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.EvaluatedInjectJsFunc:func=window["g_eval_Content_InjectJsFunc"];window["g_eval_Content_InjectJsFunc"]=null;break;default:let _unhandledType=requestId;break}return func}function Get_InjectJs_EvalWrapper(clientFuncCodeToEval){let __clientFuncCodeToEval=()=>{};let functionTemplate=function(){window["g_eval_Content_InjectJsFunc"]=function(targetElement,inputData,tabId){let clientFunc=__clientFuncCodeToEval;return clientFunc(targetElement,inputData,tabId)}};let template=StringTools_1.StringTools.GetFunctionBody(functionTemplate);let evalWrapper=StringTools_1.StringTools.SafeReplaceString(template,"__clientFuncCodeToEval",clientFuncCodeToEval);return evalWrapper}exports.Get_InjectJs_EvalWrapper=Get_InjectJs_EvalWrapper}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ContentDriver=void 0;var ContentDriver;(function(ContentDriver){let InjectJsScriptRequestId;(function(InjectJsScriptRequestId){InjectJsScriptRequestId[InjectJsScriptRequestId["Invalid"]=0]="Invalid";InjectJsScriptRequestId[InjectJsScriptRequestId["SetHighlight"]=1]="SetHighlight";InjectJsScriptRequestId[InjectJsScriptRequestId["SetHighlightModern"]=2]="SetHighlightModern";InjectJsScriptRequestId[InjectJsScriptRequestId["SetHighlightModernV2"]=3]="SetHighlightModernV2";InjectJsScriptRequestId[InjectJsScriptRequestId["RemoveHighlight"]=4]="RemoveHighlight";InjectJsScriptRequestId[InjectJsScriptRequestId["RemoveHighlightModern"]=5]="RemoveHighlightModern";InjectJsScriptRequestId[InjectJsScriptRequestId["IsTableHeader"]=6]="IsTableHeader";InjectJsScriptRequestId[InjectJsScriptRequestId["IsVisibleFromStyle"]=7]="IsVisibleFromStyle";InjectJsScriptRequestId[InjectJsScriptRequestId["IsVisibleFromStyleModern"]=8]="IsVisibleFromStyleModern";InjectJsScriptRequestId[InjectJsScriptRequestId["ScrollNative"]=9]="ScrollNative";InjectJsScriptRequestId[InjectJsScriptRequestId["MatchCssSelector"]=10]="MatchCssSelector";InjectJsScriptRequestId[InjectJsScriptRequestId["ExtractMetadata"]=11]="ExtractMetadata";InjectJsScriptRequestId[InjectJsScriptRequestId["ExtractData"]=12]="ExtractData";InjectJsScriptRequestId[InjectJsScriptRequestId["ExtractDataCleanup"]=13]="ExtractDataCleanup";InjectJsScriptRequestId[InjectJsScriptRequestId["IsVisible"]=14]="IsVisible";InjectJsScriptRequestId[InjectJsScriptRequestId["SelectMultiple"]=15]="SelectMultiple";InjectJsScriptRequestId[InjectJsScriptRequestId["EvaluatedInjectJsFunc"]=16]="EvaluatedInjectJsFunc"})(InjectJsScriptRequestId=ContentDriver.InjectJsScriptRequestId||(ContentDriver.InjectJsScriptRequestId={}))})(ContentDriver=exports.ContentDriver||(exports.ContentDriver={}))}),,,((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.BackgroundPackageManager=void 0;const tslib_1=__webpack_require__(5);const Logger_1=__webpack_require__(4);const Tools_1=__webpack_require__(8);const ContentTarget_1=__webpack_require__(15);const BackgroundDriverPackage_1=__webpack_require__(22);const SalesForce_PageWorld_1=__webpack_require__(24);const SapFiori_PageWorld_1=__webpack_require__(25);const DetailedDriverVersion_1=__webpack_require__(26);class BackgroundPackageManager{constructor(driverEvalService,tabsService,originalChromeFunctions,embeddedDriversContainer){this.drivers=new Map;this.activeDriver=null;this.classLogger=new Logger_1.ClassLogger(BackgroundPackageManager);this.driverEvalService=driverEvalService;this.tabsService=tabsService;this.originalChromeFunctions=originalChromeFunctions;this.embeddedDriversContainer=embeddedDriversContainer;chrome.runtime.onMessage.addListener((msg,sender,responseCb)=>{var _a;if(!this.IsRequestToBackground(msg)){return false}if(msg.RequestId===1&&sender.tab){let response=this.OnTabFrameConnected(sender.tab,(_a=sender.frameId)!==null&&_a!==void 0?_a:0);responseCb(response)}return false})}LoadDriverPackage(codeData,nativeHostToBackground,onCompletedCb){this.LoadDriverPackage_Async(codeData,nativeHostToBackground).then(loadedDriver=>{onCompletedCb(loadedDriver)})}LoadDriverPackage_Async(codeData,nativeHostToBackground){return tslib_1.__awaiter(this,void 0,void 0,function*(){let codeVersion=codeData.version.toString();if(this.IsDriverAvailable(codeVersion)){this.classLogger.Log(this.LoadDriverPackage,"Already loaded codeVersion:",codeVersion);yield this.ActivateDriverVersion_Async(codeVersion)}else{this.classLogger.Log(this.LoadDriverPackage,"Loading new codeVersion:",codeVersion);let interfaceToDriver={driverCodeData:codeData,nativeHost:nativeHostToBackground,sendRequestToContent:(tabId,frameId,request,onCompletedCb)=>{this.SendRequestToContentDriver_Async(codeVersion,tabId,frameId,request).then(onCompletedCb)},originalChromeFunctions:this.originalChromeFunctions};let driverData=yield this.driverEvalService.EvalDriver_Async(codeData,interfaceToDriver);if(!driverData){let compatibleCodeVersion=yield this.GetCompatibleDriverVersion(codeData,nativeHostToBackground);if(!Tools_1.Tools.isNil(compatibleCodeVersion)){driverData=this.LoadEmbeddedDriverData(compatibleCodeVersion,codeData,interfaceToDriver)}else{this.classLogger.Error(this.LoadDriverPackage,"Detected unavailable version:",codeVersion)}}if(!driverData){this.classLogger.Error(this.LoadDriverPackage,"Could not load codeVersion:",codeVersion);return false}let driverPackage=this.GetAvailableDriverPackageWithVersion(driverData.version);if(!driverPackage){driverPackage=new BackgroundDriverPackage_1.BackgroundDriverPackage(driverData,this.tabsService,this.driverEvalService)}this.drivers.set(codeVersion,driverPackage);yield this.ActivateDriverVersion_Async(codeVersion)}this.classLogger.Log(this.LoadDriverPackage,"Finished loading codeVersion:",codeVersion);return true})}LoadEmbeddedDriverData(codeVersion,codeData,interfaceToDriver){var _a;this.classLogger.Log(this.LoadEmbeddedDriverData,"Loading new embedded version:",codeVersion);let embeddedDriverCode=this.GetEmbeddedDriverCodeData(codeVersion);if(Tools_1.Tools.isNil(embeddedDriverCode)){return null}let getDriverAdapterFunc=Tools_1.Tools.UnsafeCast(embeddedDriverCode.backgroundCode());let getContentScriptFunc=scriptName=>{return{code:scriptName}};let backgroundAdapter=getDriverAdapterFunc(getContentScriptFunc,codeData,interfaceToDriver.nativeHost,interfaceToDriver);let driverCodeFlags=embeddedDriverCode.driverFlags;let contentCode_PageWorld=(_a=embeddedDriverCode.contentCode_PageWorld)!==null&&_a!==void 0?_a:this.GetDefaultDriverContentCode_PageWorld(driverCodeFlags);let driverData={version:codeVersion,backgroundAdapter:backgroundAdapter,contentCode_ExtensionWorld:embeddedDriverCode.contentCode_ExtensionWorld,contentCode_PageWorld:contentCode_PageWorld,driverFlags:driverCodeFlags,injectJsCode:embeddedDriverCode.injectJsCode};return driverData}GetDefaultDriverContentCode_PageWorld(driverCodeFlags){let pageWorldInjectedFunctions=[];if(driverCodeFlags.needsSapFioriAdapterToMV3){pageWorldInjectedFunctions.push(SapFiori_PageWorld_1.SapFiori_PageWorld_InjectedFunc)}if(driverCodeFlags.needsSalesForceAdapterToMV3){pageWorldInjectedFunctions.push(SalesForce_PageWorld_1.SalesForce_PageWorld_InjectedFunc)}return pageWorldInjectedFunctions}GetEmbeddedDriverCodeData(codeVersion){for(let[versionInfo,codeData]of this.embeddedDriversContainer){if(versionInfo.uniqueId==codeVersion){return codeData}}return undefined}ProcessDriverRequest(codeVersion,message,onCompletedCb){this.ProcessDriverRequest_Async(codeVersion,message).then(onCompletedCb)}ProcessDriverRequest_Async(codeVersion,message){return tslib_1.__awaiter(this,void 0,void 0,function*(){let driver=yield this.ActivateDriverVersion_Async(codeVersion);if(!driver){return undefined}return driver.HandleBackgroundRequest_Async(Tools_1.Tools.UnsafeCast(message))})}SendRequestToContentDriver_Async(codeVersion,tabId,frameId,message){return tslib_1.__awaiter(this,void 0,void 0,function*(){let driver=this.drivers.get(codeVersion);if(!driver){return undefined}let target=new ContentTarget_1.ContentTarget(tabId,frameId);return driver.SendRequestToContentDriver_Async(target,message)})}IsDriverAvailable(codeVersion){return this.drivers.has(codeVersion)}IsDriverVersionEmbedded(codeVersion){for(let versionInfo of this.embeddedDriversContainer.keys()){if(versionInfo.uniqueId==codeVersion){return true}}return false}GetCompatibleDriverVersion(codeData,nativeHostToBackground){return tslib_1.__awaiter(this,void 0,void 0,function*(){let codeVersion=codeData.version.toString();if(this.IsDriverVersionEmbedded(codeVersion)){return codeVersion}let detailedDriverVersion=yield this.GetDetailedDriverVersion(nativeHostToBackground,codeData.detailedVersion);if(Tools_1.Tools.isNil(detailedDriverVersion)){this.classLogger.Error(this.GetCompatibleDriverVersion,"Cannot retrieve detailed driver version to determine a compatible package");return null}this.classLogger.Log(this.GetCompatibleDriverVersion,"Detailed codeVersion:",codeVersion,"=",detailedDriverVersion.ToString());for(let versionInfo of this.embeddedDriversContainer.keys()){if(versionInfo.detailedVersion.IsCompatibleWith(detailedDriverVersion)){this.classLogger.Warn(this.GetCompatibleDriverVersion,"Using compatible driver version:",versionInfo.uniqueId,"=",versionInfo.detailedVersion.ToString());return versionInfo.uniqueId}}this.classLogger.Log(this.GetCompatibleDriverVersion,"No compatible driver version found for: ",codeVersion);return null})}GetDetailedDriverVersion(nativeHostToBackground,detailedVersion){return tslib_1.__awaiter(this,void 0,void 0,function*(){try{if(Tools_1.Tools.isNil(detailedVersion)){detailedVersion=(yield Tools_1.Tools.ToTimedPromise(resolvePromiseCb=>{nativeHostToBackground.CallFunction("GetDetailedDriverVersion",{},completeVersion=>{resolvePromiseCb(completeVersion)})},10000))}return new DetailedDriverVersion_1.DetailedDriverVersion(detailedVersion.versionMajor,detailedVersion.versionMinor,detailedVersion.buildNumberMajor,detailedVersion.buildNumberMinor)}catch(err){this.classLogger.Error(this.GetDetailedDriverVersion,"Native Host request for driver version failed with err:",err);return null}})}GetActiveDriver(){return this.activeDriver}ActivateDriverVersion_Async(codeVersion){return tslib_1.__awaiter(this,void 0,void 0,function*(){let requestedDriver=this.drivers.get(codeVersion);if(!requestedDriver){this.classLogger.Error(this.ActivateDriverVersion_Async,"Unavailable codeVersion:",codeVersion);return null}if(this.activeDriver===requestedDriver){return this.activeDriver}if(this.activeDriver){let previousDriver=this.activeDriver;this.activeDriver=null;previousDriver.Deactivate()}this.activeDriver=requestedDriver;yield requestedDriver.Activate_Async();this.classLogger.Log(this.ActivateDriverVersion_Async,"Activated codeVersion:",codeVersion);return requestedDriver})}OnTabFrameConnected(senderTab,frameId){var _a;let tabId=(_a=senderTab.id)!==null&&_a!==void 0?_a:0;let target=new ContentTarget_1.ContentTarget(tabId,frameId);for(let driver of this.drivers.values()){driver.OnTabFrameConnected(target)}let response={Data:{TabId:tabId,FrameId:frameId,Tab:senderTab}};return response}IsRequestToBackground(message){if((message===null||message===void 0?void 0:message.ChannelId)==="Extension_RequestToBackground"){return true}return false}CanLoadDriverVersion(detailedDriverVersion){return tslib_1.__awaiter(this,void 0,void 0,function*(){for(let versionInfo of this.embeddedDriversContainer.keys()){if(versionInfo.detailedVersion.IsCompatibleWith(detailedDriverVersion)){return true}}let isEvalRestricted=yield this.driverEvalService.IsEvalRestricted_Async();return!isEvalRestricted})}GetEmbeddedDriverVersions(){let driverVersions=[];for(let versionInfo of this.embeddedDriversContainer.keys()){driverVersions.push(versionInfo.detailedVersion.ToString())}return driverVersions}GetAvailableDriverPackageWithVersion(version){for(let[_driverVersion,driverPackage]of this.drivers){if(driverPackage.GetVersion()===version){return driverPackage}}return null}}exports.BackgroundPackageManager=BackgroundPackageManager}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.BackgroundDriverPackage=void 0;const tslib_1=__webpack_require__(5);const ContentDriverContracts_1=__webpack_require__(18);const ActionWithEntrancyGuard_1=__webpack_require__(23);const ContentTarget_1=__webpack_require__(15);const Logger_1=__webpack_require__(4);const Tools_1=__webpack_require__(8);const StringTools_1=__webpack_require__(7);class BackgroundDriverPackage{constructor(driverData,tabsService,evalService){this.pendingDriverLoadInfoArray=[];this.isActive=false;this.driverData=driverData;this.driverFlags=driverData.driverFlags;this.tabsService=tabsService;this.evalService=evalService;this.classLogger=new Logger_1.ClassLogger(BackgroundDriverPackage,"version:",driverData.version);this.activateGuard=new ActionWithEntrancyGuard_1.ActionWithEntrancyGuard(onCompletedCb=>{this.Activate_Internal_Async().then(onCompletedCb)})}Activate(onCompletedCb){this.activateGuard.DoAction(onCompletedCb)}Activate_Async(){return Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.Activate(resolvePromiseCb)})}Deactivate(){let methodLogger=new Logger_1.MethodLogger(this.classLogger,this.Deactivate);return methodLogger.DoTimed(()=>{if(!this.isActive){return}this.isActive=false;this.driverData.backgroundAdapter.FinalizeBackground();this.DeactivateDriverInAllTabs()})}Activate_Internal_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){let methodLogger=new Logger_1.MethodLogger(this.classLogger,this.Activate_Internal_Async);return methodLogger.DoTimed_Async(()=>tslib_1.__awaiter(this,void 0,void 0,function*(){if(this.isActive){return}this.isActive=true;this.driverData.backgroundAdapter.InitializeBackground();yield this.LoadInAllTabsIfNeeded_Async();this.driverData.backgroundAdapter.PostContentInitialize()}))})}IsActive(){return this.isActive}OnTabFrameConnected(target){this.driverData.backgroundAdapter.OnTabFrameConnected(target.TabId,target.FrameId);if(!this.isActive){return}if(this.driverFlags.needsToBeLoadedInAllTabsOnActivate){this.LoadInTarget_Async(target)}}LoadInTarget_Async(target){let methodLogger=new Logger_1.MethodLogger(this.classLogger,this.LoadInTarget_Async);return this.LoadInTargetGuarded_Async(target,()=>tslib_1.__awaiter(this,void 0,void 0,function*(){methodLogger.Log("target:",target.toString());const driverVersion=this.GetVersion();const contentInjectionArgs=[driverVersion];let injectSuccess=yield Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.tabsService.ExecuteScriptInTabFrame(target,this.GetContentCode_ExtensionWorld(),resolvePromiseCb)});if(!injectSuccess){methodLogger.Error("Failed to load in target:",target.toString(),"in ExtensionWorld");return false}let injectJsCode=this.GetInjectJsCode();if(injectJsCode!=null){let injectJsCode_NotNull=injectJsCode;let injectJsScriptsSuccess=yield Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.tabsService.ExecuteScriptInTabFrame(target,injectJsCode_NotNull,resolvePromiseCb)});if(!injectJsScriptsSuccess){methodLogger.Error("Failed to load custom JS scripts in target:",target.toString(),"in ExtensionWorld");return false}}let contentCode_PageWorld=this.GetContentCode_PageWorld();for(let contentCodeFunc of contentCode_PageWorld){let injectPageWorldSuccess=yield Tools_1.Tools.ToPromise(resolvePromiseCb=>{let contentCodeAction=contentCodeFunc;this.tabsService.ExecuteScriptInTabFrame_PageWorld(target,contentCodeAction,contentInjectionArgs,resolvePromiseCb)});if(!injectPageWorldSuccess){methodLogger.Warn("Failed to load in target:",target.toString(),"in PageWorld")}}let request={ChannelId:"Extension_RequestToContent",Type:1,DriverCodeVersion:this.GetVersion()};let activateSuccess=yield Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.tabsService.SendMessageToTabFrame(target,request,response=>{resolvePromiseCb((response===null||response===void 0?void 0:response.ReturnCode)==1)})});methodLogger.Log("target:",target.toString(),"activateSuccess:",activateSuccess);return activateSuccess}))}LoadInTargetGuarded_Async(target,loadInTarget_Async){let methodLogger=new Logger_1.MethodLogger(this.classLogger,this.LoadInTargetGuarded_Async);methodLogger.Log("target:",target.toString());let pendingLoadInfo=this.GetPendingLoadForTarget(target);if(pendingLoadInfo){methodLogger.Log("Loading is already in progress for target:",target.toString());return pendingLoadInfo.loadDriverPromise}let loadPromise=loadInTarget_Async().then(loadSuccess=>{this.OnLoadInTargetFinished(target,loadSuccess);return loadSuccess});this.pendingDriverLoadInfoArray.push({target:target,loadDriverPromise:loadPromise});return loadPromise}GetPendingLoadForTarget(target){for(let driverLoadInTargetInfo of this.pendingDriverLoadInfoArray){if(driverLoadInTargetInfo.target.Equals(target)){return driverLoadInTargetInfo}}return null}OnLoadInTargetFinished(target,loadSuccess){this.classLogger.Log(this.OnLoadInTargetFinished,"target:",target.toString(),"loadSuccess:",loadSuccess);for(let i=0;i<this.pendingDriverLoadInfoArray.length;++i){let driverLoadInTargetInfo=this.pendingDriverLoadInfoArray[i];if(driverLoadInTargetInfo.target.Equals(target)){this.pendingDriverLoadInfoArray.splice(i,1);break}}}HandleBackgroundRequest(message,onCompletedCb){this.HandleBackgroundRequest_Async(message).then(onCompletedCb)}HandleBackgroundRequest_Async(message){return tslib_1.__awaiter(this,void 0,void 0,function*(){return Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.driverData.backgroundAdapter.ProcessRequest(message,resolvePromiseCb)})})}SendRequestToContentDriver_Async(target,message){var _a,_b;return tslib_1.__awaiter(this,void 0,void 0,function*(){let request={ChannelId:"Extension_RequestToDriver",Type:1,DriverCodeVersion:this.GetVersion(),RequestData:message};let result=yield this.SendRequestToContent_Async(request,target);if(!result.success){return null}return(_b=(_a=result===null||result===void 0?void 0:result.data)===null||_a===void 0?void 0:_a.ResponseData)!==null&&_b!==void 0?_b:null})}ExecuteContentScript_Async(scriptName,target){return tslib_1.__awaiter(this,void 0,void 0,function*(){let request={ChannelId:"Extension_RequestToContent",Type:3,DriverCodeVersion:this.GetVersion(),ScriptToExecute:scriptName};let result=yield this.SendRequestToContent_Async(request,target);if(!result.success){return result}return{success:true,data:null}})}ExecuteContentInlineCode_Async(requestId,target){var _a;return tslib_1.__awaiter(this,void 0,void 0,function*(){let request={ChannelId:"Extension_RequestToContent",Type:4,DriverCodeVersion:this.GetVersion(),RequestId:requestId};let result=yield this.SendRequestToContent_Async(request,target);if(!result.success){return result}return{success:true,data:(_a=result.data)===null||_a===void 0?void 0:_a.ResponseData}})}SendRequestToContent_Async(request,target){var _a,_b;return tslib_1.__awaiter(this,void 0,void 0,function*(){let sendMsgAsync=()=>tslib_1.__awaiter(this,void 0,void 0,function*(){let pendingLoadInfo=this.GetPendingLoadForTarget(target);if(pendingLoadInfo){this.classLogger.Log(this.SendRequestToContent_Async,"Loading is already in progress for target:",target.toString());yield pendingLoadInfo.loadDriverPromise}return Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.tabsService.SendMessageToTabFrame(target,request,response=>{var _a;if(chrome.runtime.lastError){let errorMsg=(_a=chrome.runtime.lastError.message)!==null&&_a!==void 0?_a:"<unknown_error>";this.classLogger.Error(this.SendRequestToContent_Async,"target:",target.toString(),"chrome.runtime.lastError:",errorMsg);return resolvePromiseCb({success:false,errorMsg:errorMsg})}return resolvePromiseCb({success:true,data:response})})})});let result=yield sendMsgAsync();if(!result.success){return result}if(((_a=result.data)===null||_a===void 0?void 0:_a.ReturnCode)===2){this.classLogger.Log(this.SendRequestToContent_Async,"Loading Driver in target:",target.toString());let loadSuccess=yield this.LoadInTarget_Async(target);if(!loadSuccess){this.classLogger.Error(this.SendRequestToContent_Async,"Failed to load Driver scripts in target:",target.toString());return{success:false,errorMsg:"Failed to load Driver scripts"}}result=(yield sendMsgAsync());if(!result.success){return result}}if(((_b=result.data)===null||_b===void 0?void 0:_b.ReturnCode)===1){return result}return{success:false,errorMsg:"Failed to execute request"}})}GetVersion(){return this.driverData.version}GetContentCode_ExtensionWorld(){return this.driverData.contentCode_ExtensionWorld}GetContentCode_PageWorld(){return this.driverData.contentCode_PageWorld}GetInjectJsCode(){return this.driverData.injectJsCode}GetBackgroundCode(){return this.driverData.backgroundAdapter}GetCodeFlags(){return this.driverFlags}LoadInAllTabsIfNeeded_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){if(!this.driverFlags.needsToBeLoadedInAllTabsOnActivate){this.classLogger.Log(this.LoadInAllTabsIfNeeded_Async,"Skipped");return}let activateDriverInTab=(tab,onActionCompletedCb)=>{var _a;let target=new ContentTarget_1.ContentTarget((_a=tab.id)!==null&&_a!==void 0?_a:0,0);this.LoadInTarget_Async(target).then(onActionCompletedCb)};return Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.tabsService.ForAllTabs(activateDriverInTab,resolvePromiseCb)})})}DeactivateDriverInAllTabs(){this.classLogger.Log(this.DeactivateDriverInAllTabs,"Started...");let getInputParamsCb=()=>{return{ChannelId:"Extension_RequestToContent",Type:2,DriverCodeVersion:this.GetVersion()}};this.tabsService.SendMessageToAllTabs(getInputParamsCb,()=>{this.classLogger.Log(this.DeactivateDriverInAllTabs,"Finished")})}ExecuteInjectJs_Async(request,target){return tslib_1.__awaiter(this,void 0,void 0,function*(){this.classLogger.Log(this.ExecuteInjectJs_Async);let isEvalRestricted=yield this.evalService.IsEvalRestricted_Async();if(isEvalRestricted){request.requestId=this.GetInjectJsInlineRequestIdFromCode(request.jsCode)}else{request.requestId=ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.EvaluatedInjectJsFunc;let evalInjectJsErrorMsg=yield this.EvalInjectJsCodeInTarget_Async(request.jsCode,target);if(evalInjectJsErrorMsg){request.evalInjectJsErrorMsg=evalInjectJsErrorMsg}}request.hasFixForIsScriptErr=this.driverFlags.has_InjectJs_Fix_For_IsScriptErr;return this.SendInjectJsRequest_Async(request,target)})}SendInjectJsRequest_Async(injectJsData,target){var _a;return tslib_1.__awaiter(this,void 0,void 0,function*(){this.classLogger.Log(this.SendInjectJsRequest_Async);let request={ChannelId:"Extension_RequestToContent",Type:5,DriverCodeVersion:this.GetVersion(),InjectJsData:injectJsData};let result=yield this.SendRequestToContent_Async(request,target);if(!result.success){return undefined}return(_a=result.data)===null||_a===void 0?void 0:_a.ResponseData})}EvalInjectJsCodeInTarget_Async(codeToEval,target){return tslib_1.__awaiter(this,void 0,void 0,function*(){let evalResult=yield this.evalService.EvalInjectJsCode_Async(codeToEval);if(!evalResult.success){this.classLogger.Error(this.EvalInjectJsCodeInTarget_Async,"Failed to eval code");return evalResult.errorMessage}let evalFunc=evalResult.evalFunc;return Tools_1.Tools.ToPromise(resolvePromiseCb=>{this.tabsService.ExecuteScriptInTabFrame(target,evalFunc,success=>{if(!success){this.classLogger.Error(this.EvalInjectJsCodeInTarget_Async,"Failed to load in target:",target.toString());resolvePromiseCb("Cannot load script");return}return resolvePromiseCb(null)})})})}GetInjectJsInlineRequestIdFromCode(jsCode){let methodLogger=new Logger_1.MethodLogger(this.classLogger,this.GetInjectJsInlineRequestIdFromCode);return methodLogger.DoTimed(()=>{if(jsCode==null){return ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.Invalid}let injectJsCode=this.GetInjectJsCode();if(injectJsCode==null){return ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.Invalid}let jsCodeMap=Tools_1.Tools.UnsafeCast(injectJsCode());if(!jsCodeMap){return ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.Invalid}let foundScriptName=null;for(let scriptName in jsCodeMap){let funcCode=jsCodeMap[scriptName].toString();if(StringTools_1.StringTools.AreEqualAsCode(jsCode,funcCode,false)){foundScriptName=scriptName;break}}let requestId=ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.Invalid;Object.keys(ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId).every(key=>{if(key==foundScriptName){requestId=ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId[key];return false}return true});if(requestId==ContentDriverContracts_1.ContentDriver.InjectJsScriptRequestId.Invalid){this.classLogger.Log(this.GetInjectJsInlineRequestIdFromCode,"Could not detect request id from script code: ",jsCode)}return requestId})}}exports.BackgroundDriverPackage=BackgroundDriverPackage}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ActionWithEntrancyGuard=void 0;class ActionWithEntrancyGuard{constructor(action){this.isActionExecuting=false;this.pendingCompletedCallbacks=[];this.action=action}DoAction(onCompleted){if(this.isActionExecuting){this.pendingCompletedCallbacks.push(onCompleted);return}this.isActionExecuting=true;this.action(()=>{this.isActionExecuting=false;let pendingCallbacks=this.pendingCompletedCallbacks;this.pendingCompletedCallbacks=[];onCompleted();for(let pendingCb of pendingCallbacks){pendingCb()}})}}exports.ActionWithEntrancyGuard=ActionWithEntrancyGuard}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.SalesForce_PageWorld_InjectedFunc=void 0;function SalesForce_PageWorld_InjectedFunc(driverVersion){function TraceMessage(...args){try{console.log(...args)}catch(_a){}}function TraceError(...args){try{console.error(...args)}catch(_a){}}class PageWorldServer{constructor(config,requestHandler){this.config=config;this.requestHandler=requestHandler;document.addEventListener(this.config.requestEventName,evt=>{this.OnRequestEvent(evt)})}OnRequestEvent(evt){let request=this.GetRequestEventParam();if(!request){return}evt.stopImmediatePropagation();let response=null;try{response=this.requestHandler(request)}catch(ex){TraceError("[PageWorldServer::OnDocumentEvent] ex: ",String(ex))}this.SendResponseEvent(response)}GetRequestEventParam(){let requestJson=window.document.documentElement.getAttribute(this.config.requestParamAttrName);if(!requestJson){return null}let request=JSON.parse(requestJson);return request}SendResponseEvent(response){this.SetResponseEventParam(response);let respose=new CustomEvent(this.config.responseEventName);document.dispatchEvent(respose);this.ClearResponseEventParam()}SetResponseEventParam(response){let responseJson=JSON.stringify(response);window.document.documentElement.setAttribute(this.config.responseParamAttrName,responseJson)}ClearResponseEventParam(){window.document.documentElement.removeAttribute(this.config.responseParamAttrName)}}class SalesForceService{constructor(version){this.m_version="";this.m_version=version}GetVersion(){return this.m_version}IsSalesForceAuraAvailable(){return this.GetAuraFramework()!=null}GetAuraComponent(globalId){let auraFramework=this.GetAuraFramework();if(!auraFramework){return null}return auraFramework.getComponent(globalId)}GetComponentName(comp){var _a;return(_a=comp.getName())!==null&&_a!==void 0?_a:""}GetComponentType(comp){var _a;return(_a=comp.getType())!==null&&_a!==void 0?_a:""}GetComponentPathFromGlobalId(targetComp){var localIdSeparator=":";var pathSeparator="/";var escapeCharacter="\\";function IsNonEmptyString(obj){return typeof obj==="string"&&obj!==""}function SanitizeAuraAttributeValue(attrValue){var regExp=new RegExp("(["+localIdSeparator+pathSeparator+"])","g");return attrValue.replace(regExp,escapeCharacter+"$1")}function GetPathItemFromAuraComponent(auraComp){var compName=auraComp.getName();var compLocalId=auraComp.getLocalId();var out_pathItem=(IsNonEmptyString(compName)?SanitizeAuraAttributeValue(compName):"");if(IsNonEmptyString(compLocalId)){out_pathItem+=localIdSeparator+SanitizeAuraAttributeValue(compLocalId)}return out_pathItem}var reversePathItems=[];var crtAncestorComp=targetComp;var maxPathItemCount=100;var visitedComponents={};while(true){reversePathItems.push(GetPathItemFromAuraComponent(crtAncestorComp));visitedComponents[crtAncestorComp.getGlobalId()]=true;var nextAncestorComp=crtAncestorComp.getOwner();if(nextAncestorComp==null||visitedComponents[nextAncestorComp.getGlobalId()]==true){break}if(reversePathItems.length>=maxPathItemCount){reversePathItems.push("*");break}crtAncestorComp=nextAncestorComp}var out_path=reversePathItems[reversePathItems.length-1];for(var i=reversePathItems.length-2;i>=0;--i){out_path+=pathSeparator+reversePathItems[i]}return out_path}GetAuraFramework(){return(typeof $A!='undefined')?$A:null}}class SalesForcePageWorldServer{constructor(driverVersion){this.salesForce=new SalesForceService(driverVersion);let config={requestEventName:"__UiPath_SalesForce_Request_"+driverVersion,responseEventName:"__UiPath_SalesForce_Response_"+driverVersion,requestParamAttrName:"data-UiPath_SalesForce_Request_Attr_"+driverVersion,responseParamAttrName:"data-UiPath_SalesForce_Response_Attr_"+driverVersion};this.pageWorldServer=new PageWorldServer(config,request=>{let responseData=this.ProcessRequest(request.requestId,request.data);return{result:responseData}})}ProcessRequest(requestId,requestData){switch(requestId){case 1:return true;case 2:return this.salesForce.IsSalesForceAuraAvailable();case 3:return this.DoWithAuraComponent(requestData,auraComp=>{return this.salesForce.GetComponentName(auraComp)});case 4:return this.DoWithAuraComponent(requestData,auraComp=>{return this.salesForce.GetComponentType(auraComp)});case 5:return this.DoWithAuraComponent(requestData,auraComp=>{return this.salesForce.GetComponentPathFromGlobalId(auraComp)});default:let unhandledRequest=requestId;TraceError("[UiPathSalesForcePageWorldServer::ProcessRequest] unhandledRequest: "+unhandledRequest);return null}}DoWithAuraComponent(requestData,actionCb){let comp=this.salesForce.GetAuraComponent(requestData.globalId);if(!comp){return null}return actionCb(comp)}}TraceMessage("[SalesForce_PageWorld] driverVersion:",driverVersion);let uiPathSalesForceKey="__uiPathSalesForce";let uiPathSalesForceGlobal=window[uiPathSalesForceKey];if(!uiPathSalesForceGlobal){uiPathSalesForceGlobal={};window[uiPathSalesForceKey]=uiPathSalesForceGlobal}if(uiPathSalesForceGlobal[driverVersion]){TraceError("[SalesForce_PageWorld] Skipped. Already defined driverVersion:",driverVersion)}else{uiPathSalesForceGlobal[driverVersion]=new SalesForcePageWorldServer(driverVersion)}}exports.SalesForce_PageWorld_InjectedFunc=SalesForce_PageWorld_InjectedFunc}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.SapFiori_PageWorld_InjectedFunc=void 0;function SapFiori_PageWorld_InjectedFunc(driverVersion){function TraceMessage(...args){try{console.log(...args)}catch(_a){}}function TraceError(...args){try{console.error(...args)}catch(_a){}}class Tools{static IsType(value,typeToCheck){return typeof value===typeToCheck}static IsFunction(value){return Tools.IsType(value,"function")}}class PageWorldServer{constructor(config,requestHandler){this.config=config;this.requestHandler=requestHandler;document.addEventListener(this.config.requestEventName,evt=>{this.OnRequestEvent(evt)})}OnRequestEvent(evt){let request=this.GetRequestEventParam();if(!request){return}evt.stopImmediatePropagation();let response=null;try{response=this.requestHandler(request)}catch(ex){TraceError("[PageWorldServer::OnDocumentEvent] ex: ",String(ex))}this.SendResponseEvent(response)}GetRequestEventParam(){let requestJson=window.document.documentElement.getAttribute(this.config.requestParamAttrName);if(!requestJson){return null}let request=JSON.parse(requestJson);return request}SendResponseEvent(response){this.SetResponseEventParam(response);let respose=new CustomEvent(this.config.responseEventName);document.dispatchEvent(respose);this.ClearResponseEventParam()}SetResponseEventParam(response){let responseJson=JSON.stringify(response);window.document.documentElement.setAttribute(this.config.responseParamAttrName,responseJson)}ClearResponseEventParam(){window.document.documentElement.removeAttribute(this.config.responseParamAttrName)}}class SapFioriUtilities{constructor(version){this.m_version="";this.m_propertyBasedAttrPrefix="ui5p-";this.sUIDPrefix=null;this.rGeneratedUID=null;this.m_customDataPrefix="data-";this.m_version=version}GetVersion(){return this.m_version}IsSapUiAvailable(){if((typeof sap!='undefined')&&(typeof sap.ui!='undefined')){return true}else{return false}}GetHtmlElementFromId(params){let elem=null;if(params.htmlId!==""){elem=document.getElementById(params.htmlId)}return elem}GetSapElementFromHtmlId(htmlId){let core=sap.ui.getCore();let sapElement=core.byId(htmlId);if(!sapElement){return null}return sapElement}GetElementFromCustomId(params){let elem=null;let cssSelector=params.elementTag+"["+params.customIdAttributeName+"=\""+params.customId+"\"]";elem=document.querySelector(cssSelector);if(elem==null){cssSelector=params.elementTag+"["+this.m_customDataPrefix+params.customIdAttributeName+"=\""+params.customId+"\"]";elem=document.querySelector(cssSelector)}return elem}GetSapElementFromHtmlElement(element){return $(element).control(0)}GetSapElementFromHtmlElementCustomId(params){let element=this.GetElementFromCustomId(params);return this.GetSapElementFromHtmlElement(element)}IsSapFioriElement(element){if(element==null||element.id==null){return false}let core=sap.ui.getCore();let sapElement=core.byId(element.id);if(sapElement!=null){return true}return false}IsSapFioriElementFromId(params){let element=this.GetHtmlElementFromId(params);return this.IsSapFioriElement(element)}GetSapVirtualId(element){let virtualIdNone="";if(element==null){return virtualIdNone}let sapElement=sap.ui.getCore().byId(element.id);if(sapElement==null){return virtualIdNone}let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetVirtualId()}GetSapVirtualIdFromId(params){let element=this.GetHtmlElementFromId(params);return this.GetSapVirtualId(element)}BringIntoViewSapVirtualId(element,virtualId){if(element==null){return null}let sapElement=sap.ui.getCore().byId(element.id);if(sapElement==null){return null}let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.BringIntoViewVirtualId(virtualId)}BringIntoViewSapVirtualIdFromId(params){let element=this.GetHtmlElementFromId(params);return this.BringIntoViewSapVirtualId(element,params.virtualId)}GetSapId(sapElement){return sapElement.getId()}GetSapClass(sapElement){if(typeof sapElement.getMetadata=='function'){let elementMetaData=sapElement.getMetadata();if(elementMetaData!=null){return elementMetaData.getElementName()}}return""}GetSapRole(sapElement){let elementUnsafe=sapElement;if(typeof elementUnsafe.getAccessibilityInfo=='function'){let accessibilityInfo=elementUnsafe.getAccessibilityInfo();if(accessibilityInfo!=null){return accessibilityInfo.role}}return""}GetSapType(sapElement){let elementUnsafe=sapElement;if(typeof elementUnsafe.getAccessibilityInfo=='function'){let accessibilityInfo=elementUnsafe.getAccessibilityInfo();if(accessibilityInfo!=null){return accessibilityInfo.type}}return""}GetSapLabel(sapElement){let elementUnsafe=sapElement;if(typeof elementUnsafe.getLabels=='function'){let labels=elementUnsafe.getLabels();if(labels.length>0){return labels[0].getText()}}let jQuerySelector="label[for*="+sapElement.getId()+"]";let labels=jQuery(jQuerySelector);for(let i=0;i<labels.length;i++){let sapLabel=this.GetSapElementFromHtmlElement(labels[i]);if(sapLabel!=null&&typeof sapLabel.getLabelFor=='function'){if(sapLabel.getLabelFor()==sapElement.getId()){return sapLabel.getText()}}else if(labels[i].getAttribute('for')==sapElement.getId()){return jQuery(labels[i]).text()}}return""}GetSapTooltip(sapElement){if(typeof sapElement.getTooltip_Text=='function'){let tooltip=sapElement.getTooltip_Text();if(tooltip!="((AltText))"){return tooltip}}if(typeof sapElement.getTooltip_AsString=='function'){let tooltip=sapElement.getTooltip_AsString();if(tooltip!="((AltText))"){return tooltip}}return""}GetSapIsEmpty(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.IsElementEmpty()}GetSapTableRowIndex(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetTableRowIndex().toString()}GetSapTableColIndex(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetTableColIndex().toString()}GetSapColLabel(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetColLabel()}GetSapAllColLabels(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetAllColLabels()}GetSapReadyState(element){let sapElement=element;let isReady=true;for(let i=0;i<10000;i++){if(!sapElement){break}if((typeof sapElement.getBusy=='function')&&sapElement.getBusy()){isReady=false;break}sapElement=sapElement.getParent()}return isReady?"1":"0"}GetSapDynamicAttributesList(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetDynamicAttributesList()}GetSapPropertyBasedAttribute(sapElement,attrName){let elementMetaData=sapElement.getMetadata();let properties=elementMetaData.getProperties();if(typeof sapElement.getProperty=='function'){let propertyName=attrName.slice(this.m_propertyBasedAttrPrefix.length);if(!elementMetaData.hasProperty(propertyName)){for(let key in properties){let crtPropertyName=properties[key]["name"];if((crtPropertyName===null||crtPropertyName===void 0?void 0:crtPropertyName.toLowerCase())==propertyName){propertyName=crtPropertyName;break}}}return sapElement.getProperty(propertyName)}return""}IsStableSapId(request){if(typeof sap.ui.base.ManagedObjectMetadata.isGeneratedId=='function'){return!sap.ui.base.ManagedObjectMetadata.isGeneratedId(request.htmlId)}let escapeRegExp=function(sString){let rEscapeRegExp=/[[\]{}()*+?.\\^$|]/g;return sString.replace(rEscapeRegExp,"\\$&")};this.sUIDPrefix=this.sUIDPrefix||sap.ui.getCore().getConfiguration().getUIDPrefix();this.rGeneratedUID=this.rGeneratedUID||new RegExp("(^|-{1,3})"+escapeRegExp(this.sUIDPrefix));return!this.rGeneratedUID.test(request.htmlId)}GetSapPropertyBasedSelectorAttributeNames(sapElement){let reliableSelectorAttribute={"sap.m.Breadcrumbs":["currentLocationText","separatorStyle"],"sap.suite.ui.microchart.DeltaMicroChart":["title1","title2"],"sap.m.CustomListItem":["highlightText"],"sap.m.FeedContent":["contentText"],"sap.m.FeedInput":["buttonTooltip"],"sap.m.FeedListItem":["sender"],"sap.m.GenericTile":["header","imageDescription"],"sap.m.GroupHeaderListItem":["count"],"sap.m.image":["alt"],"sap.m.ListBase":["headerText","footerText","mode"],"sap.m.NewsContent":["contentText"],"sap.m.NotificationListBase":["authorName","authorPicture"],"sap.m.ObjectHeader":["intro","number","numberUnit"],"sap.m.ObjectNumber":["number","numberUnit","unit"],"sap.m.Panel":["headerText","accessibleRole"],"sap.m.QuickViewGroup":["heading"],"sap.m.RadioButton":["groupName"],"sap.m.Tree":["headerText"],"sap.m.UploadCollectionItem":["documentId","url"]};let IsElementOfType=function(elementMetaData,elementType){while(elementMetaData!=null){let crtElementType=elementMetaData.getName();if(crtElementType==elementType){return true}elementMetaData=elementMetaData.getParent()}return false};let elementMetaData=sapElement.getMetadata();let attrNames=[];for(let elementType in reliableSelectorAttribute){if(IsElementOfType(elementMetaData,elementType)){let crtAttrNames=reliableSelectorAttribute[elementType];for(let i=0;i<crtAttrNames.length;++i){if(attrNames.indexOf(crtAttrNames[i])==-1){attrNames.push(crtAttrNames[i])}}}}let defaultReliableAttributes=["text","title","name","tooltip","label","placeholder","type","description","info","src","role","htmlText","icon","value","displayValue"];elementMetaData=sapElement.getMetadata();for(let i=0;i<defaultReliableAttributes.length;++i){if(elementMetaData.hasProperty(defaultReliableAttributes[i])&&(attrNames.indexOf(defaultReliableAttributes[i])==-1)){attrNames.push(defaultReliableAttributes[i])}}for(let i=0;i<attrNames.length;++i){attrNames[i]=this.m_propertyBasedAttrPrefix+attrNames[i]}return attrNames}GetSapPropertyBasedSelectorAttributeNamesFromId(params){let element=this.GetSapElementFromHtmlId(params.htmlId);if(!element){return[]}return this.GetSapPropertyBasedSelectorAttributeNames(element)}GetSapSelectorFixedAttributes(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetSelectorFixedAttributes()}GetNextInterestingParent(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetNextInterestingParent()}SapElementToResult(sapElement,customIdAttributeName){if(sapElement==null){return{}}let element=sapElement.getDomRef();if(element==null){return{}}if(customIdAttributeName&&element.hasAttribute(customIdAttributeName)){return{customId:element.getAttribute(customIdAttributeName)}}else if(element.hasAttribute("id")){return{htmlId:element.getAttribute("id")}}return{}}AddHtmlDomAttribute(sapElement,params){sapElement.data(params.attrName,params.attrValue,true);return true}IsElementCheckable(sapElement){if(sap.m&&sap.m.CheckBox&&sapElement instanceof sap.m.CheckBox){return true}else if(sap.m&&sap.m.RadioButton&&sapElement instanceof sap.m.RadioButton){return true}else if(sap.m&&sap.m.Switch&&sapElement instanceof sap.m.Switch){return true}else if((typeof sapElement["setSelected"]=='function')&&(typeof sapElement["getSelected"]=='function')){return true}return false}IsElementSelectable(sapElement){if(sap.m&&sap.m.ComboBox&&sapElement instanceof sap.m.ComboBox){return true}else if(sap.m&&sap.m.MultiComboBox&&sapElement instanceof sap.m.MultiComboBox){return true}else if(sap.m&&sap.m.Select&&sapElement instanceof sap.m.Select){return true}else if(sap.m&&sap.m.ListBase&&sapElement instanceof sap.m.ListBase){return true}else if((typeof sapElement["getItems"]=='function')&&(typeof sapElement["getSelectedItem"]=='function')&&(typeof sapElement["setSelectedItem"]=='function')){return true}return false}WriteText(sapElement,params){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.WriteText(params.text,params.append)}Click(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.Click()}GetSelectedItems(sapElement,params){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetSelectedItems(params.getAll)}SelectItems(sapElement,params){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.SelectItems(params.reset,params.selectIfDisabled,params.items)}GetChecked(sapElement){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.GetChecked()}Check(sapElement,params){let automationControl=this.GetAutomationControlForElement(sapElement);return automationControl.Check(params.doCheck)}SetFocus(sapElement){if(typeof sapElement.focus!=="function"){return false}sapElement.focus();return true}HasSapContentWalker(sapElement){let contentWalker=this.CreateSapContentWalkerForElement(sapElement);return(contentWalker!=null)}SapContentWalkerInitialize(sapElement,params){let contentWalker=this.CreateSapContentWalkerForElement(sapElement);if(contentWalker==null){return null}return contentWalker.Initialize(params.hints,params.repeatRequest)}SapContentWalkerFetchNext(sapElement){let contentWalker=this.CreateSapContentWalkerForElement(sapElement);if(contentWalker==null){return null}return contentWalker.FetchNext()}TraverseSapDescendants(element,visitDescendant){let htmlList=element.getDomRef().querySelectorAll("[data-sap-ui],[data-sap-ui-preserve]");for(let i=0;i<htmlList.length;i++){let sapDescendant=this.GetSapElementFromHtmlElement(htmlList[i]);if(!sapDescendant){continue}if(sapDescendant.getDomRef()!=htmlList[i]){continue}let visitResult=visitDescendant(sapDescendant);if(!visitResult){return visitResult}}return true}GetSapDescendantIndex(parent,element){if(parent==element){return 0}let index=1;let elementFound=false;this.TraverseSapDescendants(parent,function(currentDescendant){if(currentDescendant==element){elementFound=true;return false}index++;return true});return elementFound?index:-1}StringEscapeSlashes(text){return text.replace(/\//g,"\\/")}StringJoinWithSlash(text,newString){return text+"/"+this.StringEscapeSlashes(newString)}CreateSapContentWalkerForElement(element){let s_sapContentWalkerList=[SapContentWalker_SapUiTable,SapContentWalker_SapMTable,];for(let i=0;i<s_sapContentWalkerList.length;i++){let contentWalker=s_sapContentWalkerList[i].CreateForElement(element);if(contentWalker!=null){return contentWalker}}return null}GetAutomationControlForElement(element){if(sap.m&&sap.m.ComboBox&&element instanceof sap.m.ComboBox){return new SapMComboBox(element)}else if(sap.m&&sap.m.MultiComboBox&&element instanceof sap.m.MultiComboBox){return new SapMMultiComboBox(element)}else if(sap.m&&sap.m.Tree&&element instanceof sap.m.Tree){return new SapMTree(element)}else if(sap.m&&sap.m.ListBase&&element instanceof sap.m.ListBase){if(sap.m.Table&&element instanceof sap.m.Table){return new SapMTable(element)}return new SapMListBase(element)}else if(sap.m&&sap.m.Switch&&element instanceof sap.m.Switch){return new SapMSwitch(element)}else if(sap.m&&sap.m.RadioButton&&element instanceof sap.m.RadioButton){return new SapMRadioButton(element)}else if(sap.m&&sap.m.ObjectAttribute&&element instanceof sap.m.ObjectAttribute){return new SapMObjectAttribute(element)}else if(sap.ui&&sap.ui.table&&sap.ui.table.Table&&element instanceof sap.ui.table.Table){if(sap.ui.table.TreeTable&&element instanceof sap.ui.table.TreeTable){return new AutomationControlBase(element)}return new SapUiTable(element)}else if(sap.ui&&sap.ui.table&&sap.ui.table.Row&&element instanceof sap.ui.table.Row){let table=element.getParent();if(!(table instanceof sap.ui.table.Table)||(sap.ui.table.TreeTable&&table instanceof sap.ui.table.TreeTable)||(element.getIndex()<0)){return new AutomationControlBase(element)}let tableControl=new SapUiTable(table);return new SapUiTableRow(tableControl,element,element.getIndex())}else if(sap.m&&sap.m.ColumnListItem&&element instanceof sap.m.ColumnListItem){let table=element.getParent();if(sap.m.Table&&(table instanceof sap.m.Table)&&(table.indexOfItem(element)>=0)){let tableControl=new SapMTable(table);return new SapMTableRow(tableControl,element,table.indexOfItem(element))}return new AutomationControlBase(element)}else{return new AutomationControlBase(element)}}GetTableCellProxyForElement(element){let s_tableCellProxyTypeList=[TableCellProxy_SapUiTable,TableCellProxy_SapMTable,];if(!(element instanceof sap.ui.core.Control)){return null}for(let i=0;i<s_tableCellProxyTypeList.length;i++){let cellProxy=s_tableCellProxyTypeList[i].CreateForElement(element);if(cellProxy!=null){return cellProxy}}return null}}class AutomationControlBase{constructor(element){this.m_tableCellProxy=null;this.m_tableCellProxyComputed=false;this.m_element=element}GetTableCellProxy(){if(!this.m_tableCellProxyComputed){this.m_tableCellProxyComputed=true;this.m_tableCellProxy=g_utilities.GetTableCellProxyForElement(this.m_element)}return this.m_tableCellProxy}GetVirtualId(){let tableCellProxy=this.GetTableCellProxy();if(tableCellProxy!=null){return tableCellProxy.GetVirtualId()}return""}BringIntoViewVirtualId(virtualId){let tableCellProxy=this.GetTableCellProxy();if(tableCellProxy!=null){return tableCellProxy.BringIntoViewVirtualId(virtualId)}if(!virtualId){return true}return false}FireWriteTextEvents(text){let elementUnsafe=this.m_element;if(typeof elementUnsafe.fireLiveChange=='function'){try{elementUnsafe.fireLiveChange({value:text,newValue:text})}catch(e){}}if(typeof elementUnsafe.fireChange=='function'){try{elementUnsafe.fireChange({value:text,valid:true})}catch(e){}}if(typeof elementUnsafe.fireSubmit=='function'){try{elementUnsafe.fireSubmit({value:text})}catch(e){}}if(typeof elementUnsafe.fireSearch=='function'){try{elementUnsafe.fireSearch({query:text})}catch(e){}}}WriteText(text,append){let elementUnsafe=this.m_element;if(typeof elementUnsafe.setValue!=='function'){return false}if(append){text=elementUnsafe.getValue()+text}elementUnsafe.setValue("");elementUnsafe.setValue(text);this.FireWriteTextEvents(text);return true}Click(){return true}GetTextFromItem(item){if(item==null){return null}let text=null;if(typeof item.getText=='function'){text=item.getText()}else if(typeof item.getTitle=='function'){text=item.getTitle()}return text}GetSelectedItems(getAll){let elementUnsafe=this.m_element;if((typeof elementUnsafe.getItems!=='function')||(typeof elementUnsafe.getSelectedItem!=='function')){return[]}let items=[];if(getAll){let selectableItems=elementUnsafe.getItems();for(let i=0;i<selectableItems.length;i++){let text=this.GetTextFromItem(selectableItems[i]);if(text!=null){items.push(text)}}}else{let selectedItem=elementUnsafe.getSelectedItem();let text=this.GetTextFromItem(selectedItem);if(text!=null){items.push(text)}}return items}FireSelectionEvents(itemToSelect){let elementUnsafe=this.m_element;if(typeof elementUnsafe.fireChange=='function'){try{elementUnsafe.fireChange({selectedItem:itemToSelect,value:this.GetTextFromItem(itemToSelect),itemPressed:itemToSelect})}catch(e){}}if(typeof elementUnsafe.fireSelectionChange=='function'){try{elementUnsafe.fireSelectionChange({selectedItem:itemToSelect})}catch(e){}}if(typeof elementUnsafe.fireItemPress=='function'){try{elementUnsafe.fireItemPress({item:itemToSelect})}catch(e){}}}SelectItems(_reset,selectIfDisabled,items){let elementUnsafe=this.m_element;if((typeof elementUnsafe.getItems!=='function')||(typeof elementUnsafe.setSelectedItem!=='function')){return 2}let selectableItems=elementUnsafe.getItems();let itemToSelect=null;for(let i=0;i<selectableItems.length;i++){let text=this.GetTextFromItem(selectableItems[i]);if(text==items[0]){if(!selectIfDisabled&&!selectableItems[i].getEnabled()){return 4}itemToSelect=selectableItems[i];break}}if(itemToSelect==null){return 3}elementUnsafe.setSelectedItem(itemToSelect);this.FireSelectionEvents(itemToSelect);return 1}FireCheckEvents(doCheck){let elementUnsafe=this.m_element;if(typeof elementUnsafe.fireSelect=='function'){try{elementUnsafe.fireSelect({selected:doCheck})}catch(e){}}}Check(doCheck){let elementUnsafe=this.m_element;if(typeof elementUnsafe.setSelected!=='function'){return false}elementUnsafe.setSelected(doCheck);this.FireCheckEvents(doCheck);return true}GetChecked(){let elementUnsafe=this.m_element;if(typeof elementUnsafe.getSelected!=='function'){return false}return elementUnsafe.getSelected()}IsElementEmpty(){let tableCellProxy=this.GetTableCellProxy();if(tableCellProxy!=null){return tableCellProxy.IsElementEmpty()}return""}GetTableRowIndex(){let tableCellProxy=this.GetTableCellProxy();if(tableCellProxy!=null){return tableCellProxy.GetRowIndex()}return 0}GetTableColIndex(){let tableCellProxy=this.GetTableCellProxy();if(tableCellProxy!=null){return tableCellProxy.GetColIndex().toString()}return""}GetColLabel(){let tableCellProxy=this.GetTableCellProxy();if(tableCellProxy!=null){return tableCellProxy.GetColLabel()}return""}GetAllColLabels(){return[]}GetDynamicAttributesList(){var _a;if(typeof this.m_element.getMetadata!='function'){return[]}let sapDynamicAttributes=[];if(this.GetTableCellProxy()!=null){sapDynamicAttributes.push("ui5-tableCol");sapDynamicAttributes.push("ui5-tableRow");sapDynamicAttributes.push("ui5-isEmpty");sapDynamicAttributes.push("ui5-colLabel")}let elementMetaData=this.m_element.getMetadata();while(elementMetaData!=null){let crtElementName=elementMetaData.getElementName();if((crtElementName==="sap.ui.core.Control")||(crtElementName==="sap.ui.core.Element")||(crtElementName==="sap.ui.base.ManagedObject")){break}let properties=elementMetaData.getProperties();for(let key in properties){let propertyName=(_a=properties[key]["name"])!==null&&_a!==void 0?_a:"";let sapAttributename=g_utilities.m_propertyBasedAttrPrefix+propertyName;sapDynamicAttributes.push(sapAttributename)}let parentData=elementMetaData.getParent();if(!(parentData instanceof sap.ui.core.ElementMetadata)){break}elementMetaData=parentData}return sapDynamicAttributes}GetSelectorFixedAttributes(){let fixedAttributes={};let tableCellProxy=this.GetTableCellProxy();if(tableCellProxy!=null){fixedAttributes["ui5-tableRow"]=tableCellProxy.GetRowIndex().toString();let colLabel=tableCellProxy.GetColLabel();if(colLabel){fixedAttributes["ui5-colLabel"]=colLabel}else{fixedAttributes["ui5-tableCol"]=tableCellProxy.GetColIndex().toString()}}return fixedAttributes}GetNextInterestingParent(){let tableCellProxy=this.GetTableCellProxy();if(tableCellProxy!=null){return tableCellProxy.GetTable()}if(sap.m&&sap.m.ListItemBase&&(this.m_element instanceof sap.m.ListItemBase)){return this.m_element.getParent()}else if(sap.ui.core&&sap.ui.core.Item&&(this.m_element instanceof sap.ui.core.Item)){return this.m_element.getParent()}else if(sap.ui.commons&&sap.ui.commons.TreeNode&&(this.m_element instanceof sap.ui.commons.TreeNode)){let elementUnsafe=this.m_element;return elementUnsafe.getTree()}return null}}class SapMObjectAttribute extends AutomationControlBase{Click(){this.FireClickEvents();return true}FireClickEvents(){if(typeof this.m_element.firePress=='function'){try{this.m_element.firePress()}catch(e){}}}}class SapMComboBox extends AutomationControlBase{WriteText(text,append){let selectResult=this.SelectItems(true,false,[text]);if(selectResult!=1){return super.WriteText(text,append)}return true}}class SapMMultiComboBox extends AutomationControlBase{WriteText(text,append){let reset=!append;let selectResult=this.SelectItems(reset,false,[text]);if(selectResult!=1){return super.WriteText(text,append)}return true}FireSelectionEventsMultipleItems(itemsToSelect){if(typeof this.m_element.fireSelectionChange=='function'){for(let i=0;i<itemsToSelect.length;i++){try{this.m_element.fireSelectionChange({changedItem:itemsToSelect[i],selected:true})}catch(e){}}}if(typeof this.m_element.fireSelectionFinish=='function'){try{this.m_element.fireSelectionFinish({selectedItems:itemsToSelect})}catch(e){}}}SelectItems(reset,selectIfDisabled,items){let selectableItems=this.m_element.getItems();let itemsToSelect=[];for(let i=0;i<selectableItems.length;i++){for(let j=0;j<items.length;j++){if(selectableItems[i].getText()==items[j]){if(!selectIfDisabled&&!selectableItems[i].getEnabled()){return 4}itemsToSelect.push(selectableItems[i]);break}}}if(itemsToSelect.length!=items.length){return 3}if(reset){this.m_element.clearSelection()}for(let i=0;i<itemsToSelect.length;i++){this.m_element.addSelectedItem(itemsToSelect[i])}this.FireSelectionEventsMultipleItems(itemsToSelect);return 1}GetSelectedItems(getAll){let items=[];if(getAll){let selectableItems=this.m_element.getItems();for(let i=0;i<selectableItems.length;i++){items.push(selectableItems[i].getText())}}else{let selectedItems=this.m_element.getSelectedItems();for(let i=0;i<selectedItems.length;i++){items.push(selectedItems[i].getText())}}return items}}class SapMListBase extends AutomationControlBase{FireSelectionEvents_MultipleItems(itemsToSelect){if(typeof this.m_element.fireSelect=='function'){try{this.m_element.fireSelect({listItem:itemsToSelect[0]})}catch(e){}}if(typeof this.m_element.fireSelectionChange=='function'){try{this.m_element.fireSelectionChange({listItem:itemsToSelect[0],listItems:itemsToSelect,selected:true})}catch(e){}}if(typeof this.m_element.fireItemPress=='function'){try{this.m_element.fireItemPress({listItem:itemsToSelect[0]})}catch(e){}}}SelectItems(reset,_selectIfDisabled,items){let selectableItems=this.m_element.getItems();let itemsToSelect=[];for(let i=0;i<selectableItems.length;i++){for(let j=0;j<items.length;j++){if(this.GetListItemTitle(selectableItems[i])==items[j]){itemsToSelect.push(selectableItems[i]);break}}}if(itemsToSelect.length!=items.length){return 3}if(reset){this.m_element.removeSelections(true)}for(let i=0;i<itemsToSelect.length;i++){this.m_element.setSelectedItem(itemsToSelect[i])}this.FireSelectionEvents_MultipleItems(itemsToSelect);return 1}GetSelectedItems(getAll){if(getAll){let selectableItems=this.m_element.getItems();return this.GetListItemTitles(selectableItems)}else{let selectedItems=this.m_element.getSelectedItems();return this.GetListItemTitles(selectedItems)}}GetListItemTitles(items){let titles=[];for(let item of items){titles.push(this.GetListItemTitle(item))}return titles}GetListItemTitle(item){let itemAsAny=item;if(Tools.IsFunction(itemAsAny.getTitle)){return itemAsAny.getTitle()}return""}}class SapMTree extends SapMListBase{}class SapMSwitch extends AutomationControlBase{FireCheckEvents(doCheck){if(typeof this.m_element.fireChange=='function'){try{this.m_element.fireChange({state:doCheck})}catch(e){}}}Check(doCheck){this.m_element.setState(doCheck);this.FireCheckEvents(doCheck);return true}GetChecked(){return this.m_element.getState()}}class SapMRadioButton extends AutomationControlBase{Check(doCheck){if(!doCheck){return true}return super.Check(doCheck)}}class SapTableAutomationBase extends AutomationControlBase{GetTable(){return this.m_element}GetColLabelFromIndex(_colIndex){return""}GetTableCellProxy(){return null}GetColCount(){let tableColumns=this.GetTable().getColumns();if(tableColumns){return tableColumns.length}return 0}GetAllColLabels(){let allColLabels=[];let colCount=this.GetColCount();for(let i=0;i<colCount;i++){allColLabels.push(this.GetColLabelFromIndex(i))}return allColLabels}}class SapUiTable extends SapTableAutomationBase{GetColLabelFromIndex(colIndex){let tableColumns=this.GetTable().getColumns();if(!tableColumns){return""}let uiColumn=tableColumns[colIndex];if(!(uiColumn instanceof sap.ui.table.Column)){return""}const getTextProperty="getText";let singleLabel=uiColumn.getLabel();if(singleLabel){if(typeof singleLabel[getTextProperty]!=="function"){return""}return g_utilities.StringEscapeSlashes(singleLabel[getTextProperty]())}let multiLabels=uiColumn.getMultiLabels();if(multiLabels){let colLabel="";for(let i=0;i<multiLabels.length;i++){if(typeof multiLabels[i][getTextProperty]!=="function"){return""}colLabel=g_utilities.StringJoinWithSlash(colLabel,multiLabels[i][getTextProperty]())}return colLabel}return""}}class SapMTable extends SapTableAutomationBase{GetColLabelFromIndex(colIndex){let tableColumns=this.GetTable().getColumns();if(!tableColumns){return""}let mColumn=tableColumns[colIndex];if(!(mColumn instanceof sap.m.Column)){return""}const getTextProperty="getText";let colHeader=mColumn.getHeader();if(colHeader){if(typeof colHeader[getTextProperty]!=="function"){return""}return g_utilities.StringEscapeSlashes(colHeader[getTextProperty]())}return""}}class SapTableRowAutomationBase extends AutomationControlBase{constructor(tableControl,row,rowIndex){super(row);this.m_tableControl=tableControl;this.m_rowIndex=rowIndex}GetTableControl(){return this.m_tableControl}GetTable(){return this.GetTableControl().GetTable()}GetTableRow(){return this.m_element}GetTableRowIndex(){return this.m_rowIndex}GetTableColIndex(){return""}GetTableCellProxy(){return null}GetVirtualId(){return""}BringIntoViewVirtualId(_virtualId){return false}GetDynamicAttributesList(){let dynamicAttributes=super.GetDynamicAttributesList.call(this);dynamicAttributes.push("ui5-tableRow");return dynamicAttributes}GetSelectorFixedAttributes(){return{"ui5-tableRow":this.GetTableRowIndex().toString()}}GetNextInterestingParent(){return this.GetTable()}}class SapUiTableRow extends SapTableRowAutomationBase{constructor(tableControl,row,rowIndex){super(tableControl,row,rowIndex)}GetVirtualId(){return this.ComposeVirtualId(this.GetTableRowIndex(),this.GetTable().getId())}BringIntoViewVirtualId(virtualId){let parsedVirtualId=this.ParseVirtualId(virtualId);if(!parsedVirtualId){return false}let targetOffset=parsedVirtualId.rowIndex-this.GetTableRowIndex();if(targetOffset!=0){let table=this.GetTableControl().GetTable();let targetFirstVisibleRow=table.getFirstVisibleRow()+targetOffset;table.setFirstVisibleRow(targetFirstVisibleRow)}return true}ComposeVirtualId(rowIndex,tableId){return rowIndex+","+tableId}ParseVirtualId(virtualId){if(!virtualId){return null}let tokens=virtualId.split(",");if(tokens.length<2){return null}let result={rowIndex:parseInt(tokens[0]),tableId:tokens.slice(1).join(",")};if(isNaN(result.rowIndex)){return null}return result}}class SapMTableRow extends SapTableRowAutomationBase{constructor(tableControl,row,rowIndex){super(tableControl,row,rowIndex)}}class TableCellProxyBase{constructor(rowControl,colIndex,element){this.m_rowControl=rowControl;this.m_colIndex=colIndex;this.m_element=element}GetTableControl(){return this.m_rowControl.GetTableControl()}GetTable(){return this.m_rowControl.GetTable()}GetRowControl(){return this.m_rowControl}GetRowIndex(){return this.GetRowControl().GetTableRowIndex()}GetColIndex(){return this.m_colIndex}GetElement(){return this.m_element}GetVirtualId(){return""}BringIntoViewVirtualId(_virtualId){return false}GetColLabel(){return this.GetTableControl().GetColLabelFromIndex(this.GetColIndex())}static IsCurrentElementContentEmpty(element){if((sap.m&&sap.m.ObjectNumber&&element instanceof sap.m.ObjectNumber)||(sap.m&&sap.m.GenericTag&&element instanceof sap.m.GenericTag)||(sap.m&&sap.m.Switch&&element instanceof sap.m.Switch)||(sap.m&&sap.m.RadioButton&&element instanceof sap.m.RadioButton)||(sap.m&&sap.m.CheckBox&&element instanceof sap.m.CheckBox)||(sap.ui&&sap.ui.unified&&sap.ui.unified.Currency&&element instanceof sap.ui.unified.Currency)){return"0"}if(sap.ui&&sap.ui.core&&sap.ui.core.InvisibleText&&element instanceof sap.ui.core.InvisibleText){return"1"}if(sap.m&&sap.m.InputBase&&element instanceof sap.m.InputBase){return!element.getValue()?"1":"0"}if(sap.m&&sap.m.Select&&element instanceof sap.m.Select){let selectedItem=element.getSelectedItem();if(!selectedItem){return"1"}return!selectedItem.getText()?"1":"0"}if((sap.m&&sap.m.Button&&element instanceof sap.m.Button)||(sap.tnt&&sap.tnt.InfoLabel&&element instanceof sap.tnt.InfoLabel)){return!element.getText()&&!element.getIcon()?"1":"0"}let sapObj=sap;if(sapObj.suite&&sapObj.suite.ui&&sapObj.suite.ui.commons&&sapObj.suite.ui.commons.MicroProcessFlow&&element instanceof sapObj.suite.ui.commons.MicroProcessFlow){return!element.getContent().length?"1":"0"}let isContentEmpty="";let contentGetterList=["getText","getValue","getTitle","getDescription"];for(let i=0;i<contentGetterList.length&&isContentEmpty!=="0";i++){if(typeof element[contentGetterList[i]]==="function"){isContentEmpty=!(element[contentGetterList[i]]())?"1":"0"}}return isContentEmpty}IsElementEmpty(){let isEmpty=TableCellProxyBase.IsCurrentElementContentEmpty(this.GetElement());if(isEmpty==="0"){return isEmpty}g_utilities.TraverseSapDescendants(this.GetElement(),function(currentDescendant){if(typeof currentDescendant.getVisible==="function"){if(!currentDescendant.getVisible()){return true}}let isEmptyDescendant=TableCellProxyBase.IsCurrentElementContentEmpty(currentDescendant);if(!isEmptyDescendant){return true}isEmpty=isEmptyDescendant;return isEmpty==="1"});return isEmpty}}class TableCellProxy_SapUiTable extends TableCellProxyBase{static CreateForElement(element){if((typeof sap=='undefined')||(typeof sap.ui=='undefined')||(typeof sap.ui.table=='undefined')||(typeof sap.ui.table.Table=='undefined')){return null}let isTreeTableLoaded=(typeof sap.ui.table.TreeTable!='undefined');for(let cell=element;cell!=null;cell=cell.getParent()){let row=cell.getParent();if(!(row instanceof sap.ui.table.Row)){continue}let table=row.getParent();if(!(table instanceof sap.ui.table.Table)){continue}if(isTreeTableLoaded&&(table instanceof sap.ui.table.TreeTable)){continue}let rowIndex=row.getIndex();let colIndex=row.indexOfCell(cell);if(rowIndex<0||colIndex<0){continue}let tableControl=new SapUiTable(table);let rowControl=new SapUiTableRow(tableControl,row,rowIndex);return new TableCellProxy_SapUiTable(rowControl,colIndex,element)}return null}GetVirtualId(){let row=this.GetRowControl().GetTableRow();let colIndex=this.GetColIndex();let cell=row.getCells()[colIndex];let cellIndex=g_utilities.GetSapDescendantIndex(cell,this.GetElement());if(cellIndex<0){return""}return this.ComposeVirtualId(colIndex,cellIndex,this.GetRowControl().GetVirtualId())}BringIntoViewVirtualId(virtualId){let parsedVirtualId=this.ParseVirtualId(virtualId);if(!parsedVirtualId){return false}return this.GetRowControl().BringIntoViewVirtualId(parsedVirtualId.rowVirtualId)}ComposeVirtualId(colIndex,cellIndex,rowVirtualId){return colIndex.toString()+","+cellIndex.toString()+","+rowVirtualId}ParseVirtualId(virtualId){if(!virtualId){return null}let tokens=virtualId.split(",");if(tokens.length<3){return null}let result={colIndex:parseInt(tokens[0]),cellIndex:parseInt(tokens[1]),rowVirtualId:tokens.slice(2).join(",")};if(isNaN(result.colIndex)||isNaN(result.cellIndex)){return null}return result}}class TableCellProxy_SapMTable extends TableCellProxyBase{static CreateForElement(element){if((typeof sap=='undefined')||(typeof sap.m=='undefined')||(typeof sap.m.Table=='undefined')){return null}for(let cell=element;cell!=null;cell=cell.getParent()){let row=cell.getParent();if(!(row instanceof sap.m.ColumnListItem)){continue}let table=row.getParent();if(!(table instanceof sap.m.Table)){continue}let rowIndex=table.indexOfItem(row);let colIndex=row.indexOfCell(cell);if(rowIndex<0||colIndex<0){continue}let tableControl=new SapMTable(table);let rowControl=new SapMTableRow(tableControl,row,rowIndex);return new TableCellProxy_SapMTable(rowControl,colIndex,element)}return null}}class SapContentWalkerBase{constructor(){}InitializeResult(isLastView,traverseAll,traverseIdList,repeatRequest){return{isLastView:isLastView,traverseAll:traverseAll,traverseIdList:traverseIdList,repeatRequest:repeatRequest}}InitializeResultRepeat(repeatRequest){return this.InitializeResult(false,false,[],repeatRequest)}InitializeResultTraverse(isLastView,traverseAll,traverseIdList){return this.InitializeResult(isLastView,traverseAll,traverseIdList,"")}InitializeResultStop(){return this.InitializeResult(true,false,[],"")}Initialize(_hints,_repeatRequest){return this.InitializeResultTraverse(true,true,[])}FetchNext(){return""}}class SapContentWalker_SapUiTable extends SapContentWalkerBase{constructor(table){super();this.m_table=table}static CreateForElement(element){if((!element)||(typeof sap=='undefined')||(typeof sap.ui=='undefined')||(typeof sap.ui.table=='undefined')||(typeof sap.ui.table.Table=='undefined')){return null}if(!(element instanceof sap.ui.table.Table)){return null}if((typeof sap.ui.table.TreeTable!='undefined')&&(element instanceof sap.ui.table.TreeTable)){return null}return new SapContentWalker_SapUiTable(element)}GetVisibleRowIndex(rowIndex){let firstVisibleRow=this.m_table.getFirstVisibleRow();let visibleRowCount=this.m_table.getRows().length;if((rowIndex>=firstVisibleRow)&&(rowIndex-firstVisibleRow<visibleRowCount)){return(rowIndex-firstVisibleRow)}return-1}GetVisibleRowHtmlIds(visibleIndexStart,visibleIndexEnd){let rowIds=[];let tableRows=this.m_table.getRows();for(let i=visibleIndexStart;i<visibleIndexEnd;i++){rowIds.push(tableRows[i].getDomRef().id)}return rowIds}CreateRepeatRequest(nextRow){return JSON.stringify({nextRow:nextRow})}InitializeResultRepeat(nextRow){let repeatRequest=this.CreateRepeatRequest(nextRow);return super.InitializeResultRepeat(repeatRequest)}InitializeFromRepeatRequest(hints,repeatRequest){let nextRow=JSON.parse(repeatRequest).nextRow;if(isNaN(nextRow)){return null}let visibleIndex=this.GetVisibleRowIndex(nextRow);if(visibleIndex<0){return this.InitializeResultStop()}if(hints.rowIndex){if(parseInt(hints.rowIndex)!=nextRow){return null}return this.InitializeResultTraverse(true,false,this.GetVisibleRowHtmlIds(visibleIndex,visibleIndex+1))}if(nextRow==0){return this.InitializeResultTraverse(false,true,[])}return this.InitializeResultTraverse(false,false,this.GetVisibleRowHtmlIds(visibleIndex,this.m_table.getRows().length))}Initialize(hints,repeatRequest){if(repeatRequest){return this.InitializeFromRepeatRequest(hints,repeatRequest)}if(hints.rowIndex){let rowIndex=parseInt(hints.rowIndex);if(isNaN(rowIndex)){return null}let visibleIndex=this.GetVisibleRowIndex(rowIndex);if(visibleIndex<0){this.m_table.setFirstVisibleRow(rowIndex);return this.InitializeResultRepeat(rowIndex)}return this.InitializeResultTraverse(true,false,this.GetVisibleRowHtmlIds(visibleIndex,visibleIndex+1))}if(this.m_table.getFirstVisibleRow()!=0){this.m_table.setFirstVisibleRow(0);return this.InitializeResultRepeat(0)}return this.InitializeResultTraverse(false,true,[])}FetchNext(){let firstVisibleRow=this.m_table.getFirstVisibleRow();let visibleRowCount=this.m_table.getRows().length;let nextRowIndex=firstVisibleRow+visibleRowCount;this.m_table.setFirstVisibleRow(nextRowIndex);return this.CreateRepeatRequest(nextRowIndex)}}class SapContentWalker_SapMTable extends SapContentWalkerBase{constructor(table){super();this.m_table=table}static CreateForElement(element){if((!element)||(typeof sap=='undefined')||(typeof sap.m=='undefined')||(typeof sap.m.Table=='undefined')){return null}if(!(element instanceof sap.m.Table)){return null}return new SapContentWalker_SapMTable(element)}IsLastView(){if(!this.m_table.getGrowing()){return true}let growingInfo=this.m_table.getGrowingInfo();return(growingInfo.actual>=growingInfo.total)}GetRowHtmlIds(indexStart,indexEnd){let rowIds=[];let tableRows=this.m_table.getItems();for(let i=indexStart;i<indexEnd;i++){rowIds.push(tableRows[i].getDomRef().id)}return rowIds}InitializeFromRepeatRequest(hints,repeatRequest){let nextRow=JSON.parse(repeatRequest).nextRow;if(isNaN(nextRow)){return null}let visibleRowCount=this.m_table.getItems().length;if(nextRow>=visibleRowCount){return this.InitializeResultStop()}if(hints.rowIndex){let rowIndex=parseInt(hints.rowIndex);if(isNaN(rowIndex)){return null}if(rowIndex>=visibleRowCount){repeatRequest=this.FetchNext();return repeatRequest?this.InitializeResultRepeat(repeatRequest):this.InitializeResultStop()}return this.InitializeResultTraverse(true,false,this.GetRowHtmlIds(rowIndex,rowIndex+1))}return this.InitializeResultTraverse(this.IsLastView(),false,this.GetRowHtmlIds(nextRow,visibleRowCount))}Initialize(hints,repeatRequest){if(repeatRequest){return this.InitializeFromRepeatRequest(hints,repeatRequest)}if(hints.rowIndex){let rowIndex=parseInt(hints.rowIndex);if(isNaN(rowIndex)){return null}if(rowIndex>=this.m_table.getItems().length){repeatRequest=this.FetchNext();return repeatRequest?this.InitializeResultRepeat(repeatRequest):this.InitializeResultStop()}return this.InitializeResultTraverse(true,false,this.GetRowHtmlIds(rowIndex,rowIndex+1))}return this.InitializeResultTraverse(this.IsLastView(),true,[])}FetchNext(){if(this.IsLastView()){return""}let nextRow=this.m_table.getItems().length;if(this.m_table.getGrowingScrollToLoad()&&(typeof this.m_table.scrollToIndex==='function')){this.m_table.scrollToIndex(-1)}else{let sapCore=sap.ui.getCore();let growTriggerFound=false;let htmlDescendants=this.m_table.getDomRef().querySelectorAll("[data-sap-ui]");for(let i=htmlDescendants.length;i>0;i--){let sapDescendant=sapCore.byId(htmlDescendants[i-1].id);if(sapDescendant&&(sapDescendant instanceof sap.m.CustomListItem)&&(this.m_table.indexOfItem(sapDescendant)<0)&&(typeof sapDescendant.firePress==="function")){sapDescendant.firePress();growTriggerFound=true;break}}if(!growTriggerFound){return null}}return JSON.stringify({nextRow:nextRow})}}class SapFioriPageWorldServer{constructor(driverVersion){let config={requestEventName:"__UiPath_SapFiori_Request_"+driverVersion,responseEventName:"__UiPath_SapFiori_Response_"+driverVersion,requestParamAttrName:"data-UiPath_SapFiori_Request_Attr_"+driverVersion,responseParamAttrName:"data-UiPath_SapFiori_Response_Attr_"+driverVersion};this.pageWorldServer=new PageWorldServer(config,request=>{let responseData=this.ProcessRequest(request.requestId,request.data);return{result:responseData}})}ProcessRequest(requestId,requestData){switch(requestId){case 1:return true;case 2:return this.IsSapFioriFramework();case 3:return g_utilities.IsSapFioriElementFromId(requestData);case 4:{let getSapFioriElementRequest=requestData;let sapElement=g_utilities.GetSapElementFromHtmlElementCustomId(getSapFioriElementRequest);return g_utilities.SapElementToResult(sapElement,getSapFioriElementRequest.customIdAttributeName)}case 5:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapDynamicAttributesList(element)});case 6:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapPropertyBasedSelectorAttributeNames(element)});case 7:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapSelectorFixedAttributes(element)});case 8:return g_utilities.GetSapVirtualIdFromId(requestData);case 9:return g_utilities.BringIntoViewSapVirtualIdFromId(requestData);case 10:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapId(element)});case 11:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapClass(element)});case 12:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapRole(element)});case 13:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapType(element)});case 14:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapLabel(element)});case 15:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapTooltip(element)});case 16:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapIsEmpty(element)});case 17:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapTableRowIndex(element)});case 18:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapTableColIndex(element)});case 19:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapColLabel(element)});case 20:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapAllColLabels(element)});case 21:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetSapReadyState(element)});case 22:{let getAttrRequest=requestData;return this.DoWithSapElement(getAttrRequest,element=>{return g_utilities.GetSapPropertyBasedAttribute(element,getAttrRequest.attrName)})}case 23:return g_utilities.IsStableSapId(requestData);case 24:return this.DoWithSapElement(requestData,element=>{let sapElement=g_utilities.GetNextInterestingParent(element);return g_utilities.SapElementToResult(sapElement,null)});case 25:{let setAttrRequest=requestData;return this.DoWithSapElement(setAttrRequest,element=>{return g_utilities.AddHtmlDomAttribute(element,setAttrRequest)})}case 26:{let writeTextRequest=requestData;return this.DoWithSapElement(writeTextRequest,element=>{return g_utilities.WriteText(element,writeTextRequest)})}case 27:return this.DoWithSapElement(requestData,element=>{return g_utilities.Click(element)});case 28:{let getSelectedItemsRequest=requestData;return this.DoWithSapElement(getSelectedItemsRequest,element=>{return g_utilities.GetSelectedItems(element,getSelectedItemsRequest)})}case 29:{let selectItemsRequest=requestData;return this.DoWithSapElement(selectItemsRequest,element=>{return g_utilities.SelectItems(element,selectItemsRequest)})}case 30:return this.DoWithSapElement(requestData,element=>{return g_utilities.GetChecked(element)});case 31:{let setCheckedRequest=requestData;return this.DoWithSapElement(requestData,element=>{return g_utilities.Check(element,setCheckedRequest)})}case 32:return this.DoWithSapElement(requestData,element=>{return g_utilities.IsElementCheckable(element)});case 33:return this.DoWithSapElement(requestData,element=>{return g_utilities.IsElementSelectable(element)});case 34:return this.DoWithSapElement(requestData,element=>{return g_utilities.SetFocus(element)});case 35:return this.DoWithSapElement(requestData,element=>{return g_utilities.HasSapContentWalker(element)});case 36:{let initContentWalkerRequest=requestData;return this.DoWithSapElement(initContentWalkerRequest,element=>{return g_utilities.SapContentWalkerInitialize(element,initContentWalkerRequest)})}case 37:return this.DoWithSapElement(requestData,element=>{return g_utilities.SapContentWalkerFetchNext(element)});default:let unhandledRequest=requestId;TraceError("[UiPathSapFioriServer::ProcessRequest] unhandledRequest: "+unhandledRequest);return null}}DoWithSapElement(requestData,actionCb){let element=g_utilities.GetSapElementFromHtmlId(requestData.htmlId);if(!element){return null}return actionCb(element)}IsSapFioriFramework(){if((typeof sap!='undefined')&&(typeof sap.ui!='undefined')){return true}else{return false}}}TraceMessage("[SapFiori_PageWorld] driverVersion:",driverVersion);const g_utilities=new SapFioriUtilities(driverVersion);let uiPathSapFioriKey="__uiPathSapFiori";let uiPathSapFioriGlobal=window[uiPathSapFioriKey];if(!uiPathSapFioriGlobal){uiPathSapFioriGlobal={};window[uiPathSapFioriKey]=uiPathSapFioriGlobal}if(uiPathSapFioriGlobal[driverVersion]){TraceError("[SapFiori_PageWorld] Skipped. Already defined driverVersion:",driverVersion)}else{uiPathSapFioriGlobal[driverVersion]=new SapFioriPageWorldServer(driverVersion)}}exports.SapFiori_PageWorld_InjectedFunc=SapFiori_PageWorld_InjectedFunc}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.DetailedDriverVersion=void 0;class DetailedDriverVersion{constructor(versionMajor,versionMinor,buildNumberMajor,buildNumberMinor){this.versionMajor=versionMajor;this.versionMinor=versionMinor;this.buildNumberMajor=buildNumberMajor;this.buildNumberMinor=buildNumberMinor}static FromVersionString(codeVersion){const versionParametersCount=4;let detailedDriveVersion=new DetailedDriverVersion(0,0,0,0);let versionSuffixStart=codeVersion.indexOf('-');if(versionSuffixStart>0){codeVersion=codeVersion.substring(0,versionSuffixStart)}const chunks=codeVersion.trim().split('.').map(chunk=>Number(chunk));if((chunks.length==versionParametersCount)&&chunks.every(chunk=>Number.isInteger(chunk))){detailedDriveVersion=new DetailedDriverVersion(chunks[0],chunks[1],chunks[2],chunks[3])}return detailedDriveVersion}ToString(){return this.versionMajor+"."+this.versionMinor+"."+this.buildNumberMajor+"."+this.buildNumberMinor}IsCompatibleWith(other){return(this.versionMajor===other.versionMajor)&&(this.versionMinor===other.versionMinor)}}exports.DetailedDriverVersion=DetailedDriverVersion}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.LoaderWin32=void 0;const NativeHostConnector_1=__webpack_require__(28);const BrowserTools_1=__webpack_require__(3);const ExtensionErrorService_1=__webpack_require__(30);const Logger_1=__webpack_require__(4);const ReturnCallbackMap_1=__webpack_require__(31);class LoaderWin32{constructor(packageManager,extensionError,extensionWindowId,nativeHost){this.callbackMap=new ReturnCallbackMap_1.ReturnCallbackMap;this.logger=new Logger_1.ClassLogger(LoaderWin32);this.packageManager=packageManager;this.extensionErrorService=extensionError;this.extensionWindowId=extensionWindowId;this.onWindowCreated=wnd=>{this.RegisterWindowId(wnd)};this.onWindowRemoved=windowId=>{this.UnregisterWindowId(windowId)};this.RegisterWindowListeners();this.nativeHost=nativeHost;this.nativeHost.OnMessageFromNativeHost.AddListener(msg=>{this.OnNativeHostMessage(msg)});this.nativeHost.OnDisconnected.AddListener(()=>{this.OnNativeHostDisconnected()});this.nativeHost.OnReconnected.AddListener(()=>{this.OnNativeHostConnected()});this.OnNativeHostConnected()}static CreateInstance(packageManager,extensionError,extensionWindowId,nativeHost){if(!nativeHost){let nativeAppName=BrowserTools_1.BrowserTools.IsChromeBrowser()?"com.uipath.chromenativemsg_v2":"com.uipath.chromenativemsg";nativeHost=new NativeHostConnector_1.NativeHostConnector(nativeAppName)}return new LoaderWin32(packageManager,extensionError,extensionWindowId,nativeHost)}OnNativeHostConnected(){this.logger.Log(this.OnNativeHostConnected);this.RegisterAllWindowIds(()=>{this.logger.Log(this.OnNativeHostConnected,"Received reply to RegisterAllWindowIds");if(this.extensionErrorService.GetError()===ExtensionErrorService_1.ExtensionErrorType.NativeHostDisconnected){this.extensionErrorService.ClearExtensionError()}})}OnNativeHostDisconnected(){this.logger.Log(this.OnNativeHostDisconnected);this.extensionErrorService.SetExtensionError(ExtensionErrorService_1.ExtensionErrorType.NativeHostDisconnected)}OnNativeHostMessage(message){if(message.functionCall){let driverRequest=message;if(driverRequest.functionCall==="OnProductVersionChanged"){this.OnProductVersionChanged(driverRequest)}else if(driverRequest.functionCall==="CanLoadDriverVersion"){let canLoadDriverRequest=driverRequest;this.packageManager.CanLoadDriverVersion(canLoadDriverRequest.detailedVersion).then(canLoadDriverVersion=>{let response={canLoadDriverVersion:canLoadDriverVersion?1:0};this.SendDriverResponse(driverRequest,response)})}else if(driverRequest.functionCall==="GetEmbeddedDriverVersions"){let response={versions:this.packageManager.GetEmbeddedDriverVersions()};this.SendDriverResponse(driverRequest,response)}else if(driverRequest.functionCall==="_ValidatePermissions"){BrowserTools_1.BrowserTools._ValidatePermissions()}else{this.packageManager.ProcessDriverRequest(driverRequest.codeVersion.toString(),message,responseData=>{this.SendDriverResponse(driverRequest,responseData)})}}else if(message.returnId){let functionCallResponse=message;this.callbackMap.HandleReturnCallback(functionCallResponse.returnId,message)}else if(message.multipleProfilesError){this.OnMultipleProfilesError()}}OnProductVersionChanged(message){let newVersion=message.codeVersion.toString();this.logger.Log(this.OnProductVersionChanged,"begin newVersion:",newVersion);this.ChangeImplementation(wasDriverLoaded=>{this.logger.Log(this.OnProductVersionChanged,"finished newVersion: ",newVersion);let response={wasDriverLoaded:wasDriverLoaded?1:0,embeddedVersions:this.packageManager.GetEmbeddedDriverVersions()};this.SendDriverResponse(message,response)})}SendDriverResponse(message,responseData={}){if(message.requestId!==undefined){let response=responseData;response.returnId=message.requestId;response.codeVersion=message.codeVersion;this.nativeHost.SendMsgToNativeHost(response)}}OnMultipleProfilesError(){this.logger.Log(this.OnMultipleProfilesError);this.extensionErrorService.SetExtensionError(ExtensionErrorService_1.ExtensionErrorType.MultipleProfilesError)}ChangeImplementation(onCompletedCb){this.logger.Log(this.ChangeImplementation);this.CallNativeHostFunction("LoadScripts",{},codeData=>{let driverVersion=codeData.version.toString();let nativeHostToBackground={CallFunction:(functionName,inputParams,returnFunc)=>{this.CallDriverNativeHostFunction(functionName,driverVersion,inputParams,returnFunc)}};this.packageManager.LoadDriverPackage(codeData,nativeHostToBackground,onCompletedCb)})}RegisterAllWindowIds(onCompletedAllCb){this.logger.Log(this.RegisterAllWindowIds);chrome.windows.getAll({populate:false},allWindows=>{this.logger.Log(this.RegisterAllWindowIds,"allWindows.length:",allWindows.length);let windowsToRegister=[];for(let window of allWindows){if(window.id!==this.extensionWindowId){windowsToRegister.push(window)}}let hasMultipleWindows=windowsToRegister.length>1;BrowserTools_1.BrowserTools.ForAllSequential(windowsToRegister,(window,onCompletedCb)=>{var _a;if(hasMultipleWindows){let windowId=(_a=window.id)!==null&&_a!==void 0?_a:0;chrome.windows.update(windowId,{focused:true},updatedWindow=>{if(!updatedWindow){if(chrome.runtime.lastError){this.logger.Log(this.RegisterAllWindowIds,"Failed to update windowId:",windowId,"chrome.runtime.lastError: ",chrome.runtime.lastError.message)}return onCompletedCb()}return this.RegisterWindowId(updatedWindow,onCompletedCb)})}else{this.RegisterWindowId(window,onCompletedCb)}},onCompletedAllCb)})}RegisterWindowListeners(){chrome.windows.onCreated.addListener(this.onWindowCreated);chrome.windows.onRemoved.addListener(this.onWindowRemoved)}UnregisterWindowListeners(){chrome.windows.onCreated.removeListener(this.onWindowCreated);chrome.windows.onRemoved.removeListener(this.onWindowRemoved)}RegisterWindowId(wnd,responseCb){if(this.extensionWindowId===wnd.id){this.logger.Log(this.RegisterWindowId,"Skip registering extension windowId:",wnd.id);if(responseCb){responseCb()}return}this.logger.Log(this.RegisterWindowId,"windowId:",wnd.id);let windowData=BrowserTools_1.BrowserTools.GetBrowserWindowData(wnd);this.CallNativeHostFunction("RegisterNewlyCreatedWindowId",windowData,responseCb)}UnregisterWindowId(windowId){this.logger.Log(this.UnregisterWindowId,"windowId:",windowId);this.CallNativeHostFunction("UnregisterWindowId",{windowId:windowId})}CallDriverNativeHostFunction(functionName,driverVersion,inputParams,returnFunc){let request=inputParams;request.driverVersion=driverVersion;this.CallNativeHostFunction(functionName,request,returnFunc)}CallNativeHostFunction(functionName,inputParams,returnFunc){let request=inputParams;if(returnFunc!==undefined){request.requestId=this.callbackMap.RegisterReturnCallback(returnFunc)}request.functionCall=functionName;this.nativeHost.SendMsgToNativeHost(request)}}exports.LoaderWin32=LoaderWin32}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.NativeHostConnector=void 0;const Event_1=__webpack_require__(29);const Logger_1=__webpack_require__(4);class NativeHostConnector{constructor(nativeHostKey){this.m_nativeMsgPort=null;this.m_hasReceivedAnyMessageFromNativeHost=false;this.m_onMessageEvent=new Event_1.SimpleEvent1;this.m_onDisconnectedEvent=new Event_1.SimpleEvent;this.m_onReconnectedEvent=new Event_1.SimpleEvent;this.logger=new Logger_1.ClassLogger(NativeHostConnector);this.m_nativeHostKey=nativeHostKey;this.m_onMessageCb=(message,_port)=>{this.HandleNativeHostMessage(message)};this.m_onDisconnectedCb=port=>{this.HandleNativeHostDisconnect(port)};let nativeHostPort=NativeHostConnector.StartNativeHost(nativeHostKey);if(nativeHostPort){this.SetNativeHostPort(nativeHostPort)}}get OnMessageFromNativeHost(){return this.m_onMessageEvent}get OnDisconnected(){return this.m_onDisconnectedEvent}get OnReconnected(){return this.m_onReconnectedEvent}SendMsgToNativeHost(message){try{if(this.m_nativeMsgPort){this.m_nativeMsgPort.postMessage(message)}else{this.logger.Error(this.SendMsgToNativeHost,"nativeHostKey:",this.m_nativeHostKey,"Failed to send message because m_nativeMsgPort is not yet initialized.")}}catch(err){this.logger.Error(this.SendMsgToNativeHost,"postMessage has thrown:",err)}}DetachNativeHostPort(){if(!this.m_nativeMsgPort){return null}let tempPort=this.m_nativeMsgPort;this.m_nativeMsgPort.onMessage.removeListener(this.m_onMessageCb);this.m_nativeMsgPort.onDisconnect.removeListener(this.m_onDisconnectedCb);this.m_nativeMsgPort=null;return tempPort}SetNativeHostPort(port){this.m_nativeMsgPort=port;this.m_nativeMsgPort.onMessage.addListener(this.m_onMessageCb);this.m_nativeMsgPort.onDisconnect.addListener(this.m_onDisconnectedCb)}static StartNativeHost(nativeHostKey){Logger_1.Logger.Log("[NativeHostConnector.StartNativeHost] nativeHostKey:",nativeHostKey);try{let nativeMsgPort=chrome.runtime.connectNative(nativeHostKey);Logger_1.Logger.Log("[NativeHostConnector.StartNativeHost] Created native messaging port with key:",nativeHostKey);return nativeMsgPort}catch(err){Logger_1.Logger.Error("[NativeHostConnector.StartNativeHost] runtime.connectNative has thrown:",err)}return null}TryReconnectNativeHost(){this.logger.Log(this.TryReconnectNativeHost,"nativeHostKey:",this.m_nativeHostKey);setTimeout(()=>{let nativeHostPort=NativeHostConnector.StartNativeHost(this.m_nativeHostKey);if(nativeHostPort){this.SetNativeHostPort(nativeHostPort);this.OnNativeHostConnected()}},10000)}OnNativeHostConnected(){this.logger.Log(this.OnNativeHostConnected);this.m_onReconnectedEvent.CallListeners()}HandleNativeHostMessage(message){this.m_hasReceivedAnyMessageFromNativeHost=true;this.m_onMessageEvent.CallListeners(message)}HandleNativeHostDisconnect(port){if(chrome.runtime.lastError){this.logger.Error(this.HandleNativeHostDisconnect," nativeHostKey:",this.m_nativeHostKey,", lastError:",chrome.runtime.lastError.message)}else{this.logger.Log(this.HandleNativeHostDisconnect,"no error; nativeHostKey:",this.m_nativeHostKey)}if(this.m_nativeMsgPort===port){this.DetachNativeHostPort();this.m_onDisconnectedEvent.CallListeners();if(this.m_hasReceivedAnyMessageFromNativeHost){this.TryReconnectNativeHost()}}}}exports.NativeHostConnector=NativeHostConnector}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.SimpleEvent2=exports.SimpleEvent1=exports.SimpleEvent=void 0;class EventBase{constructor(){this.m_listeners=new Set}CallListenersImpl(...args){this.m_listeners.forEach(cb=>{cb(...args)})}AddListener(cb){this.m_listeners.add(cb)}RemoteListener(cb){this.m_listeners.delete(cb)}}class SimpleEvent extends EventBase{CallListeners(){this.CallListenersImpl()}}exports.SimpleEvent=SimpleEvent;class SimpleEvent1 extends EventBase{CallListeners(arg){this.CallListenersImpl(arg)}}exports.SimpleEvent1=SimpleEvent1;class SimpleEvent2 extends EventBase{CallListeners(arg1,arg2){this.CallListenersImpl(arg1,arg2)}}exports.SimpleEvent2=SimpleEvent2}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ExtensionErrorService=exports.ExtensionErrorType=void 0;const Logger_1=__webpack_require__(4);var ExtensionErrorType;(function(ExtensionErrorType){ExtensionErrorType["NoError"]="NoError";ExtensionErrorType["NativeHostDisconnected"]="NativeHostDisconnected";ExtensionErrorType["MultipleProfilesError"]="MultipleProfilesError";ExtensionErrorType["MultipleWindowsError"]="MultipleWindowsError"})(ExtensionErrorType=exports.ExtensionErrorType||(exports.ExtensionErrorType={}));;class ExtensionErrorService{constructor(){this.m_error=null;this.m_errorMessage="";this.ClearExtensionError()}SetExtensionError(errorType){if(this.m_error===errorType){return}if(!chrome.action){Logger_1.Logger.Error("[SetExtensionError] failed to retrieve chrome.action");return}Logger_1.Logger.Log("[SetExtensionError] errType:",errorType);this.m_error=errorType;if(this.m_error===ExtensionErrorType.NoError){this.m_errorMessage="";chrome.action.setBadgeText({text:""});chrome.action.setPopup({popup:""});this.RefreshExtensionWindowMessage();return}this.m_errorMessage=this.GetBrowserErrorLocalizedText(this.m_error);var badgeText=chrome.i18n.getMessage("badgeTextError");chrome.action.setBadgeText({text:badgeText});chrome.action.setPopup({popup:"popup.html"});chrome.action.setBadgeBackgroundColor({color:[255,0,0,255]});this.RefreshExtensionWindowMessage()}ClearExtensionError(){Logger_1.Logger.Log("[ClearExtensionError]");this.SetExtensionError(ExtensionErrorType.NoError)}GetError(){var _a;return(_a=this.m_error)!==null&&_a!==void 0?_a:ExtensionErrorType.NoError}GetPopupErrorMessage(){return this.m_errorMessage}GetBrowserErrorLocalizedText(errType){var popupText="";if(errType===ExtensionErrorType.NativeHostDisconnected){popupText=chrome.i18n.getMessage("nativeHostDisconnected")}else if(errType===ExtensionErrorType.MultipleWindowsError){popupText=chrome.i18n.getMessage("multipleWindowsError")}else if(errType===ExtensionErrorType.MultipleProfilesError){popupText=chrome.i18n.getMessage("multipleProfilesError")}return popupText}RefreshExtensionWindowMessage(){if(!document){return}let statusNativeHostError=document.getElementById("status_nativeHostError");let statusOkay=document.getElementById("status_okay");if(!statusNativeHostError||!statusOkay){Logger_1.Logger.Error("[RefreshExtensionWindowMessage] Could not find status elements from BackgroundPage.html");return}let styleShow="block";let styleHide="none";let styleForStatusError=styleHide;let styleForStatusOkay=styleShow;if(this.m_error===ExtensionErrorType.NativeHostDisconnected){styleForStatusError=styleShow;styleForStatusOkay=styleHide}statusNativeHostError.style.display=styleForStatusError;statusOkay.style.display=styleForStatusOkay}}exports.ExtensionErrorService=ExtensionErrorService}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ReturnCallbackMap=void 0;const Logger_1=__webpack_require__(4);class ReturnCallbackMap{constructor(){this.m_crtRequestId=0;this.m_returnMap=new Map}RegisterReturnCallback(returnFunc){++this.m_crtRequestId;this.m_returnMap.set(this.m_crtRequestId,returnFunc);return this.m_crtRequestId}HandleReturnCallback(returnId,params){var returnFunc=this.m_returnMap.get(returnId);if(returnFunc){returnFunc(params);this.m_returnMap.delete(returnId)}}DismissAllPendingCallbacks(responseData,chromeLastErrorToSet){Logger_1.Logger.Log("[ReturnCallbackMap::DismissAllPendingCallbacks] this.m_returnMap.size: "+this.m_returnMap.size);let canSetChromeLastError=chromeLastErrorToSet&&!chrome.runtime.lastError;this.m_returnMap.forEach(returnFunc=>{try{if(canSetChromeLastError){chrome.runtime.lastError={message:chromeLastErrorToSet}}returnFunc(responseData)}finally{if(canSetChromeLastError){chrome.runtime.lastError=undefined}}})}}exports.ReturnCallbackMap=ReturnCallbackMap}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.LoaderPortable=void 0;const NativeHostConnector_1=__webpack_require__(28);const Logger_1=__webpack_require__(4);const StudioConnector_1=__webpack_require__(33);const ReturnCallbackMap_1=__webpack_require__(31);const DetailedDriverVersion_1=__webpack_require__(26);const Tools_1=__webpack_require__(8);class LoaderPortable{constructor(packageManager,nativeHost){this.callbackMap=new ReturnCallbackMap_1.ReturnCallbackMap;this.logger=new Logger_1.ClassLogger(LoaderPortable);this.packageManager=packageManager;this.nativeHost=nativeHost;this.nativeHost.OnMessageFromNativeHost.AddListener(message=>{if(typeof message.ReturnId!=="undefined"){this.OnResponseFromNativeHost(message)}else{this.OnMessageFromNativeHost(message)}})}static CreateInstance(packageManager,nativeHost){if(!nativeHost){nativeHost=new NativeHostConnector_1.NativeHostConnector("com.uipath.portable_host")}return new LoaderPortable(packageManager,nativeHost)}static CreateStudioHost(packageManager,connectionHandler){let nativeHost=new StudioConnector_1.StudioConnector("com.uipath.studio_web_host",connectionHandler);return new LoaderPortable(packageManager,nativeHost)}OnMessageFromNativeHost(message){let requestId=message.RequestId;let requestData=message.RequestData;let codeVersion=requestData.codeVersion.toString();let functionCall=requestData.functionCall;if(functionCall==="LoadScripts"){let request=requestData;let codeData=LoaderPortable.GetDriverCodeData(request);this.LoadDriver(codeData,loadedDriver=>{let responseData={wasDriverLoaded:loadedDriver,embeddedVersions:this.packageManager.GetEmbeddedDriverVersions()};this.SendResponseToNativeHost(requestId,2,responseData)})}else if(functionCall==="CanLoadDriverVersion"){let detailedVersion=DetailedDriverVersion_1.DetailedDriverVersion.FromVersionString(Tools_1.Tools.UnsafeCast(message.RequestData.codeVersion));this.packageManager.CanLoadDriverVersion(detailedVersion).then(canLoadDriverVersion=>{let responseData={canLoadDriverVersion:canLoadDriverVersion};this.SendResponseToNativeHost(requestId,2,responseData)})}else if(functionCall==="GetEmbeddedDriverVersions"){let responseData={versions:this.packageManager.GetEmbeddedDriverVersions()};this.SendResponseToNativeHost(requestId,2,responseData)}else if(this.packageManager.IsDriverAvailable(codeVersion)){this.packageManager.ProcessDriverRequest(codeVersion,requestData,responseData=>{this.SendResponseToNativeHost(requestId,2,responseData)})}else{this.SendResponseToNativeHost(requestId,1,{})}}OnResponseFromNativeHost(response){this.callbackMap.HandleReturnCallback(response.ReturnId,response.ResponseData)}GetNativeHostResponseCb(requestId){return()=>{this.SendResponseToNativeHost(requestId,2,{})}}SendResponseToNativeHost(requestId,responseCode,responseData){let response={RequestId:requestId,ResponseCode:responseCode,ResponseData:responseData};this.nativeHost.SendMsgToNativeHost(response)}LoadDriver(codeData,onCompletedCb){this.logger.Log(this.LoadDriver,"newVersion: ",codeData.version);let driverVersion=codeData.version.toString();let nativeHostToBackground={CallFunction:(functionName,inputParams,returnFunc)=>{if(!inputParams){inputParams={}}if(!returnFunc){returnFunc=()=>{}}let requestId=this.callbackMap.RegisterReturnCallback(returnFunc);let request={RequestId:requestId,FunctionCall:functionName,DriverVersion:driverVersion,RequestData:inputParams};this.nativeHost.SendMsgToNativeHost(request)}};this.packageManager.LoadDriverPackage(codeData,nativeHostToBackground,onCompletedCb)}static GetDriverCodeData(request){let codeData={version:request.codeVersion,content:request.ContentScripts,contentPageWorld:request.ContentPageWorld,background:request.BackgroundScripts,hasSupportForMV3:request.HasSupportForMV3,needsToBeLoadedInAllTabs:request.NeedsToBeLoadedInAllTabs,detailedVersion:DetailedDriverVersion_1.DetailedDriverVersion.FromVersionString(Tools_1.Tools.UnsafeCast(request.codeVersion))};for(let scriptName in request.InjectedScripts){codeData[scriptName]=request.InjectedScripts[scriptName]}return codeData}}exports.LoaderPortable=LoaderPortable}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.StudioConnector=exports.StudioConnected=exports.AnotherStudioConnected=void 0;const Logger_1=__webpack_require__(4);const Tools_1=__webpack_require__(8);const Event_1=__webpack_require__(29);const CONNECT_REQUEST_ID=-1;exports.AnotherStudioConnected={RequestId:CONNECT_REQUEST_ID,ResponseCode:3,ResponseData:null};exports.StudioConnected={RequestId:CONNECT_REQUEST_ID,ResponseCode:2,ResponseData:null};class StudioConnector{constructor(nativeHostKey,connectionHandler){this.m_msgPort=null;this.m_onMessageEvent=new Event_1.SimpleEvent1;this.m_onDisconnectedEvent=new Event_1.SimpleEvent;this.m_onReconnectedEvent=new Event_1.SimpleEvent;this.m_nativeHostKey=nativeHostKey;this.m_onMessageCb=(message,_port)=>{this.m_onMessageEvent.CallListeners(message)};connectionHandler.addExternalConnectionHandler(connection=>{this._handleExternalConnection(connection)});connectionHandler.addOnDisconnectPortHandler((port,tab)=>{this._onPortDisconnected(port,tab)})}get OnMessageFromNativeHost(){return this.m_onMessageEvent}get OnDisconnected(){return this.m_onDisconnectedEvent}get OnReconnected(){return this.m_onReconnectedEvent}_onPortDisconnected(port,_tab){this.HandleHostDisconnect(port)}SendMsgToNativeHost(message){try{if(!Tools_1.Tools.isNil(this.m_msgPort)){this.m_msgPort.postMessage(message)}else{Logger_1.Logger.Error("[StudioConnector-SendMsgToStudioHost]"+" nativeHostKey: "+this.m_nativeHostKey+", Failed to send message because m_msgPort is not yet initialized.")}}catch(err){Logger_1.Logger.Error("[StudioConnector-SendMsgToStudioHost] postMessage has thrown: "+String(err))}}DetachNativeHostPort(){if(Tools_1.Tools.isNil(this.m_msgPort)){return null}let tempPort=this.m_msgPort;this.m_msgPort.onMessage.removeListener(this.m_onMessageCb);this.m_msgPort=null;return tempPort}HandleHostDisconnect(port){if(chrome.runtime.lastError){Logger_1.Logger.Error("[StudioConnector-HandleHostDisconnect]"+" nativeHostKey: "+this.m_nativeHostKey+", lastError: "+chrome.runtime.lastError.message)}else{Logger_1.Logger.Log(`[StudioConnector-HandleHostDisconnect] - '${this.m_nativeHostKey}'`)}if(this.m_msgPort===port){Logger_1.Logger.Log(`[StudioConnector-HandleHostDisconnect] - Detach host.`);this.m_onDisconnectedEvent.CallListeners();this.DetachNativeHostPort()}}_handleExternalConnection(connection){var _a;const portName=(_a=connection.port.name)!==null&&_a!==void 0?_a:"";Logger_1.Logger.Log(`[StudioConnector-OnConnectionExternal] - ${portName}`);if(portName!==this.m_nativeHostKey){Logger_1.Logger.Log(`[StudioConnector-InvalidHostKey] - ${portName}`);return}connection.handled=true;if(!Tools_1.Tools.isNil(this.m_msgPort)){Logger_1.Logger.Log("[StudioConnector-OnConnectionExternal] - A connection is already established");connection.port.postMessage(exports.AnotherStudioConnected);connection.port.disconnect();return}Logger_1.Logger.Log("[StudioConnector-OnConnectionExternal] - ValidConnection found");this.SetNativeHostPort(connection.port)}SetNativeHostPort(port){if(Tools_1.Tools.isNil(port)){return}if(!Tools_1.Tools.isNil(this.m_msgPort)){this.HandleHostDisconnect(this.m_msgPort)}this.m_msgPort=port;this.m_msgPort.postMessage(exports.StudioConnected);this.m_msgPort.onMessage.addListener(this.m_onMessageCb)}}exports.StudioConnector=StudioConnector}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ConnectionProxyMatcher=void 0;const Logger_1=__webpack_require__(4);const Helpers_1=__webpack_require__(35);const ConnectionHandler_1=__webpack_require__(36);const Tools_1=__webpack_require__(8);class ConnectionProxy{constructor(id){this.id=id;this.externalPort=null;this.externalTab=null;this.contentPort=null;this.contentTab=null;this._handleExternalMessage=this._handleExternalMessage.bind(this);this._handleContentMessage=this._handleContentMessage.bind(this)}Disconnect(){var _a,_b,_c,_d;if(!Tools_1.Tools.isNil(this.externalPort)){let tabId=(_b=(_a=this.externalTab)===null||_a===void 0?void 0:_a.id)!==null&&_b!==void 0?_b:"";Logger_1.Logger.Log(`[ConnectionProxy] - '${this.id}' Disconnect external port on tab: ${tabId}`);this.externalPort.disconnect()}if(!Tools_1.Tools.isNil(this.contentPort)){let tabId=(_d=(_c=this.contentTab)===null||_c===void 0?void 0:_c.id)!==null&&_d!==void 0?_d:"";Logger_1.Logger.Log(`[ConnectionProxy] - '${this.id}' Disconnect content port on tab: ${tabId}`);this.contentPort.disconnect()}}SetExternalPort(port){var _a,_b;if(Tools_1.Tools.isNil(port)||!Tools_1.Tools.isNil(this.externalPort))return;this.externalPort=port;this.externalTab=(_b=(_a=port.sender)===null||_a===void 0?void 0:_a.tab)!==null&&_b!==void 0?_b:null;this.externalPort.onMessage.addListener(this._handleExternalMessage)}SetContentPort(port){var _a,_b;if(Tools_1.Tools.isNil(port)||!Tools_1.Tools.isNil(this.contentPort)){return}this.contentPort=port;this.contentTab=(_b=(_a=port.sender)===null||_a===void 0?void 0:_a.tab)!==null&&_b!==void 0?_b:null;this.contentPort.onMessage.addListener(this._handleContentMessage)}_handleExternalMessage(message,_source){var _a;if(this._isPingMessage(message)){return}(_a=this.contentPort)===null||_a===void 0?void 0:_a.postMessage(message)}_handleContentMessage(message,_source){var _a;if(this._isPingMessage(message)){return}(_a=this.externalPort)===null||_a===void 0?void 0:_a.postMessage(message)}_isPingMessage(message){return message===ConnectionHandler_1.PING_REQUEST||message===ConnectionHandler_1.PING_RESPONSE}}class ConnectionProxyMatcher{constructor(m_hostKey,connectionHandler){this.m_hostKey=m_hostKey;this._connections=[];this._handleExternalConnection=this._handleExternalConnection.bind(this);this._handleContentConnection=this._handleContentConnection.bind(this);this._handleOnPortDisconnect=this._handleOnPortDisconnect.bind(this);connectionHandler.addExternalConnectionHandler(this._handleExternalConnection);connectionHandler.addContentPageConnectionHandler(this._handleContentConnection);connectionHandler.addOnDisconnectPortHandler(this._handleOnPortDisconnect)}_handleExternalConnection(connection){var _a;const portName=(_a=connection.port.name)!==null&&_a!==void 0?_a:"";Logger_1.Logger.Log(`[ConnectionProxy-OnConnectionExternal] - ${portName}`);if(portName.indexOf(this.m_hostKey)!==0){Logger_1.Logger.Log(`[ConnectionProxy-InvalidHostKey] - ${portName}`);return}connection.handled=true;let liveConnection=(0,Helpers_1.findFirst)(this._connections,c=>c.id===portName);if(Tools_1.Tools.isNil(liveConnection)){liveConnection=new ConnectionProxy(portName);this._connections.push(liveConnection)}if(!Tools_1.Tools.isNil(liveConnection.externalPort)){Logger_1.Logger.Log("[ConnectionProxy-ExternalPortAlreadySet]");connection.port.disconnect();return}liveConnection.SetExternalPort(connection.port)}_handleContentConnection(connection){var _a;const portName=(_a=connection.port.name)!==null&&_a!==void 0?_a:"";Logger_1.Logger.Log(`[ConnectionProxy-OnConnectionContent] - ${portName}`);if(portName.indexOf(this.m_hostKey)!==0){Logger_1.Logger.Log(`[ConnectionProxy-InvalidHostKey] - ${portName}`);return}connection.handled=true;let liveConnection=(0,Helpers_1.findFirst)(this._connections,c=>c.id===portName);if(Tools_1.Tools.isNil(liveConnection)){liveConnection=new ConnectionProxy(portName);this._connections.push(liveConnection)}if(!Tools_1.Tools.isNil(liveConnection.contentPort)){Logger_1.Logger.Log("[ConnectionProxy-ContentPortAlreadySet]");connection.port.disconnect();return}liveConnection.SetContentPort(connection.port)}_handleOnPortDisconnect(port,_tab){const connection=(0,Helpers_1.findFirst)(this._connections,conn=>conn.externalPort===port||conn.contentPort===port);if(Tools_1.Tools.isNil(connection)){return}connection.Disconnect();Logger_1.Logger.Log(`[ConnectionProxy-ConnectionClosed] '${connection.id}'.`);const connectionIdx=this._connections.indexOf(connection);if(connectionIdx<0)return;this._connections.splice(connectionIdx,1)}}exports.ConnectionProxyMatcher=ConnectionProxyMatcher}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.findAll=exports.findFirst=void 0;const Tools_1=__webpack_require__(8);function findFirst(targetArray,predicate){if(Tools_1.Tools.isNil(targetArray)){return null}if(Tools_1.Tools.isNil(predicate)){return null}for(const item of targetArray){if(predicate(item)){return item}}return null}exports.findFirst=findFirst;function findAll(targetArray,predicate){const result=[];if(Tools_1.Tools.isNil(targetArray)){return result}if(Tools_1.Tools.isNil(predicate)){return result}for(const item of targetArray){if(predicate(item)){result.push(item)}}return result}exports.findAll=findAll}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ConnectionHandler=exports.PortConnection=exports.PING_REQUEST=exports.PING_RESPONSE=void 0;const Helpers_1=__webpack_require__(35);const Logger_1=__webpack_require__(4);const Tools_1=__webpack_require__(8);const INVALID_TIMEOUT_ID=-1;const PING_REPLY_TIMEOUT_IN_MS=1000;exports.PING_RESPONSE='com.uipath.extension.ping_response';exports.PING_REQUEST='com.uipath.extension.ping_request';class PortConnection{constructor(port,handled){this.port=port;this.handled=handled}}exports.PortConnection=PortConnection;class WatchedPort{constructor(port,tab,timeout,messageHandler){this.port=port;this.tab=tab;this.timeout=timeout;this.messageHandler=messageHandler}}class ConnectionHandler{constructor(_portNamePrefix='com.uipath'){this._portNamePrefix=_portNamePrefix;this._pageConnectionHandlers=[];this._contentPageConnectionHandlers=[];this._onPortDisconnectHandlers=[];this._watchedPorts=[];this._handleContentPageConnection=this._handleContentPageConnection.bind(this);this._handlePageConnection=this._handlePageConnection.bind(this);this._handleTabRemoved=this._handleTabRemoved.bind(this);this._handleTabUpdated=this._handleTabUpdated.bind(this);chrome.runtime.onConnect.addListener(this._handleContentPageConnection);chrome.runtime.onConnectExternal.addListener(this._handlePageConnection);chrome.tabs.onUpdated.addListener(this._handleTabUpdated);chrome.tabs.onRemoved.addListener(this._handleTabRemoved)}close(){chrome.runtime.onConnect.removeListener(this._handleContentPageConnection);chrome.runtime.onConnectExternal.removeListener(this._handlePageConnection);chrome.tabs.onUpdated.removeListener(this._handleTabUpdated);chrome.tabs.onRemoved.removeListener(this._handleTabRemoved);this._contentPageConnectionHandlers.length=0;this._pageConnectionHandlers.length=0;this._onPortDisconnectHandlers.length=0}getWatchedPorts(){return this._watchedPorts.map(wp=>wp.port)}addExternalConnectionHandler(handler){this._pageConnectionHandlers.push(handler)}addContentPageConnectionHandler(handler){this._contentPageConnectionHandlers.push(handler)}addOnDisconnectPortHandler(handler){this._onPortDisconnectHandlers.push(handler)}_handleContentPageConnection(port){this._callOnConnectedHandlers(this._contentPageConnectionHandlers,port)}_handlePageConnection(port){this._callOnConnectedHandlers(this._pageConnectionHandlers,port)}_handleTabRemoved(tabId,_removeInfo){var allwatchersFromTab=(0,Helpers_1.findAll)(this._watchedPorts,item=>item.tab.id===tabId);for(const watched of allwatchersFromTab){this._disconnectWatchedPort(watched)}}_handleTabUpdated(tabId,changeInfo,_tab){if(Tools_1.Tools.isNil(changeInfo)){return}if(changeInfo.status!=='complete'){return}var allwatchersFromTab=(0,Helpers_1.findAll)(this._watchedPorts,item=>item.tab.id===tabId&&item.timeout===INVALID_TIMEOUT_ID);for(const watcher of allwatchersFromTab){watcher.timeout=window.setTimeout(()=>{Logger_1.Logger.Log(`No ping received. Disconnecting: '${watcher.port.name}' on tab: ${watcher.tab.id}`);this._disconnectWatchedPort(watcher)},PING_REPLY_TIMEOUT_IN_MS);try{Logger_1.Logger.Log(`Sending ping to port: '${watcher.port.name}' on tab: ${watcher.tab.id}`);if(watcher.messageHandler){watcher.port.onMessage.addListener(watcher.messageHandler);watcher.port.postMessage(exports.PING_REQUEST)}}catch(e){Logger_1.Logger.Error(`Sending ping to port: '${watcher.port.name}' on tab: ${watcher.tab.id} failed. Error: ${e}`);this._disconnectWatchedPort(watcher)}}}_callOnConnectedHandlers(handlers,port){var _a,_b;var portName=(_a=port===null||port===void 0?void 0:port.name)!==null&&_a!==void 0?_a:'';if(portName.indexOf(this._portNamePrefix)!==0){return}var wrapper=new PortConnection(port,false);for(const handler of handlers){handler(wrapper)}if(!wrapper.handled){return}const senderTab=(_b=port.sender)===null||_b===void 0?void 0:_b.tab;if(Tools_1.Tools.isNil(senderTab)){return}port.onDisconnect.addListener(()=>this._onPortDisconnected(port));const portWatcher=new WatchedPort(wrapper.port,senderTab,INVALID_TIMEOUT_ID,null);portWatcher.messageHandler=this._onPortMessageReceived.bind(this,portWatcher);this._watchedPorts.push(portWatcher)}_onPortDisconnected(port){const watcher=(0,Helpers_1.findFirst)(this._watchedPorts,item=>item.port===port);if(Tools_1.Tools.isNil(watcher)){return}this._disconnectWatchedPort(watcher,false)}_disconnectWatchedPort(watched,fireDisconnect=true){if(watched.timeout!==INVALID_TIMEOUT_ID){clearTimeout(watched.timeout)}try{if(fireDisconnect){watched.port.disconnect()}}catch(e){Logger_1.Logger.Error(`Error disconnecting port: '${watched.port.name}' from tab: ${watched.tab.id}'`)}finally{this._notifyOnPortDisconnect(watched.port,watched.tab);this._watchedPorts=this._watchedPorts.filter(val=>val!==watched)}}_onPortMessageReceived(watcher,message){if(message!==exports.PING_RESPONSE){return}clearTimeout(watcher.timeout);if(watcher.messageHandler){watcher.port.onMessage.removeListener(watcher.messageHandler)}watcher.timeout=INVALID_TIMEOUT_ID;Logger_1.Logger.Log(`Got ping reply from port: '${watcher.port.name}' on tab: ${watcher.tab.id}`)}_notifyOnPortDisconnect(port,tab){Logger_1.Logger.Log(`Notify port disconnect: '${port.name}' on tab: ${tab.id}`);for(const handler of this._onPortDisconnectHandlers){try{handler(port,tab)}catch(e){Logger_1.Logger.Error(`Error executing OnPortDisconnect handler ${e}`)}}}}exports.ConnectionHandler=ConnectionHandler}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ExecuteScript_AdapterToMV3=void 0;const tslib_1=__webpack_require__(5);const ContentTarget_1=__webpack_require__(15);const Logger_1=__webpack_require__(4);const StringTools_1=__webpack_require__(7);const Tools_1=__webpack_require__(8);const BrowserTools_1=__webpack_require__(3);class ExecuteScript_AdapterToMV3{constructor(driverPackageManager,tabsMessageInterceptor,driverEvalService){this.logger=new Logger_1.ClassLogger(ExecuteScript_AdapterToMV3);this.nextProxyCallInterceptor=null;this.driverPackageManager=driverPackageManager;this.tabsMessageInterceptor=tabsMessageInterceptor;this.driverEvalService=driverEvalService;let chromeTabs=chrome.tabs;chromeTabs["executeScript"]=(tabId,details,onExecuteFinished)=>{this.Chrome_Tabs_ExecuteScript(tabId,details).then(result=>{if(!onExecuteFinished){return}if(result.success){if(chrome.runtime.lastError){this.logger.Log(this.Chrome_Tabs_ExecuteScript,"Deleting chrome.runtime.lastError:",chrome.runtime.lastError.message);delete chrome.runtime.lastError}return onExecuteFinished([result.data])}else{return BrowserTools_1.BrowserTools.WrapWithChromeLastError(result.errorMsg,onExecuteFinished)}})}}Chrome_Tabs_ExecuteScript(tabId,details){var _a,_b;return tslib_1.__awaiter(this,void 0,void 0,function*(){let codeToExecute=(_a=details.code)!==null&&_a!==void 0?_a:"";let frameId=(_b=details.frameId)!==null&&_b!==void 0?_b:0;let target=new ContentTarget_1.ContentTarget(tabId,frameId);if(this.IsDriverContentScript(codeToExecute)){return this.ExecuteDriverContentScript_Async(codeToExecute,target)}else if(this.IsCrossFrameOriginRequest(codeToExecute)){return this.HandleCrossFrameOriginRequest_Async(target)}else if(this.IsWindowNameRequest(codeToExecute)){return this.ExecuteDriverInlineCode_Async(2,target)}else if(this.IsTabAccessibleRequest(codeToExecute)){return this.ExecuteDriverInlineCode_Async(3,target)}else if(this.IsEnableLoggingRequest(codeToExecute)){return this.ExecuteDriverInlineCode_Async(4,target)}else{this.logger.Log(this.Chrome_Tabs_ExecuteScript,"Cannot inject details.code:",details.code);return{success:false,errorMsg:"Unhandled request"}}})}IsDriverContentScript(code){return code.endsWith(".js")}IsCrossFrameOriginRequest(code){return StringTools_1.StringTools.Contains(code,"g_globalContext.GetCrossOriginFrameInfo()")||StringTools_1.StringTools.Contains(code,"GetCrossOriginFrameInfo()")}IsWindowNameRequest(code){return(code==="window.name")}IsTabAccessibleRequest(code){return code===""}IsEnableLoggingRequest(code){return StringTools_1.StringTools.Contains(code,"EnableTracing()")}ExecuteDriverContentScript_Async(scriptToExecute,target){return tslib_1.__awaiter(this,void 0,void 0,function*(){let activeDriver=this.driverPackageManager.GetActiveDriver();if(!activeDriver){return{success:false,errorMsg:"Driver package is not active"}}if(scriptToExecute==="InjectAndRunJs.js"){let needsIntercept=yield this.IsInjectAndRunJsInterceptRequired_Async(activeDriver);if(needsIntercept){const driverCodeFlags=activeDriver.GetCodeFlags();this.InterceptNextProxyCallAndMessage(driverCodeFlags.hasProxyCall,(message,target,onResponseCb)=>{this.HandleDriverInjectJsRequest(message,target,onResponseCb)});return{success:true,data:null}}else{return activeDriver.ExecuteContentScript_Async(scriptToExecute,target)}}else if(this.nextProxyCallInterceptor&&(scriptToExecute==="ProxyCall.js")){let interceptorCb=this.nextProxyCallInterceptor;this.nextProxyCallInterceptor=null;return Tools_1.Tools.ToPromise(resolvePromiseCb=>{interceptorCb(target,()=>{resolvePromiseCb({success:true,data:null})})})}else{return activeDriver.ExecuteContentScript_Async(scriptToExecute,target)}})}IsInjectAndRunJsInterceptRequired_Async(activeDriver){return tslib_1.__awaiter(this,void 0,void 0,function*(){const driverCodeFlags=activeDriver.GetCodeFlags();if(driverCodeFlags.needsInjectJsAdapterToMV3){return true}return this.driverEvalService.IsEvalRestricted_Async()})}HandleCrossFrameOriginRequest_Async(target){let request={ChannelId:"Extension_RequestToContentPublic",RequestId:1};return Tools_1.Tools.ToPromise(resolvePromiseCb=>{chrome.tabs.sendMessage(target.TabId,request,{frameId:target.FrameId},responseUnknown=>{var _a;if(chrome.runtime.lastError){let errorMsg=(_a=chrome.runtime.lastError.message)!==null&&_a!==void 0?_a:"Unknown error";return resolvePromiseCb({success:false,errorMsg:errorMsg})}return resolvePromiseCb({success:true,data:responseUnknown})})})}ExecuteDriverInlineCode_Async(requestId,target){return tslib_1.__awaiter(this,void 0,void 0,function*(){let activeDriver=this.driverPackageManager.GetActiveDriver();if(!activeDriver){return{success:false,errorMsg:"Driver package is not active"}}return activeDriver.ExecuteContentInlineCode_Async(requestId,target)})}InterceptNextProxyCallAndMessage(hasProxyCall,messageHandlerCb){if(hasProxyCall){this.nextProxyCallInterceptor=(_target,onFinishedActionCb)=>{this.tabsMessageInterceptor.InterceptNextUnfilteredMessage(messageHandlerCb);return onFinishedActionCb()}}else{this.tabsMessageInterceptor.InterceptNextUnfilteredMessage(messageHandlerCb)}}HandleDriverInjectJsRequest(request,target,onCompletedCb){let activeDriver=this.driverPackageManager.GetActiveDriver();if(!activeDriver){return onCompletedCb===null||onCompletedCb===void 0?void 0:onCompletedCb(undefined)}let injectJsRequest=Tools_1.Tools.UnsafeCast(request);activeDriver.ExecuteInjectJs_Async(injectJsRequest,target).then(response=>{onCompletedCb===null||onCompletedCb===void 0?void 0:onCompletedCb(response)})}}exports.ExecuteScript_AdapterToMV3=ExecuteScript_AdapterToMV3}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.DriverEvalService=void 0;const tslib_1=__webpack_require__(5);const Tools_1=__webpack_require__(8);const Logger_1=__webpack_require__(4);const StringTools_1=__webpack_require__(7);const DriverEvalTemplate_1=__webpack_require__(39);const InjectAndRunJS_AdapterToMV3_1=__webpack_require__(17);const SapFiori_PageWorld_1=__webpack_require__(25);const SalesForce_PageWorld_1=__webpack_require__(24);const SapFiori_ExtensionWorld_1=__webpack_require__(40);const SalesForce_ExtensionWorld_1=__webpack_require__(41);class DriverEvalService{constructor(evalService){this.classLogger=new Logger_1.ClassLogger(DriverEvalService);this.evalService=evalService}EvalDriver_Async(codeData,interfaceToDriver){return tslib_1.__awaiter(this,void 0,void 0,function*(){let logger=new Logger_1.MethodLogger(this.classLogger,this.EvalDriver_Async);return logger.DoTimed_Async(()=>tslib_1.__awaiter(this,void 0,void 0,function*(){let backgroundAdapter=yield this.EvalDriverBackgroundCode_Async(codeData,interfaceToDriver);if(backgroundAdapter==null){this.classLogger.Error(this.EvalDriver_Async,"Failed to load Driver Background code");return null}let driverCodeFlags=this.GetDriverCodeFlags(codeData);let contentCode_ExtensionWorld=yield this.EvalDriverContentCode_ExtensionWorld_Async(codeData,driverCodeFlags);if(contentCode_ExtensionWorld==null){this.classLogger.Error(this.EvalDriver_Async,"Failed to load Driver Content_ExtensionWorld code");return null}let contentCode_PageWorld=yield this.GetDriverContentCode_PageWorld_Async(codeData.contentPageWorld,driverCodeFlags);if(contentCode_PageWorld==null){this.classLogger.Error(this.EvalDriver_Async,"Failed to load Driver Content_PageWorld code");return null}let backgroundDriverData={version:codeData.version.toString(),backgroundAdapter:backgroundAdapter,contentCode_ExtensionWorld:contentCode_ExtensionWorld,contentCode_PageWorld:contentCode_PageWorld,driverFlags:driverCodeFlags,injectJsCode:null};return backgroundDriverData}))})}EvalDriverBackgroundCode_Async(codeData,interfaceToDriver){return tslib_1.__awaiter(this,void 0,void 0,function*(){let logger=new Logger_1.MethodLogger(this.classLogger,this.EvalDriverBackgroundCode_Async);return logger.DoTimed_Async(()=>tslib_1.__awaiter(this,void 0,void 0,function*(){let backgroundCodeToEval=DriverEvalTemplate_1.DriverEvalTemplate.GetBackgroundCodeEvalWrapper(codeData.background);this.classLogger.Log(this.EvalDriverBackgroundCode_Async,"backgroundCodeToEval.length: ",backgroundCodeToEval.length);let evalResult=yield this.evalService.EvalFunctionInBackgroundPage_Async(backgroundCodeToEval);if(!evalResult.success){this.classLogger.Error(this.EvalDriverBackgroundCode_Async,"Failed to eval backgroundCode; errorMsg: ",evalResult.errorMessage);return null}let getContentScriptFunc=scriptName=>{return{code:scriptName}};let getDriverAdapterFunc=Tools_1.Tools.UnsafeCast(evalResult.evalFunc());return getDriverAdapterFunc(getContentScriptFunc,codeData,interfaceToDriver.nativeHost,interfaceToDriver)}))})}EvalDriverContentCode_ExtensionWorld_Async(codeData,driverCodeFlags){return tslib_1.__awaiter(this,void 0,void 0,function*(){let logger=new Logger_1.MethodLogger(this.classLogger,this.EvalDriverContentCode_ExtensionWorld_Async);return logger.DoTimed_Async(()=>tslib_1.__awaiter(this,void 0,void 0,function*(){let logger=new Logger_1.MethodLogger(this.classLogger,this.EvalDriverBackgroundCode_Async);let contentCodeToEval=this.GetContentCodeToEval(codeData,driverCodeFlags);logger.Log("contentCodeToEval.length:",contentCodeToEval.length);let evalResult=yield this.evalService.EvalFunctionInBackgroundPage_Async(contentCodeToEval);if(!evalResult.success){logger.Error("Failed to eval contentCode; errorMsg:",evalResult.errorMessage);return null}return evalResult.evalFunc}))})}GetDriverContentCode_PageWorld_Async(pageWorldCode,driverCodeFlags){return tslib_1.__awaiter(this,void 0,void 0,function*(){if(pageWorldCode==null){let pageWorldInjectedFunctions=[];if(driverCodeFlags.needsSapFioriAdapterToMV3){pageWorldInjectedFunctions.push(SapFiori_PageWorld_1.SapFiori_PageWorld_InjectedFunc)}if(driverCodeFlags.needsSalesForceAdapterToMV3){pageWorldInjectedFunctions.push(SalesForce_PageWorld_1.SalesForce_PageWorld_InjectedFunc)}return pageWorldInjectedFunctions}else{let evalResult=yield this.evalService.EvalFunctionInBackgroundPage_Async(pageWorldCode);if(!evalResult.success){return null}return[Tools_1.Tools.UnsafeCast(evalResult.evalFunc)]}})}EvalInjectJsCode_Async(codeToEval){let injectJsEvalWrapper=(0,InjectAndRunJS_AdapterToMV3_1.Get_InjectJs_EvalWrapper)(codeToEval);this.classLogger.Log(this.EvalInjectJsCode_Async,"injectJsEvalWrapper.length:",injectJsEvalWrapper.length);return this.evalService.EvalFunctionInBackgroundPage_Async(injectJsEvalWrapper)}GetContentCodeToEval(codeData,driverCodeFlags){let contentCode=this.GetMergedContentCode(codeData,driverCodeFlags);return DriverEvalTemplate_1.DriverEvalTemplate.GetContentCodeEvalWrapper(codeData.version.toString(),contentCode)}GetMergedContentCode(codeData,driverCodeFlags){let mergedContentCode=codeData.content;let requestsCode=this.GetDriverContentRequestsCode(codeData);if(requestsCode.length!==0){mergedContentCode=this.MergeCodeWithSeparator(mergedContentCode,requestsCode)}let adapterCode=this.GetDriverContentAdapterCode(driverCodeFlags);if(adapterCode.length!==0){mergedContentCode=this.MergeCodeWithSeparator(mergedContentCode,adapterCode)}let logger=new Logger_1.MethodLogger(this.classLogger,this.GetMergedContentCode);logger.Log("codeData.content.length:",codeData.content.length);logger.Log("requestsCode.length:",requestsCode.length);logger.Log("adapterCode.length:",adapterCode.length);logger.Log("mergedContentCode.length:",mergedContentCode.length);return mergedContentCode}GetDriverContentRequestsCode(codeData){const contentScriptNames=[];const requestsMap=Tools_1.Tools.UnsafeCast(codeData);const objKeys=Object.getOwnPropertyNames(requestsMap);for(const key of objKeys){if(key.endsWith(".js")){contentScriptNames.push(key)}}let requestsCode="";for(let scriptName of contentScriptNames){let scriptCode=requestsMap[scriptName];if(Tools_1.Tools.isNil(scriptCode)){continue}let scriptEvalWrapper=DriverEvalTemplate_1.DriverEvalTemplate.GetContentScriptEvalWrapper(scriptName,scriptCode);requestsCode=this.MergeCodeWithSeparator(requestsCode,scriptEvalWrapper)}return requestsCode}GetDriverContentAdapterCode(driverCodeFlags){let adapterCode="";if(driverCodeFlags.needsSapFioriAdapterToMV3){let sapFioriAdapter=StringTools_1.StringTools.GetFunctionBody(SapFiori_ExtensionWorld_1.SapFiori_ExtensionWorld_Adapter);adapterCode=this.MergeCodeWithSeparator(adapterCode,sapFioriAdapter)}if(driverCodeFlags.needsSalesForceAdapterToMV3){let salesForceAdapter=StringTools_1.StringTools.GetFunctionBody(SalesForce_ExtensionWorld_1.SalesForce_ExtensionWorld_Adapter);adapterCode=this.MergeCodeWithSeparator(adapterCode,salesForceAdapter)}return adapterCode}MergeCodeWithSeparator(code,valueToAppend){if(code.length!==0){code+=";"}code+=valueToAppend;return code}GetDriverCodeFlags(codeData){let logger=new Logger_1.MethodLogger(this.classLogger,this.GetDriverCodeFlags);return logger.DoTimed(()=>{var _a,_b,_c;let hasSupportForMV3=(_a=codeData.hasSupportForMV3)!==null&&_a!==void 0?_a:false;let needsInjectJsAdapterToMV3=false;let needsToBeLoadedInAllTabsOnActivate=(_b=codeData.needsToBeLoadedInAllTabs)!==null&&_b!==void 0?_b:false;let hasProxyCall=!Tools_1.Tools.isNil(codeData["ProxyCall.js"]);let needsSapFioriAdapterToMV3=false;let needsSalesForceAdapterToMV3=false;let has_InjectJs_Fix_For_IsScriptErr=false;if(!hasSupportForMV3){let hasEventMonitor=StringTools_1.StringTools.Contains(codeData.content,"g_eventMonitor = UiEventMonitor()");needsToBeLoadedInAllTabsOnActivate=hasEventMonitor;needsSapFioriAdapterToMV3=StringTools_1.StringTools.Contains(codeData.content,"g_sapFioriDefines");needsSalesForceAdapterToMV3=needsSapFioriAdapterToMV3&&StringTools_1.StringTools.Contains(codeData.content,"g_salesForceDefines");const injectJsCode=codeData["InjectAndRunJs.js"];const fixForIsScriptErrMarker="return { isErr: false, result: _r == null ? _r : _r.toString() };";needsInjectJsAdapterToMV3=true;has_InjectJs_Fix_For_IsScriptErr=(_c=injectJsCode===null||injectJsCode===void 0?void 0:injectJsCode.includes(fixForIsScriptErrMarker))!==null&&_c!==void 0?_c:false}return{needsInjectJsAdapterToMV3:needsInjectJsAdapterToMV3,has_InjectJs_Fix_For_IsScriptErr:has_InjectJs_Fix_For_IsScriptErr,needsToBeLoadedInAllTabsOnActivate:needsToBeLoadedInAllTabsOnActivate,hasProxyCall:hasProxyCall,needsSapFioriAdapterToMV3:needsSapFioriAdapterToMV3,needsSalesForceAdapterToMV3:needsSalesForceAdapterToMV3,hasSupportForMV3:hasSupportForMV3}})}IsEvalRestricted_Async(){return this.evalService.IsEvalRestricted_Async()}}exports.DriverEvalService=DriverEvalService}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.DriverEvalTemplate=void 0;const StringTools_1=__webpack_require__(7);var DriverEvalTemplate;(function(DriverEvalTemplate){function GetBackgroundCodeEvalWrapper(codeToEval){let g_globalContext=undefined;let g_functionCallMap=undefined;let functionTemplate=function(){return function(getFileCodeObject,g_codeMap,g_nativeMsgComm,__extensionToDriver){let __adapter=undefined;let RegisterBackgroundDriverAdapter=adapter=>{__adapter=adapter;return __extensionToDriver};getFileCodeObject;g_codeMap;g_nativeMsgComm;let IsChromeTabUrl=function(url){if(url&&url.indexOf("chrome://")===0){return true}return false};codeToEval;if(!__adapter){let __functionCallMap=(typeof g_functionCallMap!=="undefined")?g_functionCallMap:{};let __globalContext=(typeof g_globalContext!=="undefined")?g_globalContext:null;let __getDriverHookAndClear=hookName=>{let hookFunc=null;if(chrome[hookName]){hookFunc=chrome[hookName];delete chrome[hookName]}return hookFunc};let __initImpl=__getDriverHookAndClear("InitializeBackgroundImpl");let __postContentInitImpl=__getDriverHookAndClear("PostContentInitializeImpl");let __finalizeImpl=__getDriverHookAndClear("FinalizeBackgroundImpl");__adapter={ProcessRequest:(message,onCompletedCb)=>{let handler=__functionCallMap[message.functionCall];if(!handler){return onCompletedCb(undefined)}else{return handler(message,onCompletedCb)}},OnTabFrameConnected:(_tabId,_frameId)=>{},InitializeBackground:()=>{__initImpl===null||__initImpl===void 0?void 0:__initImpl()},PostContentInitialize:()=>{__postContentInitImpl===null||__postContentInitImpl===void 0?void 0:__postContentInitImpl()},FinalizeBackground:()=>{__finalizeImpl===null||__finalizeImpl===void 0?void 0:__finalizeImpl()},GetGlobalContext:()=>{return __globalContext},EnableTracing:()=>{if(__globalContext){__globalContext.EnableTracing()}},DisableTracing:()=>{if(__globalContext){__globalContext.DisableTracing()}}}}return __adapter}};let template=StringTools_1.StringTools.GetFunctionBody(functionTemplate);let evalWrapper=StringTools_1.StringTools.SafeReplaceString(template,"codeToEval",codeToEval);return evalWrapper}DriverEvalTemplate.GetBackgroundCodeEvalWrapper=GetBackgroundCodeEvalWrapper;function GetContentCodeEvalWrapper(driverVersion,codeToEval){let g_globalContext=undefined;let g_isCustomCacheInitialized=undefined;let g_customIdCache=undefined;let g_crtCustomIdValue=undefined;let g_traceEnabled=undefined;let GetCrossOriginFrameInfo=undefined;let functionTemplate=function(){let __driverVersionBuildNumber="#driverVersion";let __driverRequestMap={};let __driverAdapter=undefined;let RegisterContentDriverAdapter=function(adapter){__driverAdapter=adapter};codeToEval;if(!__driverAdapter){let __globalContext=(typeof g_globalContext!=="undefined")?g_globalContext:null;let __driverInlineRequests={GetCrossFrameOriginInfo:function(){var _a;if(__globalContext){return(_a=__globalContext.GetCrossOriginFrameInfo)===null||_a===void 0?void 0:_a.call(__globalContext)}else if(typeof GetCrossOriginFrameInfo!=="undefined"){return GetCrossOriginFrameInfo()}return undefined},GetWindowName:function(){return window.name},IsTabAccessible:function(){return true},EnableTracing:function(){__driverAdapter===null||__driverAdapter===void 0?void 0:__driverAdapter.SetTracingEnabled(true)}};let __getDriverHookAndClear=hookName=>{let hook=null;if(chrome[hookName]){hook=chrome[hookName];delete chrome[hookName]}return hook};let __windowDriverKeys={plainHtmlContentWalker:"PlainHtmlContentWalker",sapFioriContentWalker:"SapFioriContentWalker"};let __windowDriverFunctions={plainHtmlContentWalker:window[__windowDriverKeys.plainHtmlContentWalker],sapFioriContentWalker:window[__windowDriverKeys.sapFioriContentWalker]};let __initContentImpl=__getDriverHookAndClear("InitializeContentImpl");let __finalizeContentImpl=__getDriverHookAndClear("FinalizeContentImpl");let adaptorMV2={InjectJsRequests:null,AdapterType:0,Activate:function(tab){if(__initContentImpl){__initContentImpl(tab)}if(__windowDriverFunctions.plainHtmlContentWalker){window[__windowDriverKeys.plainHtmlContentWalker]=__windowDriverFunctions.plainHtmlContentWalker}if(__windowDriverFunctions.sapFioriContentWalker){window[__windowDriverKeys.sapFioriContentWalker]=__windowDriverFunctions.sapFioriContentWalker}},Deactivate:function(tab){if(__finalizeContentImpl){__finalizeContentImpl(tab)}},ExecuteRequest:function(_request,_sender,sendResponse){sendResponse(undefined);return false},GetDriverRequestMap:function(){return __driverRequestMap},GetDriverInlineRequests:function(){return __driverInlineRequests},GetSharedState:function(){let isCustomCacheInitialized=(typeof g_isCustomCacheInitialized!=="undefined")?g_isCustomCacheInitialized:false;let customIdCacheData=null;if(__globalContext){customIdCacheData={IsCustomIdCachedInitialized:isCustomCacheInitialized,CustomIdCache:__globalContext.g_customIdCache,CustomIdValue:__globalContext.g_crtCustomIdValue}}else{customIdCacheData={IsCustomIdCachedInitialized:isCustomCacheInitialized,CustomIdCache:(typeof g_customIdCache!=="undefined")?g_customIdCache:{},CustomIdValue:(typeof g_crtCustomIdValue!=="undefined")?g_crtCustomIdValue:0}}return{ElementCacheData:customIdCacheData}},SetSharedState:function(value){let customIdCacheData=value===null||value===void 0?void 0:value.ElementCacheData;if(!customIdCacheData){return}if(__globalContext){__globalContext.g_customIdCache=customIdCacheData.CustomIdCache;__globalContext.g_crtCustomIdValue=customIdCacheData.CustomIdValue}if(typeof g_isCustomCacheInitialized!=="undefined"){g_isCustomCacheInitialized=customIdCacheData.IsCustomIdCachedInitialized}if(typeof g_customIdCache!=="undefined"){g_customIdCache=customIdCacheData.CustomIdCache}if(typeof g_crtCustomIdValue!=="undefined"){g_crtCustomIdValue=customIdCacheData.CustomIdValue}},GetGlobalContext:function(){if(__globalContext){return __globalContext}return null},SetTracingEnabled:function(value){if(__globalContext){__globalContext.g_traceEnabled=value}else if(typeof g_traceEnabled!=="undefined"){g_traceEnabled=value}}};__driverAdapter=adaptorMV2}let __driverContentGlobalsKey="__uiPathContent";let __driverContentGlobals=window[__driverContentGlobalsKey];if(!__driverContentGlobals){__driverContentGlobals={};window[__driverContentGlobalsKey]=__driverContentGlobals}__driverContentGlobals[__driverVersionBuildNumber]=__driverAdapter;try{console.log("Loaded Driver package version: "+__driverVersionBuildNumber)}catch(ex){}};let template=StringTools_1.StringTools.GetFunctionBody(functionTemplate);let evalWrapper=StringTools_1.StringTools.SafeReplaceString(template,"#driverVersion",driverVersion);evalWrapper=StringTools_1.StringTools.SafeReplaceString(evalWrapper,"codeToEval",codeToEval);return evalWrapper}DriverEvalTemplate.GetContentCodeEvalWrapper=GetContentCodeEvalWrapper;function GetContentScriptEvalWrapper(scriptName,codeToEval){let __driverRequestMap={};let functionTemplate=function(){__driverRequestMap["#scriptName"]=function(){codeToEval}};let template=StringTools_1.StringTools.GetFunctionBody(functionTemplate);let evalWrapper=StringTools_1.StringTools.SafeReplaceString(template,"#scriptName",scriptName);evalWrapper=StringTools_1.StringTools.SafeReplaceString(evalWrapper,"codeToEval",codeToEval);return evalWrapper}DriverEvalTemplate.GetContentScriptEvalWrapper=GetContentScriptEvalWrapper})(DriverEvalTemplate=exports.DriverEvalTemplate||(exports.DriverEvalTemplate={}))}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.SapFiori_ExtensionWorld_Adapter=void 0;function SapFiori_ExtensionWorld_Adapter(__driverVersionBuildNumber){(function(){function TraceMessage(msg){if(g_globalContext){g_globalContext.TraceMessage(msg)}}function TraceError(msg){if(g_globalContext){g_globalContext.TraceError(msg)}}class PageWorldClient{constructor(config){this.config=config}SendRequest(element,request){let elementDoc=Tools.GetDocumentForElement(element);let response=null;let eventListener=evt=>{response=this.GetResponseEventParam(elementDoc);if(!response){return}evt.stopImmediatePropagation()};let event=new CustomEvent(this.config.requestEventName);this.SetRequestEventParam(elementDoc,request);elementDoc.addEventListener(this.config.responseEventName,eventListener);elementDoc.dispatchEvent(event);elementDoc.removeEventListener(this.config.responseEventName,eventListener);this.ClearRequestEventParam(elementDoc);return response}SetRequestEventParam(elementDoc,request){elementDoc.documentElement.setAttribute(this.config.requestParamAttrName,JSON.stringify(request))}ClearRequestEventParam(elementDoc){elementDoc.documentElement.removeAttribute(this.config.requestParamAttrName)}GetResponseEventParam(elementDoc){let responseJson=elementDoc.documentElement.getAttribute(this.config.responseParamAttrName);if(!responseJson){return null}let response=JSON.parse(responseJson);return response}}class Tools{static GetPlainHtmlIdFromCustomId(customId){var separatorPos=customId?customId.indexOf(Tools.VIRTUAL_ID_SEPARATOR):-1;if(separatorPos>0){return customId.substring(0,separatorPos)}return customId}static GetDocumentForElement(element){return element.ownerDocument||document}static SetDocumentAttributeMarker(element,attributePrefix,driverVersion){let doc=Tools.GetDocumentForElement(element);let markerWithVersion=attributePrefix+driverVersion;doc.documentElement.setAttribute(markerWithVersion,driverVersion)}static HasDocumentAttributeMarker(element,attributePrefix,driverVersion){let doc=Tools.GetDocumentForElement(element);let markerWithVersion=attributePrefix+driverVersion;let attributeValue=doc.documentElement.getAttribute(markerWithVersion);if(attributeValue==null){return false}return(attributeValue===driverVersion)}}Tools.VIRTUAL_ID_SEPARATOR=">";class SapFioriPageWorldClient{constructor(version,sapFioriDefines){TraceMessage("[SapFioriPageWorldClient] version: "+version);this.version=version;this.sapFioriDefines=sapFioriDefines;let config={requestEventName:"__UiPath_SapFiori_Request_"+this.version,responseEventName:"__UiPath_SapFiori_Response_"+this.version,requestParamAttrName:"data-UiPath_SapFiori_Request_Attr_"+this.version,responseParamAttrName:"data-UiPath_SapFiori_Response_Attr_"+this.version};this.pageWorldClient=new PageWorldClient(config)}GetSapFioriDefines(){return this.sapFioriDefines}IsSapFioriPageContentInitialized(element){return Tools.HasDocumentAttributeMarker(element,this.sapFioriDefines.pageContextInitFlagAttrName,this.version)}IsSapFioriFramework(element){var doc=element.ownerDocument||document;var hasSapUiBrowserAttr=doc.documentElement.hasAttribute("data-sap-ui-browser");if(hasSapUiBrowserAttr===false){return false}return this.IsSapFioriAvailable(element)}EnsureSapFioriPageContentIsInitialized(element){if(this.IsSapFioriPageContentInitialized(element)){return true}if(this.IsSapFioriFramework(element)){return this.InitializePageWorld(element)}return false}InitializePageWorld(element){TraceMessage("[InitializePageWorld] version: "+this.version);let initSuccesfully=this.InitPageContent(element);if(initSuccesfully){Tools.SetDocumentAttributeMarker(element,this.sapFioriDefines.pageContextInitFlagAttrName,this.version);TraceMessage("[InitializePageContent] SAP Fiori initialized in PageWorld with version: "+this.version)}else{TraceError("[InitializePageWorld] Failed to initialize SAP Fiori in PageWorld")}return initSuccesfully}InitPageContent(element){return this.SendRequest(element,1,"",false)}IsSapFioriAvailable(element){return this.SendRequest(element,2,"",false)}SendElementRequest(element,requestId,defaultReturnValue){if(!element){return defaultReturnValue}let requestData={htmlId:element.id};return this.SendElementRequestCustom(element,requestData,requestId,defaultReturnValue)}SendElementRequestCustom(element,requestData,requestId,defaultReturnValue){if(!this.EnsureSapFioriPageContentIsInitialized(element)){return defaultReturnValue}return this.SendRequest(element,requestId,requestData,defaultReturnValue)}SendRequest(element,requestId,requestData,defaultReturnValue){let request={requestId:requestId,data:requestData};let response=this.pageWorldClient.SendRequest(element,request);if((response===null||response===void 0?void 0:response.result)==null){return defaultReturnValue}return response.result}}WrapInGlobalContext(function(){let gcontext=this;let gcontext_v21_10=gcontext;let gcontext_v22_2=gcontext;const sapFioriDefines={propertyBasedAttrPrefix:"ui5p-",staticAttrPrefix:"ui5-",SAP_FIORI_CUSTOM_ID_ATTR_NAME:"data-"+gcontext.CUSTOM_ID_ATTR_NAME,pageContextInitFlagAttrName:"__uipath_sap_fiori_initialized_"};const sapFioriClient=new SapFioriPageWorldClient(__driverVersionBuildNumber,sapFioriDefines);let sapFioriService=gcontext;sapFioriService.g_sapFioriDefines=sapFioriDefines;sapFioriService.InitializePageContent=function(element){if(!element){return false}return sapFioriClient.InitializePageWorld(element)};sapFioriService.IsSapFioriPageContentInitialized=function(element){if(!element){return false}return sapFioriClient.IsSapFioriPageContentInitialized(element)};sapFioriService.EnsureSapFioriPageContentIsInitialized=function(element){if(!element){return false}return sapFioriClient.EnsureSapFioriPageContentIsInitialized(element)};sapFioriService.GetResultOrDefault=function(response,defaultResult){if(response.result!=null){return response.result}return defaultResult};sapFioriService.IsSapFioriFramework=function(element){if(!element){return false}return sapFioriClient.IsSapFioriFramework(element)};sapFioriService.IsSapFioriElement=function(element){if(!element){return false}if(!element.hasAttribute("data-sap-ui")&&!element.hasAttribute("data-sap-ui-preserve")){return false}return sapFioriClient.SendElementRequest(element,3,false)};sapFioriService.HtmlElementFromSapElementResult=function(result){var _a;if(result.customId){return(_a=gcontext.GetElementFromCustomId(result.customId))!==null&&_a!==void 0?_a:null}else if(result.htmlId){return document.getElementById(result.htmlId)}return null};sapFioriService.GetSapFioriElement=function(element){if(!element){return null}var customId=gcontext.GenerateCustomIdForElement(element);var plainHtmlId=Tools.GetPlainHtmlIdFromCustomId(customId);let request={elementTag:element.tagName,customId:plainHtmlId,customIdAttributeName:gcontext.CUSTOM_ID_ATTR_NAME};let response=sapFioriClient.SendElementRequestCustom(element,request,4,{});return sapFioriService.HtmlElementFromSapElementResult(response)};sapFioriService.GetSapFioriAttributeNames=function(element){var sapFioriStaticAttrNames=sapFioriService.GetSapFioriStaticAttributeNames();var sapFioriDynamicAttrNames=sapFioriService.GetSapFioriDynamicAttributeNames(element);var sapFioriAttrNames=sapFioriStaticAttrNames.concat(sapFioriDynamicAttrNames);return sapFioriAttrNames};sapFioriService.GetSapFioriStaticAttributeNames=function(){var sapStaticAttrNames=["ui5-label","ui5-tooltip","ui5-role","ui5-type","ui5-class"];return sapStaticAttrNames};sapFioriService.GetSapFioriDynamicAttributeNames=function(element){return sapFioriClient.SendElementRequest(element,5,[])};sapFioriService.GetSapFioriSelectorAttributeNames=function(element){if(!element){return[]}let sapDynamicAttributes=sapFioriClient.SendElementRequest(element,6,[]);var sapSelectorAttributes=sapFioriService.GetSapFioriStaticAttributeNames();if(gcontext.ElementIsFrame(element)){sapSelectorAttributes.push("name");sapSelectorAttributes.push("src")}for(var i=0;i<sapDynamicAttributes.length;++i){sapSelectorAttributes.push(sapDynamicAttributes[i])}return sapSelectorAttributes};sapFioriService.GetSapFioriSelectorFixedAttributes=function(element){return sapFioriClient.SendElementRequest(element,7,{})};sapFioriService.GetSapVirtualId=function(element){return sapFioriClient.SendElementRequest(element,8,null)};sapFioriService.BringIntoViewSapVirtualId=function(element,virtualId){if(!element){return null}let requestData={htmlId:element.id,virtualId:virtualId};return sapFioriClient.SendElementRequestCustom(element,requestData,9,null)};sapFioriService.GetSapId=function(element){return sapFioriClient.SendElementRequest(element,10,"")};sapFioriService.GetSapClass=function(element){return sapFioriClient.SendElementRequest(element,11,"")};sapFioriService.GetSapRole=function(element){return sapFioriClient.SendElementRequest(element,12,"")};sapFioriService.GetSapType=function(element){return sapFioriClient.SendElementRequest(element,13,"")};sapFioriService.GetSapLabel=function(element){return sapFioriClient.SendElementRequest(element,14,"")};sapFioriService.GetSapTooltip=function(element){return sapFioriClient.SendElementRequest(element,15,"")};sapFioriService.GetSapIsEmpty=function(element){return sapFioriClient.SendElementRequest(element,16,"")};sapFioriService.GetSapTableRowIndex=function(element){return sapFioriClient.SendElementRequest(element,17,"")};sapFioriService.GetSapTableColIndex=function(element){return sapFioriClient.SendElementRequest(element,18,"")};sapFioriService.GetSapColLabel=function(element){return sapFioriClient.SendElementRequest(element,19,"")};sapFioriService.GetSapAllColLabels=function(element){return sapFioriClient.SendElementRequest(element,20,[])};sapFioriService.GetSapReadyState=function(element){const readyStateDefault="1";return sapFioriClient.SendElementRequest(element,21,readyStateDefault)};sapFioriService.GetSapPropertyBasedAttribute=function(element,attrName){if(!element){return""}let requestData={htmlId:element.id,attrName:attrName};return sapFioriClient.SendElementRequestCustom(element,requestData,22,"")};sapFioriService.IsStableSapId=function(element){return sapFioriClient.SendElementRequest(element,23,false)};sapFioriService.DoesMapContainSapFioriAttributes=function(attrMap){let sapStaticAttrPrefix=sapFioriDefines.staticAttrPrefix;let sapPropAttrPrefix=sapFioriDefines.propertyBasedAttrPrefix;for(let attrName in attrMap){if((attrName.slice(0,sapStaticAttrPrefix.length)===sapStaticAttrPrefix)||(attrName.slice(0,sapPropAttrPrefix.length)===sapPropAttrPrefix)){return true}}return false};sapFioriService.GetSapFioriCssSelector=function(parentId,getAllDescendants,cssSelector){var out_sapFioriCssSelector=null;if((getAllDescendants===1)||cssSelector){if(cssSelector!=null){out_sapFioriCssSelector=cssSelector+"[data-sap-ui],"+cssSelector+"[data-sap-ui-preserve]"}else{out_sapFioriCssSelector="[data-sap-ui], [data-sap-ui-preserve]"}}else if(parentId!=null){out_sapFioriCssSelector="["+gcontext.CUSTOM_ID_ATTR_NAME+"=\""+parentId+"\"] > [data-sap-ui],"+"["+gcontext.CUSTOM_ID_ATTR_NAME+"=\""+parentId+"\"] > [data-sap-ui-preserve],"+"["+sapFioriDefines.SAP_FIORI_CUSTOM_ID_ATTR_NAME+"=\""+parentId+"\"] > [data-sap-ui],"+"["+sapFioriDefines.SAP_FIORI_CUSTOM_ID_ATTR_NAME+"=\""+parentId+"\"] > [data-sap-ui-preserve]"}return out_sapFioriCssSelector};sapFioriService.GetSapFioriHtmlCollectionForParentId=function(rootDocument,parentId,tagName,getAllDescendants,cssSelector,isShadowDom){var getAllDocuments=gcontext.xbrowser.isModeSingleFrame();var sapFioriCssSelector=sapFioriService.GetSapFioriCssSelector(parentId,getAllDescendants,cssSelector);if(gcontext_v22_2.CollectionFilter){let filter=new gcontext_v22_2.CollectionFilter(tagName!==null&&tagName!==void 0?tagName:"",sapFioriCssSelector,isShadowDom,null);return gcontext_v22_2.GetHtmlCollectionForParentId(rootDocument,getAllDocuments,parentId,filter)}else{return gcontext.GetHtmlCollectionForParentId(rootDocument,getAllDocuments,parentId,tagName,sapFioriCssSelector,isShadowDom)}};sapFioriService.GetSapFioriHtmlCollectionWithTableFiltering=function(rootDocument,parentId,tagName,tableAttrs,getAllDescendants,cssSelector,isShadowDom){var getAllDocuments=gcontext.xbrowser.isModeSingleFrame();var sapFioriCssSelector=sapFioriService.GetSapFioriCssSelector(parentId,getAllDescendants,cssSelector);let htmlCollection=[];if(gcontext_v21_10.GetHtmlCollectionFuzzyWithTableFiltering){htmlCollection=gcontext_v21_10.GetHtmlCollectionFuzzyWithTableFiltering(rootDocument,getAllDocuments,parentId,tagName,tableAttrs,sapFioriCssSelector,isShadowDom)}return htmlCollection};sapFioriService.GetSapFioriSelectorAttributeList=function(rootDocument,element,customId,parentId,_tagName,computeIndex,ensureUniqueMatchingIndex){let errorResult=gcontext.GetSelectorAttributeListResult("",{},-1,0);if(!element){return errorResult}var htmlCollection=sapFioriService.GetSapFioriHtmlCollectionForParentId(rootDocument,parentId,null,1,null,false);var bestIndex=(computeIndex==0)?0:1000000;var selectorAttrMap={};var fixedAttributes=sapFioriService.GetSapFioriSelectorFixedAttributes(element);gcontext.TraceMessage("GetSapFioriSelectorAttributeList: Fixed attributes: "+gcontext.EnumObjectProps(fixedAttributes,false));var fixedAttributesCount=0;for(var fixedAttrName in fixedAttributes){var fixedAttrValue=fixedAttributes[fixedAttrName];selectorAttrMap[fixedAttrName]=new gcontext.AttributeValue(fixedAttrValue);fixedAttributesCount++}if(computeIndex>0&&fixedAttributesCount>0){if(!htmlCollection){return errorResult}bestIndex=gcontext.GetIndexForAttributeList(htmlCollection,customId,selectorAttrMap,ensureUniqueMatchingIndex);if(bestIndex<0){gcontext.TraceMessage("GetSapFioriSelectorAttributeList: index == -1, return error");return errorResult}else if(bestIndex===0){gcontext.TraceMessage("GetSapFioriSelectorAttributeList: index == 0 with fixed attributes alone, return success");return gcontext.GetSelectorAttributeListResult("",selectorAttrMap,0,1)}}var isElementIdStable=sapFioriService.IsStableSapId(element);var attrLists=[];if(isElementIdStable){attrLists=["id"]}else{attrLists=sapFioriService.GetSapFioriSelectorAttributeNames(element)}if((attrLists.length==0)&&computeIndex!=0&&fixedAttributesCount==0){if(!htmlCollection){return errorResult}bestIndex=gcontext.GetIndexForAttributeList(htmlCollection,customId,selectorAttrMap,ensureUniqueMatchingIndex);if(bestIndex===-1){gcontext.TraceMessage("GetSapFioriSelectorAttributeList: index == -1, return error");return errorResult}}for(var phaseIdx=0;phaseIdx<attrLists.length;++phaseIdx){var crntAttrName=attrLists[phaseIdx];var crntAttrValue=null;if(crntAttrName!=="id"){crntAttrValue=gcontext.GetTruncatedAttributeValue(element,crntAttrName)}else{crntAttrValue=gcontext.GetAttributeValue(element,crntAttrName)}if(!crntAttrValue){continue}selectorAttrMap[crntAttrName]=new gcontext.AttributeValue(crntAttrValue);if(computeIndex>0){if(!htmlCollection){return errorResult}var crntIndex=gcontext.GetIndexForAttributeList(htmlCollection,customId,selectorAttrMap,ensureUniqueMatchingIndex);if(crntIndex===-1){gcontext.TraceMessage("GetSapFioriSelectorAttributeList: index == -1, return error");return errorResult}if(crntIndex<bestIndex){bestIndex=crntIndex}else{delete selectorAttrMap[crntAttrName]}if(bestIndex===0){gcontext.TraceMessage("GetSapFioriSelectorAttributeList: index == 0, return success");return gcontext.GetSelectorAttributeListResult("",selectorAttrMap,0,1)}}}return gcontext.GetSelectorAttributeListResult("",selectorAttrMap,bestIndex,1)};sapFioriService.GetNextSapFioriInterestingParentForSelector=function(element){let response=sapFioriClient.SendElementRequest(element,24,{});return sapFioriService.HtmlElementFromSapElementResult(response)};sapFioriService.SapFioriAddHtmlDomAttribute=function(element,attrName,attrValue){if(!element){return false}let request={htmlId:element.id,attrName:attrName,attrValue:attrValue};return sapFioriClient.SendElementRequestCustom(element,request,25,false)};sapFioriService.SapFioriWriteText=function(element,text,append){if(!element){return false}let request={htmlId:element.id,text:text,append:(append===1)};return sapFioriClient.SendElementRequestCustom(element,request,26,false)};sapFioriService.SapFioriClick=function(element){return sapFioriClient.SendElementRequest(element,27,false)};sapFioriService.SapFioriGetSelectedItems=function(element,getAll){if(!element){return[]}let request={htmlId:element.id,getAll:getAll};return sapFioriClient.SendElementRequestCustom(element,request,28,[])};sapFioriService.SapFioriSelectItems=function(element,reset,selectIfDisabled,items){if(!element){return 0}let request={htmlId:element.id,reset:reset,selectIfDisabled:selectIfDisabled,items:items};return sapFioriClient.SendElementRequestCustom(element,request,29,0)};sapFioriService.SapFioriGetChecked=function(element){return sapFioriClient.SendElementRequest(element,30,false)};sapFioriService.SapFioriCheck=function(element,doCheck){if(!element){return 0}let request={htmlId:element.id,doCheck:(doCheck===1)};let isCheckable=sapFioriClient.SendElementRequestCustom(element,request,31,false);return isCheckable?1:0};sapFioriService.SapFioriIsElementCheckable=function(element){return sapFioriClient.SendElementRequest(element,32,false)};sapFioriService.SapFioriIsElementSelectable=function(element){return sapFioriClient.SendElementRequest(element,33,false)};sapFioriService.SapFioriSetFocus=function(element){return sapFioriClient.SendElementRequest(element,34,false)};sapFioriService.HasSapFioriContentWalker=function(element){return sapFioriClient.SendElementRequest(element,35,false)};sapFioriService.SapFioriContentWalkerInitialize=function(element,hints,repeatRequest){if(!element){return null}let requestData={htmlId:element.id,hints:hints,repeatRequest:repeatRequest};return sapFioriClient.SendElementRequestCustom(element,requestData,36,null)};sapFioriService.SapFioriContentWalkerFetchNext=function(element){return sapFioriClient.SendElementRequest(element,37,null)};if(gcontext.g_getCustomAttrMap){let extraSapFioriAttrMap={};extraSapFioriAttrMap["ui5-tablerow"]=function(elem){return sapFioriService.GetSapTableRowIndex(elem)};extraSapFioriAttrMap["ui5-tablecol"]=function(elem){return sapFioriService.GetSapTableColIndex(elem)};extraSapFioriAttrMap["ui5-isempty"]=function(elem){return sapFioriService.GetSapIsEmpty(elem)};extraSapFioriAttrMap["ui5-collabel"]=function(elem){return sapFioriService.GetSapColLabel(elem)};for(let attrName in extraSapFioriAttrMap){let currentGetter=gcontext.g_getCustomAttrMap[attrName];if(!currentGetter){gcontext.g_getCustomAttrMap[attrName]=extraSapFioriAttrMap[attrName]}}}})})()}exports.SapFiori_ExtensionWorld_Adapter=SapFiori_ExtensionWorld_Adapter}),((__unused_webpack_module,exports)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.SalesForce_ExtensionWorld_Adapter=void 0;function SalesForce_ExtensionWorld_Adapter(__driverVersionBuildNumber){(function(){class Tools{static GetSelectedItemsResult(retCode,selectedItems){var out_result={retCode:retCode,selectedItems:selectedItems};return out_result}static IsNonEmptyString(obj){return typeof obj==="string"&&obj!==""}static EscapeSlashes(text){return text.replace(/\//g,"\\/")}static GetParentElementShadowDom(targetElement){if(targetElement==null||typeof ShadowRoot==="undefined"){return null}var rootNode=targetElement.parentNode;if(rootNode instanceof ShadowRoot){return rootNode.host}return null}static ForEachAncestor(targetElement,onEachAncestorCb){if(targetElement==null){return}var crtElement=targetElement.parentElement!==null?targetElement.parentElement:Tools.GetParentElementShadowDom(targetElement);while(crtElement!=null){if(!onEachAncestorCb(crtElement)){break}crtElement=crtElement.parentElement!==null?crtElement.parentElement:Tools.GetParentElementShadowDom(crtElement)}}static ForEachAncestorIncludingElement(targetElement,onEachAncestorCb){if(targetElement==null){return}if(!onEachAncestorCb(targetElement)){return}Tools.ForEachAncestor(targetElement,onEachAncestorCb)}static GetParentByTag(element,tagName){var out_parentElem=null;Tools.ForEachAncestor(element,function(crtAncestor){if(crtAncestor.tagName.toLowerCase()===tagName){out_parentElem=crtAncestor;return false}return true});return out_parentElem}static GetParentByTagIncludingElement(element,tagName){var out_parentElem=null;Tools.ForEachAncestorIncludingElement(element,function(crtAncestor){if(crtAncestor.tagName.toLowerCase()===tagName){out_parentElem=crtAncestor;return false}return true});return out_parentElem}static getParentByClass(element,className){var out_parentElem=null;Tools.ForEachAncestor(element,function(crtAncestor){var classNameAttr=crtAncestor.className;if(!Tools.IsNonEmptyString(classNameAttr))return true;classNameAttr==classNameAttr.toLowerCase();if(classNameAttr.indexOf(className)!==-1){out_parentElem=crtAncestor;return false}return true});return out_parentElem}static GetDocumentForElement(element){return element.ownerDocument||document}static SetDocumentAttributeMarker(element,attributePrefix,driverVersion){let doc=Tools.GetDocumentForElement(element);let markerWithVersion=attributePrefix+driverVersion;doc.documentElement.setAttribute(markerWithVersion,driverVersion)}static HasDocumentAttributeMarker(element,attributePrefix,driverVersion){let doc=Tools.GetDocumentForElement(element);let markerWithVersion=attributePrefix+driverVersion;let attributeValue=doc.documentElement.getAttribute(markerWithVersion);if(attributeValue==null){return false}return(attributeValue===driverVersion)}}class PageWorldClient{constructor(config){this.config=config}SendRequest(element,request){let elementDoc=Tools.GetDocumentForElement(element);let response=null;let eventListener=evt=>{response=this.GetResponseEventParam(elementDoc);if(!response){return}evt.stopImmediatePropagation()};let event=new CustomEvent(this.config.requestEventName);this.SetRequestEventParam(elementDoc,request);elementDoc.addEventListener(this.config.responseEventName,eventListener);elementDoc.dispatchEvent(event);elementDoc.removeEventListener(this.config.responseEventName,eventListener);this.ClearRequestEventParam(elementDoc);return response}SetRequestEventParam(elementDoc,request){elementDoc.documentElement.setAttribute(this.config.requestParamAttrName,JSON.stringify(request))}ClearRequestEventParam(elementDoc){elementDoc.documentElement.removeAttribute(this.config.requestParamAttrName)}GetResponseEventParam(elementDoc){let responseJson=elementDoc.documentElement.getAttribute(this.config.responseParamAttrName);if(!responseJson){return null}let response=JSON.parse(responseJson);return response}}WrapInGlobalContext(function(){let gcontext=this;let gcontext_v21_10=gcontext;class SalesForceSldsSelectableOption{constructor(optionElem,groupTitle,isItemSelected){this.sldsTextContentClass="slds-truncate";this.optionElem=optionElem;this.groupTitle=groupTitle!==null&&groupTitle!==void 0?groupTitle:"";this.isItemSelected=isItemSelected!==null&&isItemSelected!==void 0?isItemSelected:false}getValue(){var _a;if(this.optionElem==null){return""}var out_visibleText="";var spanDescendants=this.optionElem.getElementsByTagName("span");for(var i=0;i<spanDescendants.length;++i){var crtSpanDescendant=spanDescendants[i];var classValue=crtSpanDescendant.getAttribute("class");if(typeof classValue==="string"){classValue=classValue.toLowerCase();if(classValue===this.sldsTextContentClass){out_visibleText+=crtSpanDescendant.textContent}}}if(out_visibleText.length===0){out_visibleText=(_a=this.optionElem.textContent)!==null&&_a!==void 0?_a:""}if(Tools.IsNonEmptyString(this.groupTitle)){out_visibleText=Tools.EscapeSlashes(this.groupTitle)+"/"+Tools.EscapeSlashes(out_visibleText)}return out_visibleText}isSelected(){return this.isItemSelected}setAsUniqueSelection(){var _a;(_a=this.optionElem)===null||_a===void 0?void 0:_a.click()}}class SalesForceComboBase{constructor(comboSpecificElements){this.comboElement=comboSpecificElements.comboElement;this.inputElement=comboSpecificElements.inputElement;this.clickExpandElement=comboSpecificElements.clickExpandElement}isValid(){return this.inputElement!=null&&this.comboElement!=null&&this.clickExpandElement!=null}GetCurrentSelectedItem(_selectState,_htmlWindow){var out_selectItems=[];if(typeof this.inputElement.value!=="string"){return Tools.GetSelectedItemsResult(2,[])}out_selectItems.push(this.inputElement.value);return Tools.GetSelectedItemsResult(1,out_selectItems)}GetAllSelectableItems(selectState,htmlWindow){var out_selectItems=[];var selOptionsResult=this.GetSelectableOptionsAndHandleExpansion(selectState,htmlWindow);var out_retCode=selOptionsResult.retCode;var selectableOptions=selOptionsResult.selectableOptions;for(var i=0;i<selectableOptions.length;++i){var selectableOption=selectableOptions[i];var itemText=selectableOption.getValue();gcontext.TraceMessage("SalesForceComboBase.GetSelectedItems: adding item["+i+"] = '"+itemText+"'");out_selectItems.push(itemText)}return Tools.GetSelectedItemsResult(out_retCode,out_selectItems)}TriggerComboExpansion(_htmlWindow){gcontext.TraceError("SalesForceComboBase.ExpandCombo: base method implementation required!");return false}GetSelectableOptions(){gcontext.TraceError("SalesForceComboBase.GetSelectableOptions: base method implementation required!");return[]}IsBusyLoadingOptionItems(){var _a;var out_isBusyLoading=false;var allDivs=this.comboElement.getElementsByTagName("div");for(var i=0;i<allDivs.length;++i){var divElem=allDivs[i];var classAttr=(_a=divElem.getAttribute("class"))!==null&&_a!==void 0?_a:"";if(Tools.IsNonEmptyString(classAttr)&&classAttr.indexOf("slds-spinner")!==-1){gcontext.TraceMessage("SalesForceSldsCombo.IsBusyLoadingOptionItems: found loading spinner status with class "+classAttr);out_isBusyLoading=true;break}}return out_isBusyLoading}GetSelectableOptionsResult(retCode,selectableOptions){return{retCode:retCode,selectableOptions:selectableOptions}}GetSelectableOptionsAndHandleExpansion(selectState,htmlWindow){var out_selectableOptions=[];switch(selectState){case 0:{out_selectableOptions=this.GetSelectableOptions();gcontext.TraceMessage("SalesForceComboBase.GetSelectableOptionsAndHandleExpansion: out_selectableOptions.length = "+out_selectableOptions.length);if(out_selectableOptions.length===0){if(!this.TriggerComboExpansion(htmlWindow)){return this.GetSelectableOptionsResult(0,[])}}gcontext.TraceMessage("SalesForceComboBase.GetSelectableOptionsAndHandleExpansion: state is 'before click', retry after clicking to expand");return this.GetSelectableOptionsResult(5,out_selectableOptions)}case 1:{if(this.IsBusyLoadingOptionItems()){gcontext.TraceMessage("SalesForceComboBase.GetSelectableOptionsAndHandleExpansion: busy loading, retry after click");return this.GetSelectableOptionsResult(5,[])}out_selectableOptions=this.GetSelectableOptions();gcontext.TraceMessage("SalesForceComboBase.GetSelectableOptionsAndHandleExpansion: out_selectableOptions.length = "+out_selectableOptions.length);break}default:{gcontext.TraceMessage("SalesForceComboBase.GetSelectableOptionsAndHandleExpansion: unknown state "+selectState);return this.GetSelectableOptionsResult(0,[])}}return this.GetSelectableOptionsResult(1,out_selectableOptions)}GetSelectedItems(getAll,selectState,htmlWindow){if(!this.isValid()){return Tools.GetSelectedItemsResult(2,[])}if(getAll===false){return this.GetCurrentSelectedItem(selectState,htmlWindow)}return this.GetAllSelectableItems(selectState,htmlWindow)}SetSelectedItems(reset,_selectIfDisabled,itemsToSelect,selectState,htmlWindow){if(!this.isValid()){return 2}if(reset!==true){gcontext.TraceError("SalesForceComboBase.SetSelectedItems: reset='"+reset+"'"+", expected 'true'");return 2}if(itemsToSelect.length!==1){gcontext.TraceError("SalesForceComboBase.SetSelectedItems: itemsToSelect.length="+itemsToSelect.length+""+", expected 1");return 2}var itemToSelect=itemsToSelect[0];gcontext.TraceMessage("SalesForceComboBase.SetSelectedItems: itemToSelect='"+itemToSelect+"'");var selOptionsResult=this.GetSelectableOptionsAndHandleExpansion(selectState,htmlWindow);var out_retCode=selOptionsResult.retCode;if(out_retCode!==1){gcontext.TraceMessage("SalesForceSldsCombo.SetSelectedItems: GetSelectableOptionsInternal returned "+out_retCode);return out_retCode}var selectableOptions=selOptionsResult.selectableOptions;var optionFound=false;for(var i=0;i<selectableOptions.length;++i){var selectableOption=selectableOptions[i];var itemText=selectableOption.getValue();gcontext.TraceMessage("SalesForceComboBase.SetSelectedItems: option["+i+"] = '"+itemText+"'");if(itemText===itemToSelect){selectableOption.setAsUniqueSelection();optionFound=true;break}}if(optionFound===false){gcontext.TraceMessage("SalesForceComboBase.SetSelectedItems: option '"+itemToSelect+"' not found, return SELECT_ITEMS_NOT_FOUND");return 3}gcontext.TraceMessage("SalesForceComboBase.SetSelectedItems: return SUCCESS");return 1}}class SalesForceLightningBaseCombo extends SalesForceComboBase{static CreateInstance(originalElement){let specificElements=SalesForceLightningBaseCombo.GetSpecificHtmlElements(originalElement);if(!specificElements){return null}return new SalesForceLightningBaseCombo(specificElements)}static GetSpecificHtmlElements(sourceElem){gcontext.TraceMessage("SalesforceLightningGroupedCombobox.GetSpecificHtmlElements: sourceElem.tag = "+sourceElem.tagName);var out_inputElement=Tools.GetParentByTagIncludingElement(sourceElem,"input");if(out_inputElement==null){return null}var out_clickExpandElement=out_inputElement;var lightningBaseComboTagName="lightning-base-combobox";var out_comboElement=Tools.GetParentByTag(out_inputElement,lightningBaseComboTagName);if(!out_comboElement){return null}return{inputElement:out_inputElement,comboElement:out_comboElement,clickExpandElement:out_clickExpandElement}}TriggerComboExpansion(htmlWindow){gcontext.TraceMessage("SalesForceLightningBaseCombo.TriggerComboExpansion: clicking to expand, then to collapse");gcontext.RaiseUiEvent(this.clickExpandElement,"click",htmlWindow);gcontext.RaiseUiEvent(this.clickExpandElement,"click",htmlWindow);return true}GetSelectableOptions(){var lightningBaseOptionTagName="lightning-base-combobox-item";var out_selectableOptions=[];var selectOptionElems=this.comboElement.getElementsByTagName(lightningBaseOptionTagName);for(var i=0;i<selectOptionElems.length;++i){let element=selectOptionElems[i];out_selectableOptions.push(new SalesForceSldsSelectableOption(element))}return out_selectableOptions}}class SalesforceLightningGroupedCombobox extends SalesForceLightningBaseCombo{static CreateInstance(originalElement){var lightningBaseGroupedComboTagName="lightning-grouped-combobox";var isGroupedCombo=Tools.GetParentByTagIncludingElement(originalElement,lightningBaseGroupedComboTagName)!=null;if(!isGroupedCombo){return null}let specificElements=SalesForceLightningBaseCombo.GetSpecificHtmlElements(originalElement);if(!specificElements){return null}return new SalesforceLightningGroupedCombobox(specificElements)}GetSelectableOptions(){var _a;var lightningBaseOptionTagName="lightning-base-combobox-item";var out_selectableOptions=[];var groups=this.comboElement.getElementsByTagName("ul");for(var i=0;i<groups.length;++i){var groupTitle='';var listItems=groups[i].getElementsByTagName("li");if(listItems.length>0){var h3s=listItems[0].getElementsByTagName("h3");if(h3s.length>0){groupTitle=(_a=h3s[0].textContent)!==null&&_a!==void 0?_a:""}}var selectOptionGroupElems=groups[i].getElementsByTagName(lightningBaseOptionTagName);for(var j=0;j<selectOptionGroupElems.length;++j){var ariaCheckedAttr=selectOptionGroupElems[j].getAttribute("aria-checked");var isSelected=ariaCheckedAttr?ariaCheckedAttr.toLowerCase()==='true':false;if(!isSelected){isSelected=selectOptionGroupElems[j].getElementsByTagName("lightning-icon").length>0}let htmlElement=selectOptionGroupElems[j];out_selectableOptions.push(new SalesForceSldsSelectableOption(htmlElement,groupTitle,isSelected))}}return out_selectableOptions}GetCurrentSelectedItem(selectState,htmlWindow){var out_selectItems=[];var selOptionsResult=this.GetSelectableOptionsAndHandleExpansion(selectState,htmlWindow);var out_retCode=selOptionsResult.retCode;var selectableOptions=selOptionsResult.selectableOptions;for(var i=0;i<selectableOptions.length;++i){var selectableOption=selectableOptions[i];if(selectableOption.isSelected()){out_selectItems.push(selectableOption.getValue());break}}return Tools.GetSelectedItemsResult(out_retCode,out_selectItems)}}class SalesForceSldsCombo extends SalesForceComboBase{static CreateInstance(originalElement){var specificHtmlElements=this.GetSpecificHtmlElements(originalElement);if(specificHtmlElements){return new SalesForceSldsCombo(specificHtmlElements)}return null}static IsSldsComboElement(sourceElem){var sldsComboTagName="div";var sldsComboClassKeywords=["slds-combobox","slds-dropdown-trigger"];if(sourceElem==null){return false}if(sourceElem.tagName.toLowerCase()!==sldsComboTagName){return false}var classValue=sourceElem.getAttribute("class");if(typeof classValue!=="string"){return false}classValue=classValue.toLowerCase();for(var i=0;i<sldsComboClassKeywords.length;++i){var classKeyword=sldsComboClassKeywords[i];if(classValue.indexOf(classKeyword)===-1){return false}}return true}static GetSpecificHtmlElements(sourceElem){var out_inputElement=Tools.GetParentByTagIncludingElement(sourceElem,"input");if(out_inputElement==null){return null}var out_clickExpandElement=out_inputElement;var out_comboElement=null;Tools.ForEachAncestor(out_inputElement,crtAncestor=>{if(this.IsSldsComboElement(crtAncestor)){out_comboElement=crtAncestor;return false}return true});if(!out_comboElement){return null}return{inputElement:out_inputElement,comboElement:out_comboElement,clickExpandElement:out_clickExpandElement}}TriggerComboExpansion(htmlWindow){gcontext.TraceMessage("SalesForceSldsCombo.TriggerComboExpansion: clicking to expand, then to collapse");this.clickExpandElement.click();gcontext.RaiseUiEvent(this.clickExpandElement,"click",htmlWindow);return true}GetSelectableOptions(){var sldsOptionTagName="div";var sldsOptionRole="option";var out_selectableOptions=[];var selectOptionElems=this.comboElement.getElementsByTagName(sldsOptionTagName);for(var i=0;i<selectOptionElems.length;++i){var selectOptionElem=selectOptionElems[i];if(this.IsSldsOptionElement(selectOptionElem,sldsOptionTagName,sldsOptionRole)){out_selectableOptions.push(new SalesForceSldsSelectableOption(selectOptionElem))}}return out_selectableOptions}IsSldsOptionElement(sourceElem,sldsOptionTagName,sldsOptionRole){if(sourceElem==null){return false}if(sourceElem.tagName.toLowerCase()!==sldsOptionTagName){return false}var roleValue=sourceElem.getAttribute("role");return Tools.IsNonEmptyString(roleValue)&&roleValue===sldsOptionRole}}class SalesForceUiMenuSelectableOption{constructor(optionElem){this.optionSpecificElement=null;var children=optionElem.children;if(children.length===0){gcontext.TraceMessage("SalesForceUiMenu.SalesForceUiMenuSelectableOption: Invalid item menu with no children");return}if(children[0].tagName.toLowerCase()!="a"){gcontext.TraceMessage("SalesForceUiMenu.SalesForceUiMenuSelectableOption: Invalid item menu with no 'a' tag");return}this.optionSpecificElement=children[0]}getValue(){var _a,_b;return(_b=(_a=this.optionSpecificElement)===null||_a===void 0?void 0:_a.textContent)!==null&&_b!==void 0?_b:""}isSelected(){var _a,_b;var ariaCheckedAttr=(_b=(_a=this.optionSpecificElement)===null||_a===void 0?void 0:_a.getAttribute("aria-checked"))!==null&&_b!==void 0?_b:"";if(Tools.IsNonEmptyString(ariaCheckedAttr)){return ariaCheckedAttr.toLowerCase()==="true"}return false}setAsUniqueSelection(){var _a;(_a=this.optionSpecificElement)===null||_a===void 0?void 0:_a.click()}}class SalesForceUiMenu extends SalesForceComboBase{static CreateInstance(originalElement){let specificElements=this.GetSpecificHtmlElements(originalElement);if(!specificElements){return null}return new SalesForceUiMenu(specificElements)}static GetSpecificHtmlElements(originalElement){if(originalElement.tagName==null||originalElement.tagName.toLowerCase()!=='a'){let parent=Tools.GetParentByTag(originalElement,'a');if(parent==null){return null}originalElement=parent}if(Tools.getParentByClass(originalElement,'uiMenu')===null)return null;var popupTriggerElement=Tools.getParentByClass(originalElement,'uiPopupTrigger');if(popupTriggerElement==null)return null;var idAttr=popupTriggerElement.getAttribute("id");if(!Tools.IsNonEmptyString(idAttr))return null;var popupTargets=document.getElementsByClassName("uiPopupTarget");let comboElement=null;for(var i=0;i<popupTargets.length;++i){var popup=popupTargets[i];if(popup.getAttribute("aria-labelledby")===idAttr){comboElement=popup;break}}if(!comboElement){return null}return{inputElement:originalElement,comboElement:comboElement,clickExpandElement:originalElement}}TriggerComboExpansion(_htmlWindow){gcontext.TraceMessage("SalesForceUiMenu.TriggerComboExpansion: clicking to expand, then to collapse");this.clickExpandElement.click();this.clickExpandElement.click();return true}GetSelectableOptions(){var out_selectableOptions=[];var selectOptionElems=this.comboElement.getElementsByClassName("uiMenuItem");for(var i=0;i<selectOptionElems.length;++i){var selectOptionElem=selectOptionElems[i];out_selectableOptions.push(new SalesForceUiMenuSelectableOption(selectOptionElem))}return out_selectableOptions}GetCurrentSelectedItem(selectState,htmlWindow){var out_selectItems=[];var selOptionsResult=this.GetSelectableOptionsAndHandleExpansion(selectState,htmlWindow);var out_retCode=selOptionsResult.retCode;var selectableOptions=selOptionsResult.selectableOptions;for(var i=0;i<selectableOptions.length;++i){var selectableOption=selectableOptions[i];if(selectableOption.isSelected()){var itemText=selectableOption.getValue();gcontext.TraceMessage("SalesForceComboBase.GetSelectedItems: adding item["+i+"] = '"+itemText+"'");out_selectItems.push(itemText)}}return Tools.GetSelectedItemsResult(out_retCode,out_selectItems)}}class SalesForceCheckableElement{constructor(originalElement,inputCheckboxElement){this.originalElement=originalElement;this.inputCheckboxElement=inputCheckboxElement}static CreateInstance(originalElement){let inputCheckboxElement=this.GetInputCheckboxElement(originalElement);if(!inputCheckboxElement){return null}return new SalesForceCheckableElement(originalElement,inputCheckboxElement)}static IsSldsCheckableElement(sourceElem){var elemClass=sourceElem.getAttribute("class");if(typeof elemClass!=="string"){return false}var sldsCheckboxClassPrefix="slds-checkbox";var sldsCheckboxClassSuffix="faux";var regEx=new RegExp(sldsCheckboxClassPrefix+"[_-]+"+sldsCheckboxClassSuffix,"");return elemClass.match(regEx)!=null}static GetInputCheckboxElement(originalElement){if(!this.IsSldsCheckableElement(originalElement)){return null}var labelAncestor=Tools.GetParentByTag(originalElement,"label");if(labelAncestor==null){return null}var out_inputCheckboxElement=null;if(typeof labelAncestor.htmlFor==="string"&&labelAncestor.htmlFor.length!==0&&labelAncestor.parentElement!=null){gcontext.TraceMessage("SalesForce.GetInputCheckboxElement: found labeled checkbox");out_inputCheckboxElement=labelAncestor.ownerDocument.getElementById(labelAncestor.htmlFor)}else{for(var i=0;i<labelAncestor.children.length;++i){var crtChild=labelAncestor.children[i];var crtChildTag=crtChild.tagName.toLowerCase();if(crtChildTag==="input"&&crtChild.type!=null){var inputType=crtChild.type.toLowerCase();if(inputType==="checkbox"){gcontext.TraceMessage("SalesForce.GetInputCheckboxElement: found simple/rounded checkbox");out_inputCheckboxElement=crtChild;break}}}}return out_inputCheckboxElement}GetCheckState(){var _a,_b;return(_b=(_a=this.inputCheckboxElement)===null||_a===void 0?void 0:_a.checked)!==null&&_b!==void 0?_b:false}SetCheckState(newCheckStateBool){var existingCheckState=this.GetCheckState();if(existingCheckState===null){return false}if(newCheckStateBool===existingCheckState){gcontext.TraceMessage("SalesForce.SetCheckState: checkbox already has the required check state of "+existingCheckState);return true}gcontext.TraceMessage("SalesForce.SetCheckState: clicking original element to set check state to "+newCheckStateBool);this.originalElement.click();return true}}class SalesForcePageWorldClient{constructor(driverVersion,salesForceDefines){this.driverVersion=driverVersion;this.salesForceDefines=salesForceDefines;let config={requestEventName:"__UiPath_SalesForce_Request_"+driverVersion,responseEventName:"__UiPath_SalesForce_Response_"+driverVersion,requestParamAttrName:"data-UiPath_SalesForce_Request_Attr_"+driverVersion,responseParamAttrName:"data-UiPath_SalesForce_Response_Attr_"+driverVersion};this.pageWorldClient=new PageWorldClient(config)}IsSalesForceAuraAvailable(element){return this.SendElementRequestCustom(element,2,"",false)}GetComponentName(element){return this.SendElementRequest(element,3,"")}GetComponentType(element){return this.SendElementRequest(element,4,"")}GetComponentPath(element){return this.SendElementRequest(element,5,"")}SendElementRequest(element,requestId,defaultReturnValue){var auraComponentGlobalId=this.GetSalesForceComponentGlobalIdFromElement(element);if(!this.IsValidAuraComponentGlobalId(auraComponentGlobalId)){return defaultReturnValue}let requestData={globalId:auraComponentGlobalId};return this.SendElementRequestCustom(element,requestId,requestData,defaultReturnValue)}SendElementRequestCustom(element,requestId,requestData,defaultReturnValue){if(!this.EnsureSalesForceContentIsInitialized(element)){return defaultReturnValue}return this.SendRequest(element,requestId,requestData,defaultReturnValue)}SendRequest(element,requestId,requestData,defaultReturnValue){let request={requestId:requestId,data:requestData};let response=this.pageWorldClient.SendRequest(element,request);if((response===null||response===void 0?void 0:response.result)==null){return defaultReturnValue}return response.result}EnsureSalesForceContentIsInitialized(element){if(this.IsPageContentInitialized(element)){return true}return this.InitializeSalesForcePageContent(element)}IsPageContentInitialized(element){return Tools.HasDocumentAttributeMarker(element,this.salesForceDefines.pageContextInitFlagAttrName,this.driverVersion)}InitializeSalesForcePageContent(element){let initSuccesfully=this.SendRequest(element,1,"",false);if(initSuccesfully){Tools.SetDocumentAttributeMarker(element,this.salesForceDefines.pageContextInitFlagAttrName,this.driverVersion)}return initSuccesfully}GetSalesForceComponentGlobalIdFromElement(element){var _a;return(_a=element.getAttribute(this.salesForceDefines.AURA_COMPONENT_NAME))!==null&&_a!==void 0?_a:""}IsValidAuraComponentGlobalId(auraComponentGlobalId){return auraComponentGlobalId!==""}}const salesForceDefines={AURA_COMPONENT_NAME:"data-aura-rendered-by",pageContextInitFlagAttrName:"__uipath_sales_force_initialized_"};const pageWorldClient=new SalesForcePageWorldClient(__driverVersionBuildNumber,salesForceDefines);let salesForceService=gcontext;salesForceService.g_salesForceDefines=salesForceDefines;salesForceService.IsSalesForceElement=function(element){if(!element){return false}return pageWorldClient.IsSalesForceAuraAvailable(element)};salesForceService.IsSalesForceAttributeName=function(attrName){var salesForceLightningPrefix="sfl-";if(!attrName){return false}return attrName.length>salesForceLightningPrefix.length&&attrName.substr(0,salesForceLightningPrefix.length).toLowerCase()===salesForceLightningPrefix};salesForceService.GetSalesForceNameFromElement=function(element){if(!element){return""}return pageWorldClient.GetComponentName(element)};salesForceService.GetSalesForceTypeFromElement=function(element){if(!element){return""}return pageWorldClient.GetComponentType(element)};salesForceService.GetSalesForcePathFromElement=function(element){if(!element){return""}return pageWorldClient.GetComponentPath(element)};salesForceService.GetSalesForceAttributeNames=function(){return["sfl-name","sfl-type","sfl-path"]};salesForceService.GetSalesForceSelectorAttributeNames=function(element){var out_attrNames=[];if(!element){return out_attrNames}var mutuallyExclusiveAttrs=["sfl-path","sfl-name","sfl-type"];for(var i=0;i<mutuallyExclusiveAttrs.length;++i){var attrName=mutuallyExclusiveAttrs[i];var attrValue=gcontext.GetAttributeValue(element,attrName);if(Tools.IsNonEmptyString(attrValue)){out_attrNames.push(attrName);break}}return out_attrNames};salesForceService.SalesForceUpdateSelectorPolicy=function(targetElement,selectorPolicy){if(!salesForceService.IsSalesForceElement(targetElement)||selectorPolicy==null){return}if(selectorPolicy.currentHierarchyPosition.isLeafElement){var nameValue=salesForceService.GetSalesForceNameFromElement(targetElement);if(!Tools.IsNonEmptyString(nameValue)){gcontext.TraceMessage("SalesForceUpdateSelectorPolicy: adding 'sfl-path' hierarchy condition");selectorPolicy.AddHierarchyConditionMatchAny(new gcontext_v21_10.HierarchyCondition_StopAtValidAttr("sfl-path"))}}};salesForceService.SalesForceGetSelectableElement=function(originalElement){if(!originalElement){return null}let groupedComboBox=SalesforceLightningGroupedCombobox.CreateInstance(originalElement);if(groupedComboBox){return groupedComboBox}let baseComboBox=SalesForceLightningBaseCombo.CreateInstance(originalElement);if(baseComboBox){return baseComboBox}let sldsCombo=SalesForceSldsCombo.CreateInstance(originalElement);if(sldsCombo){return sldsCombo}let uiMenu=SalesForceUiMenu.CreateInstance(originalElement);if(uiMenu){return uiMenu}return null};salesForceService.SalesForceIsElementSelectable=function(element){return salesForceService.SalesForceGetSelectableElement(element)!=null};salesForceService.SalesForceGetSelectedItems=function(element,getAll,selectState,htmlWindow){gcontext.TraceMessage("SalesForceGetSelectedItems: getAll="+getAll+" selectState="+selectState);var auraSelectableElement=salesForceService.SalesForceGetSelectableElement(element);if(auraSelectableElement==null){return Tools.GetSelectedItemsResult(2,[])}return auraSelectableElement.GetSelectedItems(getAll,selectState,htmlWindow)};salesForceService.SalesForceSelectItems=function(element,reset,selectIfDisabled,itemsToSelect,selectState,htmlWindow){gcontext.TraceMessage("SalesForceSelectItems: reset="+reset+" selectIfDisabled="+selectIfDisabled+" itemsToSelect.length="+itemsToSelect.length);if(element==null||itemsToSelect.length===0){return 0}var auraSelectableElement=salesForceService.SalesForceGetSelectableElement(element);if(auraSelectableElement==null){return 2}return auraSelectableElement.SetSelectedItems(reset,selectIfDisabled,itemsToSelect,selectState,htmlWindow)};salesForceService.SalesForceGetCheckableElement=function(element){if(!element){return null}return SalesForceCheckableElement.CreateInstance(element)};salesForceService.SalesForceTryGetCheckableState=function(element){var checkableElement=salesForceService.SalesForceGetCheckableElement(element);if(checkableElement==null){return null}return checkableElement.GetCheckState()};salesForceService.SalesForceTrySetCheckableState=function(element,newCheckStateBool){var checkableElement=salesForceService.SalesForceGetCheckableElement(element);if(checkableElement==null){return false}return checkableElement.SetCheckState(newCheckStateBool)}})})()}exports.SalesForce_ExtensionWorld_Adapter=SalesForce_ExtensionWorld_Adapter}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.DebuggerEvalService=void 0;const tslib_1=__webpack_require__(5);const Logger_1=__webpack_require__(4);const StringTools_1=__webpack_require__(7);const Tools_1=__webpack_require__(8);const ChromeDebugger_1=__webpack_require__(43);class DebuggerEvalService{constructor(){var _a;this.debuggerVersion="1.2";this.backgroundPageDebugTarget=null;this.classLogger=new Logger_1.ClassLogger(DebuggerEvalService);this.evalFuncId=0;this.isEvalRestricted=true;(_a=ChromeDebugger_1.ChromeDebugger.OnDetachEvent())===null||_a===void 0?void 0:_a.addListener((source,reason)=>{this.OnDebuggerDetached(source,reason)})}EvalCodeInBackgroundPage(code,onFinishedCb){this.EvalCodeInBackgroundPage_Async(code).then(onFinishedCb)}EvalFunctionInBackgroundPage_Async(code){return tslib_1.__awaiter(this,void 0,void 0,function*(){let evalFuncName=this.GetNextEvalFuncName();let evalCodeWrapper=this.GetDebuggerEvalWrapperCode(evalFuncName,code);let evalResult=yield this.EvalCodeInBackgroundPage_Async(evalCodeWrapper);if(!evalResult.success){return evalResult}let evalFunc=this.GetDebuggerEvalWrapperFunc(evalFuncName);if(!evalFunc){return{success:false,errorMessage:"Failed to load code"}}return{success:true,evalFunc:evalFunc}})}IsEvalRestricted_Async(){return tslib_1.__awaiter(this,void 0,void 0,function*(){if(this.isEvalRestricted===false){return false}let debugTarget=yield this.AttachToBackgroundPage_Async();if(!debugTarget){this.classLogger.Error(this.IsEvalRestricted_Async,"Cannot attach debugger to background page; check if DeveloperToolsAvailability=0");return true}let evalResult=yield this.EvalFunctionInBackgroundPage_Async("var x = 1;");if(!evalResult.success){this.classLogger.Error(this.IsEvalRestricted_Async,"Cannot use Runtime.evaluate");return true}this.isEvalRestricted=false;this.classLogger.Log(this.IsEvalRestricted_Async,"Not restricted");return false})}GetNextEvalFuncName(){this.evalFuncId=Tools_1.Tools.SafeIncrementWithWrapAround(this.evalFuncId);let funcId=this.evalFuncId;let funcName="ExtensionDebuggerEvalFunc_"+funcId;return funcName}EvalCodeInBackgroundPage_Async(code){return tslib_1.__awaiter(this,void 0,void 0,function*(){let debugTarget=yield this.AttachToBackgroundPage_Async();if(!debugTarget){return{success:false,errorMessage:"Failed to attach debugger to background page"}}return this.SendEvalCommand_Async(debugTarget,code)})}AttachToBackgroundPage_Async(){var _a;return tslib_1.__awaiter(this,void 0,void 0,function*(){let logger=new Logger_1.MethodLogger(this.classLogger,this.AttachToBackgroundPage_Async);const extensionPageUrl=chrome.runtime.getURL("BackgroundPage.html");const targetId=yield this.FindDebugTargetId_Async(extensionPageUrl);if(Tools_1.Tools.isNil(targetId)){return null}if(targetId===((_a=this.backgroundPageDebugTarget)===null||_a===void 0?void 0:_a.targetId)){return this.backgroundPageDebugTarget}let previousTarget=this.ClearBackgroundPageDebugTarget();if(previousTarget){logger.Log("Dettaching debugger from previous background page:",previousTarget.targetId);yield this.DettachDebugger_Async(previousTarget)}logger.Log("Attaching debugger to extensionPageUrl:",extensionPageUrl);let target={targetId:targetId};let isAttached=yield this.AttachDebugger_Async(target);if(!isAttached){logger.Error("Failed to attach debugger to extensionPageUrl:",extensionPageUrl);return null}logger.Log("Attached debugger to extensionPageUrl!");this.SetBackgroundPageDebugTarget(target);return target})}SendEvalCommand_Async(debugTarget,codeToEval){var _a,_b,_c,_d;return tslib_1.__awaiter(this,void 0,void 0,function*(){const methodName="Runtime.evaluate";const commandParams={expression:codeToEval};const commandResult=yield ChromeDebugger_1.ChromeDebugger.SendCommand_Async(debugTarget,methodName,commandParams);let errorMsg=null;if(!commandResult.success){errorMsg=commandResult.errorMsg;this.classLogger.Error(this.SendEvalCommand_Async,"sendCommand failed; errorMsg: ",errorMsg)}else if((_a=commandResult.data)===null||_a===void 0?void 0:_a.hasOwnProperty("exceptionDetails")){let exceptionDetails=(_b=commandResult.data["exceptionDetails"])!==null&&_b!==void 0?_b:{};errorMsg=(_d=(_c=exceptionDetails===null||exceptionDetails===void 0?void 0:exceptionDetails.exception)===null||_c===void 0?void 0:_c.description)!==null&&_d!==void 0?_d:"Unknown eval error";this.classLogger.Error(this.SendEvalCommand_Async,"evaluate failed; errorMsg:",errorMsg)}let result=(errorMsg!=null)?{success:false,errorMessage:errorMsg}:{success:true};return result})}FindDebugTargetId_Async(targetUrl){return tslib_1.__awaiter(this,void 0,void 0,function*(){let getTargetsResult=yield ChromeDebugger_1.ChromeDebugger.GetTargets_Async();if(!getTargetsResult.success){return null}let foundTargetId=null;for(const target of getTargetsResult.data){if(target.url===targetUrl){foundTargetId=target.id;break}}if(!foundTargetId){this.classLogger.Error(this.FindDebugTargetId_Async,"Failed for url: ",targetUrl)}return foundTargetId})}IsDebuggerAttached_Async(targetToCheck){return tslib_1.__awaiter(this,void 0,void 0,function*(){let getTargetsResult=yield ChromeDebugger_1.ChromeDebugger.GetTargets_Async();if(!getTargetsResult.success){return false}let isAttached=false;for(const target of getTargetsResult.data){if(target.id===targetToCheck.targetId){isAttached=target.attached;break}}return isAttached})}AttachDebugger_Async(target){return tslib_1.__awaiter(this,void 0,void 0,function*(){let attachResult=yield ChromeDebugger_1.ChromeDebugger.Attach_Async(target,this.debuggerVersion);if(attachResult.success){return true}else{this.classLogger.Warn(this.AttachDebugger_Async,"chrome.runtime.lastError:",attachResult.errorMsg)}let isAttached=yield this.IsDebuggerAttached_Async(target);if(isAttached){this.classLogger.Log(this.AttachDebugger_Async,"chrome.debugger.attach failed, but the debugger is attached to target")}else{this.classLogger.Error(this.AttachDebugger_Async,"Failed to attach debugger to targetId:",target.targetId)}return isAttached})}DettachDebugger_Async(target){return tslib_1.__awaiter(this,void 0,void 0,function*(){let detachResult=yield ChromeDebugger_1.ChromeDebugger.Detach_Async(target);if(!detachResult.success){this.classLogger.Error(this.DettachDebugger_Async,"Detach failed; chrome.runtime.lastError: ",detachResult.errorMsg)}return detachResult.success})}OnDebuggerDetached(source,reason){var _a;if(source.targetId===((_a=this.backgroundPageDebugTarget)===null||_a===void 0?void 0:_a.targetId)){this.classLogger.Warn(this.OnDebuggerDetached,"Debugger detached from background page; reason:",reason);this.ClearBackgroundPageDebugTarget()}}SetBackgroundPageDebugTarget(source){this.backgroundPageDebugTarget=source}ClearBackgroundPageDebugTarget(){let previousTarget=this.backgroundPageDebugTarget;this.backgroundPageDebugTarget=null;return previousTarget}GetDebuggerEvalWrapperCode(evalFuncName,codeToEval){let functionTemplate=function(){window["evalFuncName"]=function(){codeToEval}};let template=StringTools_1.StringTools.GetFunctionBody(functionTemplate);let evalWrapper=StringTools_1.StringTools.SafeReplaceString(template,"evalFuncName",evalFuncName);evalWrapper=StringTools_1.StringTools.SafeReplaceString(evalWrapper,"codeToEval",codeToEval);return evalWrapper}GetDebuggerEvalWrapperFunc(evalFuncName){let wrapperFunc=window[evalFuncName];if(wrapperFunc){delete window[evalFuncName]}else{this.classLogger.Error(this.GetDebuggerEvalWrapperFunc,"Could not find window.evalFuncName:",evalFuncName)}return wrapperFunc}}exports.DebuggerEvalService=DebuggerEvalService}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.ChromeDebugger=void 0;const Tools_1=__webpack_require__(8);var ChromeDebugger;(function(ChromeDebugger){const g_chromeDebuggerApi=chrome.debugger;function OnDetachEvent(){var _a;return(_a=g_chromeDebuggerApi===null||g_chromeDebuggerApi===void 0?void 0:g_chromeDebuggerApi.onDetach)!==null&&_a!==void 0?_a:null}ChromeDebugger.OnDetachEvent=OnDetachEvent;function OnDebuggerEvent(){var _a;return(_a=g_chromeDebuggerApi===null||g_chromeDebuggerApi===void 0?void 0:g_chromeDebuggerApi.onEvent)!==null&&_a!==void 0?_a:null}ChromeDebugger.OnDebuggerEvent=OnDebuggerEvent;function GetTargets_Async(){return DoWithDebugger_Async((debuggerApi,resolvePromiseCb)=>{debuggerApi.getTargets(targets=>{var _a,_b;if(targets==null){let errorMsg=(_b=(_a=chrome.runtime.lastError)===null||_a===void 0?void 0:_a.message)!==null&&_b!==void 0?_b:"chrome.debugger.getTargets failed";return resolvePromiseCb({success:false,errorMsg:errorMsg})}else{return resolvePromiseCb({success:true,data:targets})}})})}ChromeDebugger.GetTargets_Async=GetTargets_Async;function Attach_Async(target,requiredVersion){return DoWithDebugger_Async((debuggerApi,resolvePromiseCb)=>{debuggerApi.attach(target,requiredVersion,()=>{var _a;if(chrome.runtime.lastError){let errorMsg=(_a=chrome.runtime.lastError.message)!==null&&_a!==void 0?_a:"chrome.debugger.attach failed";return resolvePromiseCb({success:false,errorMsg:errorMsg})}else{return resolvePromiseCb({success:true,data:undefined})}})})}ChromeDebugger.Attach_Async=Attach_Async;function Detach_Async(target){return DoWithDebugger_Async((debuggerApi,resolvePromiseCb)=>{debuggerApi.detach(target,()=>{var _a;if(chrome.runtime.lastError){let errorMsg=(_a=chrome.runtime.lastError.message)!==null&&_a!==void 0?_a:"chrome.debugger.detach failed";return resolvePromiseCb({success:false,errorMsg:errorMsg})}else{return resolvePromiseCb({success:true,data:undefined})}})})}ChromeDebugger.Detach_Async=Detach_Async;function SendCommand_Async(target,method,commandParams){return DoWithDebugger_Async((debuggerApi,resolvePromiseCb)=>{debuggerApi.sendCommand(target,method,commandParams,value=>{var _a;if(chrome.runtime.lastError){let errorMsg=(_a=chrome.runtime.lastError.message)!==null&&_a!==void 0?_a:"chrome.debugger.sendCommand failed";return resolvePromiseCb({success:false,errorMsg:errorMsg})}else{return resolvePromiseCb({success:true,data:value})}})})}ChromeDebugger.SendCommand_Async=SendCommand_Async;function DoWithDebugger_Async(action){return Tools_1.Tools.ToPromise(resolvePromiseCb=>{if(Tools_1.Tools.isNil(g_chromeDebuggerApi)){return resolvePromiseCb({success:false,errorMsg:"chrome.debugger is not available"})}return action(g_chromeDebuggerApi,resolvePromiseCb)})}})(ChromeDebugger=exports.ChromeDebugger||(exports.ChromeDebugger={}))}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.TabsService=void 0;const BrowserTools_1=__webpack_require__(3);const Logger_1=__webpack_require__(4);const Tools_1=__webpack_require__(8);class TabsService{constructor(){}GetAllTabs(onResultCb){var queryParams={url:"<all_urls>"};chrome.tabs.query(queryParams,allTabs=>{let accessibleTabs=[];for(let tab of allTabs){if(Tools_1.Tools.isNil(tab.id)||Tools_1.Tools.isNil(tab.url)||BrowserTools_1.BrowserTools.IsBrowserSettingsUrl(tab.url)){continue}let tabData={id:tab.id,url:tab.url,tab:tab};accessibleTabs.push(tabData)}onResultCb(accessibleTabs)})}ForAllTabs(tabActionCb,onCompletedCb){const doFilteredTabAction=(tabData,onActionCompletedCb)=>{tabActionCb(tabData.tab,onActionCompletedCb)};this.GetAllTabs(tabsList=>{BrowserTools_1.BrowserTools.ForAllParallel(tabsList,doFilteredTabAction,onCompletedCb)})}ExecuteScriptInAllTabFrames(tabId,funcToExecute,onCompletedCb){const injectionTarget={allFrames:true,tabId:tabId};this.ExecuteScriptInTarget(injectionTarget,funcToExecute,"ISOLATED",undefined,onCompletedCb)}ExecuteScriptInAllTabFrames_PageWorld(tabId,funcToExecute,onCompletedCb){const injectionTarget={allFrames:true,tabId:tabId};this.ExecuteScriptInTarget(injectionTarget,funcToExecute,"MAIN",undefined,onCompletedCb)}ExecuteScriptInTabFrame(target,funcToExecute,onCompletedCb){const injectionTarget={allFrames:false,tabId:target.TabId,frameIds:[target.FrameId]};this.ExecuteScriptInTarget(injectionTarget,funcToExecute,"ISOLATED",undefined,onCompletedCb)}ExecuteScriptInTabFrame_PageWorld(target,funcToExecute,args,onCompletedCb){const injectionTarget={allFrames:false,tabId:target.TabId,frameIds:[target.FrameId]};this.ExecuteScriptInTarget(injectionTarget,funcToExecute,"MAIN",args,onCompletedCb)}ExecuteScriptInTarget(injectionTarget,funcToExecute,injectionWorld,args,onCompletedCb){const scriptInjection={func:funcToExecute,target:injectionTarget,args:args};scriptInjection["world"]=injectionWorld;chrome.scripting.executeScript(scriptInjection,()=>{let success=true;if(chrome.runtime.lastError){const errorMsg=chrome.runtime.lastError.message;Logger_1.Logger.Error("[TabsService::ExecuteScriptInTarget]"+" executeScript failed for tabId: "+injectionTarget.tabId+", errorMsg: "+errorMsg);success=false}onCompletedCb(success)})}SendMessageToAllTabs(getTabInputParamsCb,onCompletedAllCb){this.GetAllTabs(tabDataArray=>{let processTabCb=(tabData,onCompletedCb)=>{let inputParams=getTabInputParamsCb(tabData.tab);this.SendMessageToAllTabFrames(tabData.id,inputParams,onCompletedCb)};BrowserTools_1.BrowserTools.ForAllParallel(tabDataArray,processTabCb,onCompletedAllCb)})}SendMessageToAllTabFrames(tabId,msg,onCompletedCb){chrome.tabs.sendMessage(tabId,msg,()=>{if(chrome.runtime.lastError){Logger_1.Logger.Warn("SendMessageToAllTabFrames: sendMessage failed to tab.id:"+tabId+", msg: "+chrome.runtime.lastError.message)}onCompletedCb()})}SendMessageToTabFrame(target,message,onCompletedCb){let msgOptions={frameId:target.FrameId};chrome.tabs.sendMessage(target.TabId,message,msgOptions,response=>{if(chrome.runtime.lastError){Logger_1.Logger.Error("[TabsService::SendMessageToTabFrame] target: "+target+", chrome.runtime.lastError: "+chrome.runtime.lastError.message);onCompletedCb(null);return}onCompletedCb(response)})}}exports.TabsService=TabsService}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.TabsQueryFiltrator=void 0;const BrowserTools_1=__webpack_require__(3);const Tools_1=__webpack_require__(8);class TabsQueryFiltrator{constructor(extensionTabUrl,originalTabsQuery){this.extensionTabUrl=extensionTabUrl;this.tabsQuery=originalTabsQuery;this.OverrideChromeTabsQuery()}OverrideChromeTabsQuery(){let tabsQueryOverride=(queryInfo,callback)=>{if(Tools_1.Tools.isNil(callback)){return this.tabsQuery(queryInfo)}return this.tabsQuery(queryInfo,foundTabs=>{if(chrome.runtime.lastError){return callback(foundTabs)}let filteredTabs=BrowserTools_1.BrowserTools.ExcludeTabsWithUrl(foundTabs,this.extensionTabUrl);return callback(filteredTabs)})};chrome.tabs.query=tabsQueryOverride}}exports.TabsQueryFiltrator=TabsQueryFiltrator}),((__unused_webpack_module,exports,__webpack_require__)=>{Object.defineProperty(exports,"__esModule",({value:true}));exports.TabsMessageInterceptor=void 0;const ContentTarget_1=__webpack_require__(15);const Logger_1=__webpack_require__(4);const Tools_1=__webpack_require__(8);class TabsMessageInterceptor{constructor(originalTabsSendMessage){this.unfilteredMsgInterceptor=null;this.logger=new Logger_1.ClassLogger(TabsMessageInterceptor);this.tabsSendMessage=originalTabsSendMessage;chrome.tabs.sendMessage=(tabId,message,options_Or_Callback,callback)=>{if(!options_Or_Callback&&!callback){return this.tabsSendMessage(tabId,message)}else if(typeof options_Or_Callback==="function"){let responseCallback=options_Or_Callback;return this.tabsSendMessage(tabId,message,responseCallback)}else if(options_Or_Callback){let options=options_Or_Callback;return this.FilterTabsSendMessage(tabId,message,options,callback)}}}InterceptNextUnfilteredMessage(interceptCb){this.unfilteredMsgInterceptor=interceptCb}FilterTabsSendMessage(tabId,message,options,responseCallback){var _a;if(this.unfilteredMsgInterceptor&&!this.IsMessageWithChannelId(message)){this.logger.Log(this.FilterTabsSendMessage,"Intercepted message");let interceptorCb=this.unfilteredMsgInterceptor;this.unfilteredMsgInterceptor=null;let target=new ContentTarget_1.ContentTarget(tabId,(_a=options.frameId)!==null&&_a!==void 0?_a:0);try{return interceptorCb(message,target,responseCallback)}catch(ex){this.logger.Error(this.FilterTabsSendMessage,"Exception throw by interceptor:",ex)}}else{return this.tabsSendMessage(tabId,message,options,responseCallback)}}IsMessageWithChannelId(message){return!Tools_1.Tools.isNil(message===null||message===void 0?void 0:message.ChannelId)}}exports.TabsMessageInterceptor=TabsMessageInterceptor})]);var __webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==undefined){return cachedModule.exports}var module=__webpack_module_cache__[moduleId]={exports:{}};__webpack_modules__[moduleId](module,module.exports,__webpack_require__);return module.exports}(()=>{__webpack_require__.d=(exports,definition)=>{for(var key in definition){if(__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)){Object.defineProperty(exports,key,{enumerable:true,get:definition[key]})}}}})();(()=>{__webpack_require__.o=(obj,prop)=>(Object.prototype.hasOwnProperty.call(obj,prop))})();(()=>{__webpack_require__.r=exports=>{if(typeof Symbol!=='undefined'&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:'Module'})}Object.defineProperty(exports,'__esModule',{value:true})}})();var __webpack_exports__={};(()=>{var exports=__webpack_exports__;Object.defineProperty(exports,"__esModule",({value:true}));const BrowserTools_1=__webpack_require__(3);const BackgroundPackageManager_1=__webpack_require__(21);const LoaderWin32_1=__webpack_require__(27);const LoaderPortable_1=__webpack_require__(32);const Logger_1=__webpack_require__(4);const BackgroundGlobals_1=__webpack_require__(1);const ConnectionProxy_1=__webpack_require__(34);const ConnectionHandler_1=__webpack_require__(36);const ExecuteScript_AdapterToMV3_1=__webpack_require__(37);const BackgroundPageService_1=__webpack_require__(9);const DriverEvalService_1=__webpack_require__(38);const DebuggerEvalService_1=__webpack_require__(42);const TabsService_1=__webpack_require__(44);const BrowserExtensionConfig_1=__webpack_require__(12);const ExtensionErrorService_1=__webpack_require__(30);const OriginalChromeApi_1=__webpack_require__(2);const TabsQueryFiltrator_1=__webpack_require__(45);const TabsMessageInterceptor_1=__webpack_require__(46);let backgroundPageService=new BackgroundPageService_1.BackgroundPageService(OriginalChromeApi_1.OriginalChromeApi.GetTabsQuery());backgroundPageService.InitAsExtensionWindow_Async().then(extensionWindowId=>{Logger_1.Logger.Log("[BackgroundMain] extensionWindowId: ",extensionWindowId);let globalScope=BrowserTools_1.BrowserTools.GetGlobalThis();let tabsService=new TabsService_1.TabsService;let tabsQueryFiltrator=new TabsQueryFiltrator_1.TabsQueryFiltrator(BackgroundPageService_1.BackgroundPageService.GetExtensionPageUrl(),OriginalChromeApi_1.OriginalChromeApi.GetTabsQuery());let tabsSendMessageInterceptor=new TabsMessageInterceptor_1.TabsMessageInterceptor(OriginalChromeApi_1.OriginalChromeApi.GetTabsSendMessage());let extensionErrorService=new ExtensionErrorService_1.ExtensionErrorService;let debuggerEvalService=new DebuggerEvalService_1.DebuggerEvalService;let driverEvalService=new DriverEvalService_1.DriverEvalService(debuggerEvalService);let originalChromeFunctions={tabsSendMessage:OriginalChromeApi_1.OriginalChromeApi.GetTabsSendMessage(),tabsQuery:OriginalChromeApi_1.OriginalChromeApi.GetTabsQuery()};let embeddedDrivers=BackgroundGlobals_1.BackgroundGlobals.GetEmbeddedDriversMap(globalScope);let packageManager=new BackgroundPackageManager_1.BackgroundPackageManager(driverEvalService,tabsService,originalChromeFunctions,embeddedDrivers);let executeScriptAdapterToMV3=new ExecuteScript_AdapterToMV3_1.ExecuteScript_AdapterToMV3(packageManager,tabsSendMessageInterceptor,driverEvalService);BackgroundGlobals_1.BackgroundGlobals.RegisterTabsService(globalScope,tabsService);BackgroundGlobals_1.BackgroundGlobals.RegisterExtensionErrorService(globalScope,extensionErrorService);BackgroundGlobals_1.BackgroundGlobals.RegisterDebuggerEvalService(globalScope,debuggerEvalService);BackgroundGlobals_1.BackgroundGlobals.RegisterDriverEvalService(globalScope,driverEvalService);BackgroundGlobals_1.BackgroundGlobals.RegisterDriverPackageManager(globalScope,packageManager);BackgroundGlobals_1.BackgroundGlobals.RegisterExecuteScriptAdapterToMV3(globalScope,executeScriptAdapterToMV3);BackgroundGlobals_1.BackgroundGlobals.RegisterOriginalChromeApi(globalScope,OriginalChromeApi_1.OriginalChromeApi);BackgroundGlobals_1.BackgroundGlobals.RegisterBackgroundPageService(globalScope,backgroundPageService);if(BrowserExtensionConfig_1.ExtensionConfigService.GetConfig().AllowInteropWithStudioWeb){Logger_1.Logger.Log("[BackgroundMain] Registering listeners for connection from StudioWeb");let connectionHandler=new ConnectionHandler_1.ConnectionHandler;let loaderStudio=LoaderPortable_1.LoaderPortable.CreateStudioHost(packageManager,connectionHandler);BackgroundGlobals_1.BackgroundGlobals.RegisterLoaderStudioWeb(globalScope,loaderStudio);let proxyConnectionMatcher=new ConnectionProxy_1.ConnectionProxyMatcher('com.uipath.extension.proxy',connectionHandler);BackgroundGlobals_1.BackgroundGlobals.RegisterConnectionProxyMatcher(globalScope,proxyConnectionMatcher)}chrome.runtime.getPlatformInfo(platformInfo=>{Logger_1.Logger.Log("[BackgroundMain] platformInfo.os: "+platformInfo.os);if(platformInfo.os==="win"){if(BrowserExtensionConfig_1.ExtensionConfigService.GetConfig().AllowInteropWithNativeHostsOnWindows){let loaderWin32=LoaderWin32_1.LoaderWin32.CreateInstance(packageManager,extensionErrorService,extensionWindowId);BackgroundGlobals_1.BackgroundGlobals.RegisterLoaderWin32(globalScope,loaderWin32);let loaderPortable=LoaderPortable_1.LoaderPortable.CreateInstance(packageManager);BackgroundGlobals_1.BackgroundGlobals.RegisterLoaderPortable(globalScope,loaderPortable)}else{Logger_1.Logger.Log("[BackgroundMain] Studio Web-only; No connections will be made to Native Hosts")}}else{let loaderPortable=LoaderPortable_1.LoaderPortable.CreateInstance(packageManager);BackgroundGlobals_1.BackgroundGlobals.RegisterLoaderPortable(globalScope,loaderPortable)}})})})()})();